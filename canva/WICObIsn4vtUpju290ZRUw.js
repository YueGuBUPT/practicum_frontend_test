(function() {var d,aa="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global?global:this;function ba(){aa.Symbol||(aa.Symbol=ca);ba=function(){}}var da=0;function ca(a){return"jscomp_symbol_"+a+da++}function ea(){ba();aa.Symbol.iterator||(aa.Symbol.iterator=aa.Symbol("iterator"));ea=function(){}}function fa(a){ea();ba();ea();var b=a[Symbol.iterator];if(b)return b.call(a);var c=0;return{next:function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}}}
function ha(a){if(!(a instanceof Array)){a=fa(a);for(var b,c=[];!(b=a.next()).done;)c.push(b.value);a=c}return a}function k(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var e in b)if(Object.defineProperties){var f=Object.getOwnPropertyDescriptor(b,e);f&&Object.defineProperty(a,e,f)}else a[e]=b[e]}function ia(){}
function ka(a,b,c){for(var e=[],f=2;f<arguments.length;++f)e[f-2]=arguments[f];if(!a)throw Error(2>arguments.length?"invalid argument":la.apply(ia,[].concat([b],ha(e))));}function ma(a,b,c){for(var e=[],f=2;f<arguments.length;++f)e[f-2]=arguments[f];if(!a)throw Error(2>arguments.length?"invalid state":la.apply(ia,[].concat([b],ha(e))));}function la(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];var f=0;return a.replace(/\{}/g,function(){return f<c.length?c[f++]:"{}"})};function na(a){this.type=a}na.prototype.required=function(a,b){b=b[a];if(null==b||typeof b!=this.type)throw new TypeError("expected "+this.type+' for property "'+a+'", found: '+JSON.stringify(b));return b};na.prototype.optional=function(a,b){b=b[a];if(null!=b&&typeof b!=this.type)throw new TypeError("expected optional "+this.type+' for property "'+a+'", found: '+JSON.stringify(b));return b};
na.prototype.Ol=function(a,b){b=b[a];if(null!=b)if(Array.isArray(b))for(a=0;a<b.length;a++)this.required(String(a),b);else throw new TypeError("expected repeated "+this.type+' for property "'+a+'", found: '+JSON.stringify(b));return b};var n=new na("string"),oa=new na("boolean"),pa=new na("number"),t=new na("object");function qa(a,b,c){return(b=t.Ol(b,c))?b.map(a):b}function sa(a){this.type=a}
sa.prototype.required=function(a,b){if(null==b||typeof b!=this.type)throw new TypeError("expected "+this.type+' for property "'+a+'", found: '+JSON.stringify(b));return b};sa.prototype.optional=function(a,b){if(null!=b){if(typeof b!=this.type)throw new TypeError("expected optional "+this.type+' for property "'+a+'", found: '+JSON.stringify(b));return b}};
sa.prototype.Ol=function(a,b){if(!Array.isArray(b))throw new TypeError("expected repeated "+this.type+' for property "'+a+'", found: '+JSON.stringify(b));if(0!=b.length){for(var c=0;c<b.length;c++)this.required(a+"["+String(c)+"]",b[c]);return b}};var u=new sa("string"),ta=new sa("number"),ua=new sa("object");function va(a,b){return 0!==b?ta.required(a,b):void 0};function wa(a){this.o=a.o;this.G=a.G;this.cd=a.cd;this.Pd=a.Pd;this.Ab=this.$d=null;this.Yg=[];this.ready=!1;this.de=a.de;this.Jc=a.Jc;this.ga=a.ga}
function xa(a,b){b=$.extend({},b);a.$d&&(b.design=a.$d);b.experience=a.de;for(var c in a.Jc)a.Jc.hasOwnProperty(c)&&(b["Experiment:"+c]=a.Jc[c]);a.G&&(b.brand=a.G);a.cd&&(b.cohort=a.cd);a.Pd&&(b.tier=a.Pd);try{var e=window.crypto||window.msCrypto,f=new Uint8Array(16);e.getRandomValues(f);b.insert_id=btoa(String.fromCharCode.apply(null,f))}catch(g){}return b}d=wa.prototype;d.track=function(){};d.identify=function(a){this.o=a};d.alias=function(){};d.set=function(){};d.union=function(){};
d.ab=function(a,b,c,e,f){var g={};g.type=a;g.section=b;g.subsection=c;g.location=e;f&&_.extend(g,f);this.track("button_click",g)};function ya(a){wa.call(this,{de:a.de,Jc:a.Jc,o:a.o,G:a.G,cd:a.cd,Pd:a.Pd,ga:function(a,c,e){window.console.log("Google track: ",a,c,e)},Jq:function(a){window.console.log("Facebook track pixelId: ",a)},ir:function(a){window.console.log("Twitter trackPid: ",a)}})}_.extend(ya.prototype,wa.prototype);d=ya.prototype;d.track=function(a,b){window.console.log("analytics:track",this.o,a,xa(this,b))};d.identify=function(a,b,c,e){this.o=a;window.console.log("analytics:identify",a,b,c,e)};
d.alias=function(a){window.console.log("analytics:alias",this.o,a);this.o=a};d.set=function(a,b){window.console.log("analytics:set",this.o,a);b&&window.setTimeout(b,0)};d.union=function(a){window.console.log("analytics:union",this.o,a)};function za(a){function b(b){for(this.ready=!0;this.Yg&&0<this.Yg.length;)this.Yg.shift()();this.Yg=null;if(b&&a.o){var c=(new UAParser).getResult();b=c.browser.name;var g=c.browser.version,h=c.device.type,c=c.os.name;h||"Android"!=c&&"iOS"!=c||(h="mobile");this.set({"Most recent browser":b+" "+g,timezone:(new Date).getTimezoneOffset()/-60});this.union({"Operating Systems":[c],Browsers:[b],Devices:[h]})}}wa.call(this,a);var c=window.analytics;c&&(c.ready(b.bind(this,!Aa)),Aa||(Aa=!0,c.load(a.Vp),
c.page()))}var Aa=!1;_.extend(za.prototype,wa.prototype);d=za.prototype;d.track=function(a,b){window.analytics&&window.analytics.track(a,xa(this,b))};d.identify=function(a,b,c,e){"object"==typeof b&&(b={id:b.id,username:b.username,personalBrand:b.vj,displayName:b.displayName,largeAvatarUrl:b.zn,roles:b.Ql,onboarding:b.Bd});window.analytics&&window.analytics.identify(a,b,c,e)};d.alias=function(a){window.analytics&&window.analytics.alias(a)};
d.set=function(a,b){window.analytics&&window.analytics.identify(a,b)};d.union=function(){};function Ba(){var a=window.analyticsConfig,b=window.ga,c=a.user,e=a.brand,f=a.cohort,g=a.tier,h=String(a.experience),l=a.experiments,m=a.impl;switch(m){case "console":a=new ya({de:h,Jc:l,o:c,G:e,cd:f,Pd:g});break;case "segment":a=new za({Vp:a.segmentWriteKey,de:h,Jc:l,o:c,G:e,cd:f,Pd:g,ga:b});break;default:throw Error("Cant find analytics implementation "+m);}c&&a.identify(c);return a};var Ca=1<window.devicePixelRatio;window.navigator.userAgent.match(/Macintosh/);function w(a){this.jn=a.fallback;this.ul=a.localePrecedence;this.dj={};this.j=a.messages;this.Wo=this.ul[0];this.qp=!!a.returnKeys}w.prototype.format=function(a,b){if(this.qp)return[].join.call(arguments,":");var c=Da(this,a);return c.format.call(c,[].slice.call(arguments,1))};
function Da(a,b){if(a.dj.hasOwnProperty(b))return a.dj[b];var c=a.Wo,e;a.ul.some(function(c){e=a.j[c]&&a.j[c][b];return void 0!==e});e||(c=a.jn,e=a.j[c]&&a.j[c][b]);if(!e)throw Error("Unknown message: "+b);c=new IntlMessageFormat(e,c,Ea);return a.dj[b]=c}var Ea={number:{currency:{style:"currency",currency:"USD"},integer:{maximumFractionDigits:0},fixed2:{minimumFractionDigits:2,maximumFractionDigits:2}}};function Fa(){this.qa=window.cmsg;this.mb=this.ek=this.da=this.ba=this.ca=this.J=this.Wa=this.Vc=this.La=this.qc=this.jb=this.H=this.Ub=this.ta=this.Ja=this.vc=null}function Ga(a){a.Nk||(a.Nk=new Ha(a.qa));return a.Nk}function Ia(a){a.Ta||(a.Ta=new Ja(a.qa));return a.Ta}function Ka(a){a.ta||(a.ta=new La(a.qa));return a.ta}function Ma(a){a.Ub||(a.Ub=new Na(a.qa));return a.Ub}function Oa(a){a.H||(a.H=new Pa(a.qa));return a.H}function Qa(a){a.jb||(a.jb=new Ra(a.qa));return a.jb}
function Sa(a){a.ae||(a.ae=new Ta(a.qa));return a.ae}function Ua(a){a.W||(a.W=new Va(a.qa));return a.W}function Wa(a){a.zk||(a.zk=new Xa(a.qa));return a.zk}function Ya(a){a.La||(a.La=new Za(a.qa));return a.La}function $a(a){a.Vc||(a.Vc=new ab(a.qa));return a.Vc}function bb(a){a.Wa||(a.Wa=new cb(a.qa));return a.Wa}function db(a){a.J||(a.J=new eb(a.qa));return a.J}function fb(a){a.ca||(a.ca=new gb(a.qa));return a.ca}function hb(a){a.ba||(a.ba=new ib(a.qa));return a.ba}
function jb(a){a.vk||(a.vk=new kb(a.qa));return a.vk}function lb(a){a.mb||(a.mb=new mb(a.qa));return a.mb}function nb(a){w.apply(this,arguments)}nb.prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);function Za(a){w.apply(this,arguments)}Za.prototype=Object.create(w.prototype);d=Za.prototype;d.Ak=function(){return this.format("creditCardCardNumberPlaceholder")};
d.wl=function(){return this.format("creditCardMonthPlaceholder")};d.lm=function(){return this.format("creditCardYearPlaceholder")};d.Ik=function(){return this.format("creditCardCvcPlaceholder")};d.save=function(){return this.format("creditCardSave")};(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);function Ha(a){w.apply(this,arguments)}Ha.prototype=Object.create(w.prototype);Ha.prototype.Ee=function(){return this.format("documentPlaceholderText")};Ha.prototype.Wc=function(){return this.format("documentUntitledDesign")};
(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);function ob(a){w.apply(this,arguments)}ob.prototype=Object.create(w.prototype);ob.prototype.xd=function(){return this.format("brandKitTextToolbarMoreLink")};function pb(a){w.apply(this,arguments)}pb.prototype=Object.create(w.prototype);pb.prototype.Fh=function(){return this.format("editorControlsUpgrade")};pb.prototype.download=function(){return this.format("editorControlsDownload")};
function Ja(a){w.apply(this,arguments)}Ja.prototype=Object.create(w.prototype);Ja.prototype.mm=function(){return this.format("homeDesignYourFirstDesign")};Ja.prototype.Ri=function(){return this.format("homeDesignImportPersonalDesigns")};Ja.prototype.ql=function(a,b){return this.format("homeDesignIrresistibleFacebookPost",a,b)};Ja.prototype.error=function(){return this.format("homeDesignError")};function qb(a){w.apply(this,arguments)}qb.prototype=Object.create(w.prototype);qb.prototype.an=function(){return this.format("sharedDesignsEmptyMessage")};
qb.prototype.error=function(){return this.format("sharedDesignsError")};qb.prototype.title=function(){return this.format("sharedDesignsTitle")};function rb(a){w.apply(this,arguments)}rb.prototype=Object.create(w.prototype);rb.prototype.nc=function(){return this.format("homeTitleDesignStream")};rb.prototype.custom=function(a){return this.format("homeTitleCustom",a)};function sb(a){w.apply(this,arguments)}sb.prototype=Object.create(w.prototype);sb.prototype.lg=function(){return this.format("homeSideBarCreateFolder")};
function tb(a){w.apply(this,arguments)}tb.prototype=Object.create(w.prototype);d=tb.prototype;d.title=function(){return this.format("designImporterTitle")};d.prompt=function(){return this.format("designImporterPrompt")};d.deselectAll=function(){return this.format("designImporterDeselectAll")};d.empty=function(){return this.format("designImporterEmpty")};d.gf=function(a){return this.format("designImporterFetchError",a)};d.Wc=function(){return this.format("designImporterUntitledDesign")};
function La(a){w.apply(this,arguments)}La.prototype=Object.create(w.prototype);La.prototype.Pp=function(){return this.format("designCardStateUnderReview")};La.prototype.Np=function(){return this.format("designCardStateForSale")};La.prototype.Mp=function(){return this.format("designCardStateBrandPublic")};La.prototype.Op=function(){return this.format("designCardStatePublic")};function Na(a){w.apply(this,arguments)}Na.prototype=Object.create(w.prototype);
Na.prototype.xl=function(a){return this.format("findUserInputNoResults",a)};Na.prototype.error=function(){return this.format("findUserInputError")};function Pa(a){w.apply(this,arguments)}Pa.prototype=Object.create(w.prototype);function ub(a){return a.format("commentFormCommentDeleteConfirm")}function Ra(a){w.apply(this,arguments)}Ra.prototype=Object.create(w.prototype);Ra.prototype.Ig=function(){return this.format("likeButtonLike")};Ra.prototype.sb=function(){return this.format("likeButtonLiked")};
function Ta(a){w.apply(this,arguments)}Ta.prototype=Object.create(w.prototype);Ta.prototype.empty=function(){return this.format("designStreamEmpty")};Ta.prototype.error=function(a,b){return this.format("designStreamError",a,b)};Ta.prototype.An=function(){return this.format("designStreamLoadStream")};function Va(a){w.apply(this,arguments)}Va.prototype=Object.create(w.prototype);d=Va.prototype;d.title=function(){return this.format("docTypeSelectorTitle")};d.Dp=function(){return this.format("docTypeSelectorShowFewerDesigns")};
d.pk=function(){return this.format("docTypeSelectorUseCustomDimensions")};d.error=function(){return this.format("docTypeSelectorError")};d.Sc=function(){return this.format("docTypeSelectorRetry")};d.times=function(){return this.format("docTypeSelectorTimes")};d.width=function(){return this.format("docTypeSelectorWidth")};d.height=function(){return this.format("docTypeSelectorHeight")};d.Fl=function(){return this.format("docTypeSelectorPixelsUnit")};d.En=function(){return this.format("docTypeSelectorMillimetersUnit")};
d.un=function(){return this.format("docTypeSelectorInchesUnit")};d.$d=function(){return this.format("docTypeSelectorDesign")};d.Wb=function(){return this.format("docTypeSelectorMore")};(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);function xb(a){w.apply(this,arguments)}xb.prototype=Object.create(w.prototype);xb.prototype.$c=function(a){return this.format("colorPickerBrandColor",a)};function yb(a){w.apply(this,arguments)}yb.prototype=Object.create(w.prototype);
yb.prototype.save=function(){return this.format("editorFileMenuPaneSave")};function zb(a){w.apply(this,arguments)}zb.prototype=Object.create(w.prototype);zb.prototype.times=function(){return this.format("customDimensionsPaneTimes")};zb.prototype.Fl=function(){return this.format("customDimensionsPanePixelsUnit")};function Ab(a){w.apply(this,arguments)}Ab.prototype=Object.create(w.prototype);Ab.prototype.pk=function(){return this.format("documentResizePaneUseCustomDimensions")};
(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);function Bb(a){w.apply(this,arguments)}Bb.prototype=Object.create(w.prototype);Bb.prototype.Wb=function(){return this.format("editorToolbarMore")};Bb.prototype.lineHeight=function(){return this.format("editorToolbarLineHeight")};Bb.prototype.letterSpacing=function(){return this.format("editorToolbarLetterSpacing")};
function Xa(a){w.apply(this,arguments)}Xa.prototype=Object.create(w.prototype);function Cb(a){return a.format("canvaForWorkUpgradeTeamBrandKitsTitle")}function Db(a){return a.format("canvaForWorkUpgradeLayoutCreatorsTitle")}function Eb(a){return a.format("canvaForWorkUpgradeMagicallyResizeTitle")}function Fb(a){return a.format("canvaForWorkUpgradePhotoFoldersTitle")}function Gb(a){w.apply(this,arguments)}Gb.prototype=Object.create(w.prototype);d=Gb.prototype;d.title=function(){return this.format("shareViewTitle")};
d.Tl=function(){return this.format("shareViewShareOnFacebook")};d.Vl=function(){return this.format("shareViewShareOnTwitter")};d.Ul=function(){return this.format("shareViewShareOnLinkedIn")};d.post=function(){return this.format("shareViewPost")};d.email=function(){return this.format("shareViewEmail")};d.link=function(){return this.format("shareViewLink")};d.send=function(){return this.format("shareViewSend")};function Hb(a){w.apply(this,arguments)}Hb.prototype=Object.create(w.prototype);
Hb.prototype.title=function(){return this.format("exportPopOverTitle")};(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);function Ib(a){w.apply(this,arguments)}Ib.prototype=Object.create(w.prototype);Ib.prototype.title=function(a){return this.format("shareDialogTitle",a)};function Jb(a){w.apply(this,arguments)}Jb.prototype=Object.create(w.prototype);Jb.prototype.title=function(){return this.format("emailDialogTitle")};Jb.prototype.progress=function(){return this.format("emailDialogProgress")};
function Kb(a){w.apply(this,arguments)}Kb.prototype=Object.create(w.prototype);Kb.prototype.total=function(a){return this.format("publishViewTotal",a)};function Lb(a){w.apply(this,arguments)}Lb.prototype=Object.create(w.prototype);Lb.prototype.wd=function(){return this.format("brandTeamMembersMembers")};Lb.prototype.ma=function(){return this.format("brandTeamMembersFolders")};Lb.prototype.Fh=function(){return this.format("brandTeamMembersUpgrade")};
(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);function Mb(a){w.apply(this,arguments)}
Mb.prototype=Object.create(w.prototype);Mb.prototype.vj=function(){return this.format("userMenuPersonalBrand")};Mb.prototype.signOut=function(){return this.format("userMenuSignOut")};Mb.prototype.Fh=function(){return this.format("userMenuUpgrade")};function Nb(a){w.apply(this,arguments)}Nb.prototype=Object.create(w.prototype);Nb.prototype.sb=function(a,b){return this.format("notificationPopOverLiked",a,b)};Nb.prototype.Wc=function(){return this.format("notificationPopOverUntitledDesign")};
function Ob(a){w.apply(this,arguments)}Ob.prototype=Object.create(w.prototype);Ob.prototype.xl=function(){return this.format("designSearchNoResults")};function Pb(a){w.apply(this,arguments)}Pb.prototype=Object.create(w.prototype);Pb.prototype.zp=function(){return this.format("userProfileShareText")};Pb.prototype.Um=function(){return this.format("userProfileShareDismissTitle")};(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);function ab(a){w.apply(this,arguments)}
ab.prototype=Object.create(w.prototype);ab.prototype.gf=function(){return this.format("teamStreamFetchError")};function cb(a){w.apply(this,arguments)}cb.prototype=Object.create(w.prototype);cb.prototype.bn=function(){return this.format("trashedDesignsEmptyTitle")};cb.prototype.$m=function(){return this.format("trashedDesignsEmptyBody")};cb.prototype.gf=function(){return this.format("trashedDesignsFetchError")};function eb(a){w.apply(this,arguments)}eb.prototype=Object.create(w.prototype);
function Qb(a){return a.format("designFoldersHeaderTitleDefaultName")}function Rb(a){return a.format("designFoldersHeaderEditSaveError")}eb.prototype.og=function(){return this.format("designFoldersDeleteFolderError")};eb.prototype.yp=function(){return this.format("designFoldersShareFolderButton")};eb.prototype.fq=function(){return this.format("designFoldersViewOnly")};function gb(a){w.apply(this,arguments)}gb.prototype=Object.create(w.prototype);d=gb.prototype;d.lc=function(){return this.format("designFolderListDefaultName")};
d.og=function(a){return this.format("designFolderListDeleteFolderError",a)};d.Ae=function(){return this.format("designFolderListNewFolder")};d.le=function(){return this.format("designFolderListGetMoreFolders")};d.fe=function(a){return this.format("designFolderListFolderQuotaHint",a)};d.be=function(){return this.format("designFolderListErrorMessageHtml")};d.Sc=function(){return this.format("designFolderListRetry")};d.xe=function(){return this.format("designFolderListLoadFolders")};
function ib(a){w.apply(this,arguments)}ib.prototype=Object.create(w.prototype);d=ib.prototype;d.title=function(){return this.format("shareFolderDialogTitle")};d.readOnly=function(){return this.format("shareFolderDialogReadOnly")};d.remove=function(){return this.format("shareFolderDialogRemove")};d.Xi=function(){return this.format("shareFolderDialogIsOwner")};d.tp=function(){return this.format("shareFolderDialogSaveButton")};function kb(a){w.apply(this,arguments)}kb.prototype=Object.create(w.prototype);
d=kb.prototype;d.copy=function(){return this.format("lightboxCopyButton")};d.Ym=function(){return this.format("lightboxEdit")};d.next=function(){return this.format("lightboxNext")};d.previous=function(){return this.format("lightboxPrevious")};d.page=function(){return this.format("lightboxPage")};d.mp=function(){return this.format("lightboxReportInappropriate")};d.Bn=function(){return this.format("lightboxMakingPreview")};d.Cn=function(){return this.format("lightboxMakingPreviewLong")};d.Yo=function(){return this.format("lightboxPreviewDownloading")};
d.Zo=function(){return this.format("lightboxPreviewError")};d.Pm=function(a){return this.format("lightboxCtaCreateYourOwn",a)};d.Qm=function(){return this.format("lightboxCtaGetStarted")};function Sb(a){w.apply(this,arguments)}Sb.prototype=Object.create(w.prototype);Sb.prototype.Nm=function(a){return this.format("teamUpgradeCreateTrialPeriodPoint1Html",a)};Sb.prototype.Om=function(){return this.format("teamUpgradeCreateTrialPeriodPoint3Html")};function mb(a){w.apply(this,arguments)}mb.prototype=Object.create(w.prototype);
d=mb.prototype;d.Am=function(a){return this.format("teamBillingSignupClaimHtml",a)};d.Fh=function(a){return this.format("teamBillingSignupUpgrade",a)};d.Lp=function(){return this.format("teamBillingSignupStartTrial")};d.sp=function(){return this.format("teamBillingSignupRevertCard")};d.yn=function(){return this.format("teamBillingSignupItemsTitle")};d.xm=function(){return this.format("teamBillingSignupBillingError")};d.Zp=function(){return this.format("teamBillingSignupTryAgain")};d.cn=function(){return this.format("teamBillingSignupEncryption")};
(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);
(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);function Tb(a){w.apply(this,arguments)}Tb.prototype=Object.create(w.prototype);Tb.prototype.gf=function(){return this.format("invoiceFetchError")};Tb.prototype.title=function(){return this.format("invoiceTitle")};Tb.prototype.total=function(){return this.format("invoiceTotal")};function Ub(a){w.apply(this,arguments)}Ub.prototype=Object.create(w.prototype);
Ub.prototype.fill=function(){return this.format("zoomToolbarFill")};(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);(function(a){w.apply(this,arguments)}).prototype=Object.create(w.prototype);function Vb(a){0<a.length&&(a=window.getComputedStyle(a.get(0)))&&a.getPropertyValue("left")};var x=new Wb;function Wb(){}d=Wb.prototype;d.setInterval=function(a,b){return window.setInterval(a,b)};d.clearInterval=function(a){window.clearInterval(a)};d.setTimeout=function(a,b){return window.setTimeout(a,b)};d.clearTimeout=function(a){window.clearTimeout(a)};d.requestAnimationFrame=function(a){return window.requestAnimationFrame(a)};d.cancelAnimationFrame=function(a){window.cancelAnimationFrame(a)};function Xb(a){window.requestAnimationFrame(function(){window.requestAnimationFrame(a)})};function y(a,b){if(!a)throw new TypeError("Cannot adopt constructor "+a);if("object"!==typeof b)throw new TypeError("Cannot adopt non-object value "+b);if(null===b)throw new TypeError("Cannot adopt null value");return Object.create(a.prototype,Yb(b))}function Yb(a){var b=Object.create(null);Object.keys(a).forEach(function(c){b[c]={value:a[c],writable:!0,enumerable:!0,configurable:!0}});return b};function z(a,b){this.name=a;this.defaultValue=b}function Zb(a){this.values=a||{}}Zb.prototype.get=function(a){return a.name in this.values?this.values[a.name]:a.defaultValue};function $b(a){this.Ra=a}var ac=new z("bg",!1),bc=new z("bl",!1),dc=new z("ca",!1),ec=new z("ck",!1),fc=new z("cr",!0),gc=new z("cs",!0),hc=new z("cz",!1),ic=new z("dc",-1),jc=new z("di",!0),kc=new z("dj",!1),lc=new z("dk",!1),mc=new z("dl",!1),nc=new z("dm",!1),oc=new z("do",!1);$b.prototype.cf=function(){return!!this.Ra.get(ec)};function pc(a,b,c,e){this.left=a;this.top=b;this.width=c;this.height=e}d=pc.prototype;d.serialize=function(){return{left:this.left,top:this.top,width:this.width,height:this.height}};d.clone=function(){return new pc(this.left,this.top,this.width,this.height)};d.hb=function(){return this.width};d.Ha=function(){return this.height};d.setPosition=function(a,b){this.left=a;this.top=b;return this};d.setSize=function(a,b){this.width=a;this.height=b;return this};
d.translate=function(a,b){this.left+=a;this.top+=b;return this};d.scale=function(a,b){void 0===b&&(b=a);this.left*=a;this.top*=b;this.width*=a;this.height*=b;return this};d.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function qc(){Error.captureStackTrace&&Error.captureStackTrace(this,qc)}qc.prototype=Object.create(Error.prototype);(function(){qc.call(this)}).prototype=Object.create(qc.prototype);(function(){qc.call(this)}).prototype=Object.create(qc.prototype);(function(){qc.call(this)}).prototype=Object.create(qc.prototype);function rc(a){this.u=a;this.path="/documents"}d=rc.prototype;d.duplicate=function(a){var b=this.path+"?duplicate\x3d"+encodeURIComponent(a.i());return A(this.u,b,a).get(0).then(sc)};d.Wp=function(a){return A(this.u,this.path+"/"+encodeURIComponent(a)+"?trash",null).return()};d.delete=function(a){return A(this.u,this.path+"/"+encodeURIComponent(a)+"?delete",null).return()};d.move=function(a,b,c){return A(this.u,this.path+"/"+encodeURIComponent(a)+"?move",{owner:{user:b,brand:c}}).get(0).get("doc")};
d.getDocument=function(a){a=[this.path,null!=a.doc?"/"+encodeURIComponent(a.doc):"",a.excludePages?"?excludePages":""].join("");return B(this.u,a).get(0).then(tc)};d.search=function(a){a=this.path+"/search?"+a.ac();return B(this.u,a).get(0).then(uc)};function vc(){this.remix=this.edit=this.view=this["default"]=null}function wc(){}function sc(a){return Object.freeze(y(wc,a))}wc.prototype.getDocument=function(){return xc(this.document)};wc.prototype.getSession=function(){return this.session};wc.prototype.rb=function(){if(this.type)return yc(this.type)};function zc(){}zc.prototype.i=function(){return this.id};zc.prototype.uc=function(){return this.title};zc.prototype.Kh=function(a){this.id=a;return this};function Ac(){}
function Bc(a){var b=new Ac;b.doc=a;return b}function Cc(a){a.excludePages=!0;return a}function Dc(){}function tc(a){return Object.freeze(y(Dc,a))}Dc.prototype.getDocument=function(){return xc(this.document)};function Ec(){}function uc(a){return Object.freeze(y(Ec,a))}function Fc(){}d=Fc.prototype;d.Ki=function(){return this.creationDate};function Gc(a){var b=a.draft;return b?b.timestamp:a.creationDate}d.i=function(){return this._id};d.il=function(a){try{return this.draft.content.pages[a]}catch(b){}};
d.Nc=function(){var a,b,c=0,e;if(a=this.draft){var f=a.imageSets;if("preview"in f)for(b=f.preview.images,a=0;a<b.length;a++)e=b[a].page,e>c&&(c=e);if("thumbnail"in f)for(b=f.thumbnail.images,a=0;a<b.length;a++)e=b[a].page,e>c&&(c=e)}return c};function Hc(a,b){if((a=a.draft)&&a.imageSets.preview){a=a.imageSets.preview.images;for(var c=0;c<a.length;c++)if(a[c].page==b+1)return a[c].url}return null}function Ic(a){return(a=a.draft)&&a.imageSets.preview?_.pluck(a.imageSets.preview.images,"url"):null}
d.Oi=function(){return this.tags};function Jc(a){if((a=a.draft)&&a.imageSets&&a.imageSets.thumbnail){a=a.imageSets.thumbnail.images;for(var b=0;b<a.length;b++)if(1==a[b].page)return a[b].url}return null}d.uc=function(){try{return this.draft.content.title.trim()||null}catch(a){return null}};d.getVersion=function(){var a=this.draft;return a?a.version:-1};
function Kc(a,b,c,e){if(!a.acl)return!1;var f=Lc[e];return a.acl.rules.some(function(a){return"DEFAULT"==a.type||"USER"==a.type&&a.principal.brand==c&&a.principal.user==b||"BRAND"==a.type&&a.principal.brand==c?f<=Lc[a.role]:!1})}function Mc(a){return a.acl?a.acl.rules.some(function(a){return"DEFAULT"==a.type&&a.role!=Nc}):!1}d.Xi=function(a,b){return this.acl?this.acl.rules.some(function(c){return c.role==Oc&&c.principal.brand==b.i()&&c.principal.user==a.i()}):!1};
var Nc="NONE",Oc="OWNER",Lc={NONE:0,VIEWER:1,REMIXER:2,EDITOR:3,OWNER:4};function xc(a){var b=new Fc;$.extend(b,a);a=a.extensions;var c=new vc;a&&$.extend(c,a);b.extensions=c;return b};function C(){}C=Backbone.View.extend({className:"tileListBusyIndicator"});d=C.prototype;d.initialize=function(){this.transitionDelay=-1;this.xh=0};d.hide=function(){Pc(this,function(){this.$el.removeClass("tileListBusyIndicatorOn")})};d.render=function(){this.$el.html(this.template());return this};function Pc(a,b){0!=a.xh&&(window.clearTimeout(a.xh),a.xh=0);0<=a.transitionDelay?a.xh=window.setTimeout(b.bind(a),a.transitionDelay):b.call(a)}d.show=function(){Pc(this,function(){this.$el.addClass("tileListBusyIndicatorOn")})};
d.template=function(){return _.range(8).map(function(){return"\x3cspan\x3e\x3c/span\x3e"}).join("")};function Qc(){}Qc=Backbone.View.extend({className:"commentMenu"});d=Qc.prototype;d.events=function(){return{"click .commentMenuCancel":this.trigger.bind(this,"cancel"),"click .commentMenuConfirm":this.trigger.bind(this,"confirm")}};d.hide=function(){$(document).off("click",this.Og);this.$el.removeClass("commentMenuVisible");this.trigger("hide")};d.initialize=function(a){this.Vf=a.Vf;this.H=a.H;this.Og=this.Og.bind(this);this.Vf.on("click",this.show.bind(this))};
d.Og=function(a){0===$(a.target).closest(this.el).length&&a.target!==this.Vf.get(0)&&this.hide()};d.render=function(){this.$el.html(this.template({deleteConfirmLabel:ub(this.H),deleteConfirmYesLabel:this.H.format("commentFormCommentDeleteConfirmYes"),deleteConfirmNoLabel:this.H.format("commentFormCommentDeleteConfirmNo")}));return this};d.Rc=function(){this.$(".commentMenuPrompt").text(this.H.format("commentFormListErrorCommentDelete"))};
d.show=function(){this.$(".commentMenuPrompt").text(ub(this.H));$(document).on("click",this.Og);this.$el.addClass("commentMenuVisible");this.trigger("show")};d.template=_.template('\x3cp class\x3d"commentMenuPrompt"\x3e\x3c%- deleteConfirmLabel %\x3e\x3c/p\x3e\x3cmenu\x3e\x3cdiv class\x3d"button buttonSmall buttonLink commentMenuOption commentMenuConfirm"\x3e\x3c%- deleteConfirmYesLabel %\x3e\x3c/div\x3e\x3cspan class\x3d"commentMenuOption commentMenuSeparator"\x3e - \x3c/span\x3e\x3cdiv class\x3d"button buttonSmall buttonLink commentMenuOption commentMenuCancel"\x3e\x3c%- deleteConfirmNoLabel %\x3e\x3c/div\x3e\x3c/menu\x3e');function Rc(a,b,c){this.text=b||null;b=Ga(a);this.text&&this.text.toLocaleLowerCase()===b.Wc().toLocaleLowerCase()&&(this.text=null);this.Lk=c||null;this.j=a}Rc.prototype.on=Backbone.Events.on;Rc.prototype.off=Backbone.Events.off;Rc.prototype.trigger=Backbone.Events.trigger;function Sc(a){var b=a.text||Ga(a.j).Wc();a.Lk&&(null===a.text||""===a.text)&&(b=a.Lk+" – "+b);return b};function Tc(a,b){this.D=a;this.vc=b}Tc.prototype.sa=function(){var a=this.D.getName(),b=this.D.oe();if(a)return a;if(b){if(b===Uc)return this.vc.format("objectPanelUploadsPanelSystemFolderLogos");if(b===Vc)return this.vc.format("objectPanelUploadsPanelSystemFolderUnfoldered");throw Error("unrecognised system folder");}return this.D===Wc?this.vc.format("objectPanelUploadsPanelUploadsFolder"):this.D===Xc?this.vc.format("objectPanelUploadsPanelRoyaltyFreeFolder"):this.vc.format("objectPanelUploadsPanelUntitledFolder")};function D(){}D=Backbone.View.extend();D.prototype.initialize=function(a){a=_.defaults({},a,{hg:!0,content:$(),Jf:!0,xc:!0});this.C=a.C;this.hg=!!a.hg;this.content=a.content;this.ze=new Yc({style:this.Mi(),C:this.C});this.listenTo(this.ze,"maskClick",this.blur);this.result=1;this.Jf=!!a.Jf;this.Lb=!!a.Lb;this.xc=!!a.xc;this.title=a.xc?a.title:""};D.om=300;d=D.prototype;d.blur=function(){this.hg&&(this.result=0,this.remove())};d.cancel=function(){this.result=1;this.remove()};
d.fail=function(){this.result=3;this.remove()};d.events=function(){return{"click .close":this.yl,"click .dialogMaskCloseButton":this.yl,"click button.done":this.ok}};d.Mi=function(){return Zc};d.ok=function(){this.result=2;this.remove()};d.yl=function(a){a.preventDefault();this.cancel()};
d.remove=function(){var a=this;this.$el.children(".dialog").addClass("disappearing");this.ze.hide();this.trigger("hide",this.result);this.C.setTimeout(function(){a.trigger("remove",a);Backbone.View.prototype.remove.call(a)},D.om);return this};d.render=function(){this.$el.html(this.template(this.jh()));this.$(".content").append(this.content);this.$(".dialog").data("Canva_Views_Dialog",this);return this};
d.jh=function(){return{showCloseButton:this.Jf,showDialogMaskCloseButton:this.Lb,showTitle:this.xc,title:this.title}};d.show=function(){function a(e){e.target===e.currentTarget&&(b.off("animationend transitionend",a),c.trigger("showTransitionEnd",c))}var b,c=this;this.render();b=this.$el.children(".dialog");this.ze.show(this.$el);this.trigger("show",this);Xb(function(){b.removeClass("preparing");b.on("animationend transitionend",a)});return this};d.template=_.template('\x3c% if (showDialogMaskCloseButton) { %\x3e\x3ca class\x3d"dialogMaskCloseButton"\x3eClose\x3c/a\x3e\x3c% } %\x3e\x3cdiv class\x3d"dialog preparing"\x3e\x3c% if (showTitle) { %\x3e\x3ch2\x3e\x3c%- title %\x3e\x3c/h2\x3e\x3c% } %\x3e\x3cdiv class\x3d"content"\x3e\x3c/div\x3e\x3c% if (showCloseButton) { %\x3e\x3ca class\x3d"close" href\x3d"#" title\x3d"Close this dialog"\x3eClose\x3c/a\x3e\x3c% } %\x3e\x3c/div\x3e');var $c={LEFT:"left",pq:"leftTop",uq:"top",vq:"topLeft",tq:"rightTop"};function F(){}F=D.extend();d=F.prototype;d.initialize=function(a){D.prototype.initialize.call(this,_.extend({C:x},a));this.Qk=a.Qk||"Done";this.Kd=void 0!==a.Kd?a.Kd:!0;this.Te=null;this.Gl=a.position instanceof Array?a.position:[a.position||"top"];this.position=null;this.Hb=_.defaults({},a.Hb,{left:0,top:0});this.Cd=a.Cd||!1;this.on("hide",this.Jk);this.keydown=this.keydown.bind(this)};
d.Vh=function(){$(document).on("keydown",this.keydown)};d.Fj=function(){$(document).off("keydown",this.keydown)};d.Mi=function(){return ad};d.getCurrentPosition=function(){return this.position};
d.render=function(){D.prototype.render.call(this);this.$(".dialog").addClass("popover").addClass(this.Cd?"paddingLess":"").prepend('\x3cdiv class\x3d"pointer"\x3e\x3c/div\x3e');this.Kd&&this.$(".content").append('\x3cp class\x3d"buttonContainer"\x3e\x3cbutton class\x3d"button buttonBlock done"\x3e'+this.Qk+"\x3c/button\x3e\x3c/p\x3e");return this};
function bd(a,b){if(!a.Te){var c=_.debounce(a.gm.bind(a),300);window.addEventListener("resize",c,!1);a.on("remove",function(){window.removeEventListener("resize",c,!1)})}a.show();a.Vh();a.on("remove",a.Fj);cd(a,b);a.gm()}function dd(){this.yj=this.xj=this.dialogLeft=this.dialogTop=null}
d.gm=function(){for(var a,b,c=0;c<this.Gl.length;c++){a=b=this.Gl[c];var e=this.Cd?7:19,f=this.Cd?20:40,g=this.Te,h=g.offset(),l=h.top-$(document).scrollTop(),m=g.outerWidth(),q=g.outerHeight(),p=this.$(".dialog").outerHeight(),r=this.$(".dialog").outerWidth(),v=this.$el.width(),g=new dd,ja=Math.round(h.left+m/2-r/2);switch(a){case "top":g.dialogLeft=ja+r+10>v?v-r-10:ja;g.dialogLeft+=this.Hb.left;g.dialogTop=Math.round(l)+q+e+this.Hb.top;a=ja-g.dialogLeft;g.xj="calc(50% - 8.5px + "+a+"px)";break;
case "topLeft":g.dialogLeft=h.left+r+10>v?v-r-10:h.left;g.dialogLeft+=this.Hb.left;g.dialogTop=Math.round(l)+q+e+this.Hb.top;g.xj=g.dialogLeft+e;break;case "left":g.dialogLeft=h.left+m+this.Hb.left;g.dialogTop=l-p/2+e+this.Hb.top;break;case "leftTop":g.dialogLeft=h.left+m+this.Hb.left+e;g.dialogTop=l+q/2-f+this.Hb.top;10>g.dialogTop&&(g.yj=g.dialogTop-10,g.dialogTop=10);break;case "rightTop":g.dialogLeft=h.left-r+this.Hb.left-e,g.dialogTop=l+q/2-f+this.Hb.top,10>g.dialogTop&&(g.yj=g.dialogTop-10,
g.dialogTop=10)}e=a=g;f=this.$(".dialog");if(!(e.dialogLeft+f.outerWidth()>$(window).width()||e.dialogTop+f.outerHeight()>$(window).height()))break}this.position=b;this.$(".dialog").css("top",a.dialogTop).css("left",a.dialogLeft);c=this.$(".pointer");c.removeClass(_.values($c).join(" ")).addClass(b);c.css("left",a.xj||"");c.css("margin-top",a.yj||"");return this};function cd(a,b){a.Jk();a.Te=b;b.addClass("on");b.blur()}d.Jk=function(){this.Te&&this.Te.removeClass("on")};
d.keydown=function(a){27===a.which&&(this.cancel(),a.stopPropagation(),a.preventDefault())};function ed(a){var b=fd.bind(null,a.F),c=a.F.Cg();this.Dk=c&&c.id;this.v=a.v;this.Hc=a.Hc||null;this.F=a.F;this.view=new gd({analytics:a.analytics,Ud:a.Ud,v:this.v,Vb:a.Vb,Dg:a.Dg||b,Fa:a.Fa,lb:a.lb,Je:!!a.Je,Ke:!!a.Ke,Le:!!a.Le,Uc:!!a.Uc,Nf:!!a.Nf,Ld:!!a.Ld,F:a.F,Y:a.Y,j:a.j});this.listenTo(this.view,{deleteComment:this.Sb,fetchMoreComments:this.zi,postComment:this.Qc,thumbnailClick:this.trigger.bind(this,"thumbnailClick"),editTitle:this.trigger.bind(this,"editTitle"),copy:this.trigger.bind(this,
"copy"),trash:this.trigger.bind(this,"trash"),removeFromFolder:this.trigger.bind(this,"removeFromFolder"),removeFromAllFolders:this.trigger.bind(this,"removeFromAllFolders"),restore:this.trigger.bind(this,"restore"),deleteForever:this.trigger.bind(this,"deleteForever"),editTemplate:this.trigger.bind(this,"editTemplate"),removeTemplate:this.trigger.bind(this,"removeTemplate")})}function hd(a){return{href:G(a.i(),"edit"),sj:!0}}function fd(a){return a.Ia().fa()}
function id(a){return{href:G(a.i(),"view"),sj:!1}}d=ed.prototype;d.listenTo=Backbone.Events.listenTo;d.off=Backbone.Events.off;d.on=Backbone.Events.on;d.once=Backbone.Events.once;d.trigger=Backbone.Events.trigger;d.gc=function(a){var b=this.view.lf;b&&(b.gc(a),b.render())};d.Dh=function(a){var b=this.view.lf;b&&(b.Dh(a),b.render())};d.Sb=function(a){var b=this.view.sc(),c=this;this.Hc.Sb(a).then(function(){--c.F.commentCount;b.Ej(a);jd(b)},b.Rc.bind(b,a))};
d.zi=function(){function a(a){kd(c);a.eb.forEach(c.yk.bind(c));jd(c);e.Dk=a.N||null}function b(){kd(c);window.alert("Oops! We weren't able to fetch more comments.\n\nRefresh the page and try again. If it still doesn't work, email us at support@canva.com.")}var c=this.view.sc(),e=this;this.Hc&&(ld(c).addClass("designCardFetchingComments"),this.Hc.Ii(this.Dk,20).then(a,b))};d.getElement=function(){return this.view.$el};
d.Qc=function(a){function b(a){e.clear().enable();var b=f,c;c=(new md({Vd:a,Kf:nd(b,a),H:b.H})).render();b.Wd[a.id]=c;b.listenTo(c,"deleteComment",b.trigger.bind(b,"deleteComment"));c.$el.insertBefore(b.he.$el);g.F.commentCount+=1;jd(f);g.trigger("comment",a)}function c(){e.qh("Darn, something went wrong and we couldn't post your comment.");e.enable()}var e=this.view.Hi(),f=this.view.sc(),g=this;this.Hc&&(e.disable(),this.Hc.Qc(a,this.v).then(b,c))};d.render=function(){this.view.render();return this};
d.vh=function(a){this.view.vh(a)};d.Oe=function(a){this.view.Oe(a)};d.nb=function(a){return this.view.nb(a)};d.Rf=function(a){return this.view.Rf(a)};d.wh=function(a){this.view.wh(a)};d.Tf=function(a){this.view.Tf(a)};function od(){}od=Backbone.View.extend({className:"designCardCommentList",tagName:"ol"});d=od.prototype;d.initialize=function(a){this.v=a.v;this.H=a.H;this.Wd={};this.he=new pd({H:this.H});this.listenTo(this.he,"submit",this.Qc);this.F=a.F};d.yk=function(a){var b=ld(this),c;c=(new md({Vd:a,Kf:nd(this,a),H:this.H})).render();this.Wd[a.id]=c;this.listenTo(c,{deleteComment:this.trigger.bind(this,"deleteComment")});b.length?c.$el.insertAfter(b):c.$el.prependTo(this.$el)};
function kd(a){ld(a).removeClass("designCardFetchingComments")}d.events=function(){return{"click .designCardMoreCommentsLink":this.zi}};d.zi=function(a){a.preventDefault();ld(this).hasClass("designCardFetchingComments")||this.trigger("fetchMoreComments")};d.Hi=function(){return this.he};function ld(a){return a.$(".designCardMoreCommentsLink")}function nd(a,b){if(a.v.za())return!1;b=a.v.i()===b.Dc.i();var c=a.F.myRole===Oc,e=-1<a.v.tc().indexOf(qd);a=-1<a.v.tc().indexOf(rd);return b||c||e||a}
d.Qc=function(a){this.trigger("postComment",a)};d.Ej=function(a){var b=this.Wd[a.id];b&&(delete this.Wd[a.id],b.remove())};d.render=function(){this.v.za()||(this.he.render(),sd(this.he,this.v),this.he.$el.appendTo(this.$el));return this};function jd(a){var b=Object.keys(a.Wd).length,c=a.F.mf();ld(a).remove();b<c&&(b=20<c?a.H.format("commentFormViewNext",Math.min(b+20,c),c):a.H.format("commentFormViewRemaining",c-b),a.$el.prepend(a.Gn({viewCommentsLabel:b})))}d.Rc=function(a){(a=this.Wd[a.id])&&a.Rc()};
d.Gn=_.template('\x3cli class\x3d"designCardMoreCommentsLink"\x3e\x3ca href\x3d"#"\x3e\x3c%- viewCommentsLabel %\x3e\x3c/a\x3e\x3c/li\x3e');function md(){}md=Backbone.View.extend({className:"designCardComment",tagName:"li"});d=md.prototype;d.initialize=function(a){this.Vd=a.Vd;this.Kf=!!a.Kf;this.H=a.H};d.events=function(){return{"click .designCardCommentContent \x3e .more":this.gn}};d.gn=function(a){a.preventDefault();td(this.$(".designCardCommentContent"))};d.qo=function(){this.$el.removeClass("commentMenuVisible").css("min-height","")};d.ro=function(){this.$el.addClass("commentMenuVisible").css("min-height",this.ha.$el.height())};
d.remove=function(){Backbone.View.prototype.remove.call(this);this.ha&&this.ha.remove()};
d.render=function(){this.$el.html(this.template({content:this.Vd.content,showDelete:this.Kf,deleteLabel:this.H.format("commentFormCommentDelete")}));var a=this.Vd.Dc;this.$el.prepend(this.vm({authorAvatarUrl:a.Lc(50),authorDisplayName:a.sa(),authorProfilePath:"/"+a.Da()}));this.Kf&&(this.ha=new Qc({Vf:this.$(".buttonDelete"),H:this.H}),this.ha.render().$el.appendTo(this.$el),this.listenTo(this.ha,{cancel:this.ha.hide.bind(this.ha),confirm:this.trigger.bind(this,"deleteComment",this.Vd),hide:this.qo,
show:this.ro}));ud(this.$(".designCardCommentContent"),100);return this};d.Rc=function(){this.ha&&this.ha.Rc()};d.vm=_.template('\x3ca class\x3d"designCardCommentAuthor" href\x3d"\x3c%- authorProfilePath %\x3e"\x3e\x3cimg src\x3d"\x3c%- authorAvatarUrl %\x3e"\x3e\x3c%- authorDisplayName %\x3e\x3c/a\x3e');d.template=_.template('\x3cdiv class\x3d"designCardCommentContent"\x3e\x3c%- content %\x3e\x3c/div\x3e\x3c% if (showDelete) { %\x3e\x3cdiv class\x3d"designCardCommentButtons"\x3e\x3cbutton title\x3d"\x3c%- deleteLabel %\x3e" class\x3d"button buttonTiny buttonIcon buttonDelete"\x3e\x3c%- deleteLabel %\x3e\x3c/button\x3e\x3c/div\x3e\x3c% } %\x3e');function vd(){}vd=Backbone.View.extend({className:"designCardFolderList",tagName:"ul"});d=vd.prototype;d.initialize=function(a){this.ma=[];this.ta=a.ta};
d.render=function(){function a(a){this.$el.append($(this.kn({name:a.getName(),link:"/folder/"+a.i()})))}function b(a){return a.getName()||this.ta.format("designCardFolderLabelDefaultName")}var c;this.$el.empty();3>=this.ma.length?this.ma.forEach(a,this):(this.ma.slice(0,2).forEach(a,this),c=this.ma.slice(2),this.$el.append($(this.In({moreText:this.ta.format("designCardMoreFolders",c.length),moreTitle:c.map(b,this).join(", ")}))));return this};
d.gc=function(a){var b;this.ma.some(function(c){if(c.i()===a.i())return b=c,!0});b||this.ma.push(a)};d.Dh=function(a){this.ma=a.slice(0)};d.In=_.template('\x3cli class\x3d"designCardFolder designCardFolderMore"\x3e\x3cspan class\x3d"designCardFolderMoreLink" title\x3d"\x3c%- moreTitle %\x3e"\x3e\x3c%- moreText %\x3e\x3c/span\x3e\x3c/li\x3e');d.kn=_.template('\x3cli class\x3d"designCardFolder"\x3e\x3ca class\x3d"designCardFolderLink" href\x3d"\x3c%- link %\x3e" title\x3d"\x3c%- name %\x3e"\x3e\x3c%- name %\x3e\x3c/a\x3e\x3c/li\x3e');function wd(){}wd=F.extend({className:"designCardMenuContainer"});d=wd.prototype;d.initialize=function(a){this.df=a.df;this.nh=a.nh||!1;this.Qh=a.Qh||null;this.sh=!!a.sh;this.Vj=!!a.Vj;this.Xl=!!a.Xl;this.Wj=!!a.Wj;this.Qj=!!a.Qj;this.Wl=!!a.Wl;this.Yl=!!a.Yl;this.ta=a.ta;F.prototype.initialize.call(this,{content:this.Fd(),Kd:!1,position:["leftTop","rightTop"],Cd:!0,xc:!1})};
d.events=function(){return{"click .designCardMenu__copyDesign":this.bc.bind(this,"copy"),"click .designCardMenu__trashDesign":this.bc.bind(this,"trash"),"click .designCardMenu__removeFromFolder":this.bc.bind(this,"removeFromFolder"),"click .designCardMenu__removeFromAllFolders":this.bc.bind(this,"removeFromAllFolders"),"click .designCardMenu__restoreDesign":this.bc.bind(this,"restore"),"click .designCardMenu__deleteForever":this.bc.bind(this,"deleteForever"),"click .designCardMenu__editTemplate":this.bc.bind(this,
"editTemplate"),"click .designCardMenu__removeTemplate":this.bc.bind(this,"removeTemplate")}};d.bc=function(a){this.trigger(a);this.remove()};
d.Fd=function(){return this.Ze({docTypeName:this.df,showCopyDesign:this.nh,showTrashDesign:this.sh,showRemoveFromFolder:this.Vj,showRemoveFromAllFolders:this.Xl,showRestoreDesign:this.Wj,showDeleteForever:this.Qj,showEditTemplate:this.Wl,showRemoveTemplate:this.Yl,copyDesign:this.ta.format("designCardMenuCopyDesign"),trashDesign:this.ta.format("designCardMenuTrashDesign"),removeFromFolder:this.ta.format("designCardMenuRemoveFromFolder",this.Qh),removeFromAllFolders:this.ta.format("designCardMenuRemoveFromAllFolders"),
restoreDesign:this.ta.format("designCardMenuRestoreDesign"),deleteForever:this.ta.format("designCardMenuDeleteForever"),editTemplate:this.ta.format("designCardMenuEditTemplate"),removeTemplate:this.ta.format("designCardMenuRemoveTemplate")})};d.Ze=_.template('\x3cdiv class\x3d"infoPanel"\x3e\x3c%- docTypeName %\x3e\x3c/div\x3e\x3cdiv class\x3d"selectMenu"\x3e\x3c% if (showEditTemplate) { %\x3e\x3cdiv class\x3d"selectMenu__item designCardMenu__editTemplate"\x3e\x3c%- editTemplate %\x3e\x3c/div\x3e\x3c% } %\x3e\x3c% if (showCopyDesign) { %\x3e\x3cdiv class\x3d"selectMenu__item designCardMenu__copyDesign"\x3e\x3c%- copyDesign %\x3e\x3c/div\x3e\x3c% } %\x3e\x3c% if (showTrashDesign) { %\x3e\x3cdiv class\x3d"selectMenu__item designCardMenu__trashDesign"\x3e\x3c%- trashDesign %\x3e\x3c/div\x3e\x3c% } %\x3e\x3c% if (showRemoveFromFolder) { %\x3e\x3cdiv class\x3d"selectMenu__item designCardMenu__removeFromFolder"\x3e\x3c%- removeFromFolder %\x3e\x3c/div\x3e\x3c% } %\x3e\x3c% if (showRemoveFromAllFolders) { %\x3e\x3cdiv class\x3d"selectMenu__item designCardMenu__removeFromAllFolders"\x3e\x3c%- removeFromAllFolders %\x3e\x3c/div\x3e\x3c% } %\x3e\x3c% if (showRestoreDesign) { %\x3e\x3cdiv class\x3d"selectMenu__item designCardMenu__restoreDesign"\x3e\x3c%- restoreDesign %\x3e\x3c/div\x3e\x3c% } %\x3e\x3c% if (showDeleteForever) { %\x3e\x3cdiv class\x3d"selectMenu__item designCardMenu__deleteForever"\x3e\x3c%- deleteForever %\x3e\x3c/div\x3e\x3c% } %\x3e\x3c% if (showRemoveTemplate) { %\x3e\x3cdiv class\x3d"selectMenu__item designCardMenu__removeTemplate"\x3e\x3c%- removeTemplate %\x3e\x3c/div\x3e\x3c% } %\x3e\x3c/div\x3e');function gd(){}gd=Backbone.View.extend({className:"designCard",tagName:"figure"});d=gd.prototype;d.initialize=function(a){this.analytics=a.analytics||null;this.Ud=!!a.Ud;this.v=a.v;this.Vb=a.Vb;this.Dg=a.Dg;this.ha=null;this.Fa=a.Fa;this.lb=a.lb;this.Je=!!a.Je;this.Ke=!!a.Ke;this.Le=!!a.Le;this.Uc=!!a.Uc;this.Nf=!!a.Nf;this.Ld=!!a.Ld;this.F=a.F;this.Y=a.Y;this.j=a.j;this.ef=!1};
d.events=function(){return{"click .designCardThumbnail":this.Gf,"click .designCardTitle \x3e .more":this.hn,"click .designCardTitle":this.Kp,"keydown .designCardTitle input":this.Mo,"blur .designCardTitle input":this.$j.bind(this,!0),"click .designCardMenuTrigger":this.Cl}};d.hn=function(a){a.preventDefault();td(this.$(".designCardTitle"))};
d.Kp=function(a){!this.Ld||document.getSelection().toString().length||this.ef||this.$el.hasClass("titleEditPending")||this.$el.hasClass("designCardTrashed")||(this.ef=!0,a.preventDefault(),this.render(),this.$el.find(".designCardTitle input").select())};d.$j=function(a){if(this.ef){this.ef=!1;var b=this.$el.find(".designCardTitle input").val().trim().substring(0,255);a&&b!==this.F.getName()&&b!==Sc(new Rc(this.j,this.F.getName()))&&this.trigger("editTitle",b);this.render()}};
d.Mo=function(a){switch(a.keyCode){case 13:this.$j(!0);break;case 27:this.$j(!1)}};
d.Cl=function(){function a(a){this.trigger(a);this.analytics&&this.analytics.ab(a,"homepage",null,"design_card_menu")}this.Fa&&(this.ha&&this.stopListening(this.ha),this.ha=this.Fa(),this.listenTo(this.ha,{copy:a.bind(this,"copy"),trash:a.bind(this,"trash"),removeFromFolder:a.bind(this,"removeFromFolder"),removeFromAllFolders:a.bind(this,"removeFromAllFolders"),restore:a.bind(this,"restore"),deleteForever:a.bind(this,"deleteForever"),editTemplate:a.bind(this,"editTemplate"),removeTemplate:a.bind(this,
"removeTemplate")}),bd(this.ha,this.$(".designCardMenuTrigger")),this.$(".designCardMenuTrigger").toggleClass("pointLeft","rightTop"===this.ha.getCurrentPosition()),this.analytics&&this.analytics.ab("design_card_menu","homepage",null,"design_card"))};d.Gf=function(){this.Ud?this.Cl():this.trigger("thumbnailClick")};d.Hi=function(){return this.dd&&this.dd.Hi()};d.sc=function(){return this.dd};d.Ia=function(){return this.$(".designCardThumbnail")};
d.render=function(){var a=this.F.myRole===Oc,b=this.F.Cg(),c=Ka(this.j);this.$el.data("id",this.F.i());this.$el.html(this.template({isForSale:"APPROVED"==this.F.marketplaceStatus,isOwner:a,isUnderReview:"UNDER_REVIEW"==this.F.marketplaceStatus,socialItem:this.F,showVisibilityIcon:this.Nf,title:Sc(new Rc(this.j,this.F.getName())),editingTitle:this.ef,showEditTitle:this.Ld,newMenuDesign:"undefined"!==typeof this.Fa,stateUnderReview:c.Pp(),stateForSale:c.Np(),stateBrandPublic:c.Mp(),statePublic:c.Op()}));
ud(this.$(".designCardTitle"),100);this.$el.toggleClass("designCardOwnerVisible",this.Uc);xd(this);this.Ke&&(this.lf||(this.lf=new vd({ta:Ka(this.j)})),this.lf.delegateEvents(),this.lf.render().$el.appendTo(this.$el));this.Uc&&this.$("figcaption").prepend(this.Qo({avatarUrl:this.lb.Lc(50),displayName:this.lb.sa(),username:this.lb.Da()}));this.Le&&this.Ij();a=0<this.F.mf();!this.Je||!a&&this.v.za()||(this.Hj(),b&&this.dd.yk(b),jd(this.dd));return this};
d.Hj=function(){this.dd=new od({v:this.v,F:this.F,H:Oa(this.j)});this.dd.render().$el.appendTo(this.$el);this.listenTo(this.dd,{deleteComment:this.trigger.bind(this,"deleteComment"),fetchMoreComments:this.trigger.bind(this,"fetchMoreComments"),postComment:this.Xp})};d.Ij=function(){this.ud=new yd({Ba:this.F.i(),za:this.v.za(),Ca:this.F.gl(),Na:this.F.hl(),Y:this.Y,jb:Qa(this.j)});this.ud.render().$el.prependTo(this.$("figcaption"))};
function xd(a){var b=$("\x3ca\x3e").addClass("designCardThumbnail");if(!a.Ud){var c=a.Vb();b.attr("href",c.href);c.sj&&b.attr("target","_blank")}b.css({backgroundImage:"url('"+a.Dg()+"')",paddingBottom:100/function(){var b=a.F.Ia();return b.hb()/b.Ha()}()+"%"});a.$(".designCardThumbnailContainer").prepend(b)}d.vh=function(a){this.$el.toggleClass("designCardDisabled",a)};d.Oe=function(a){this.$el.toggleClass("designCardInvisible",!a)};
d.nb=P.method(function(a){function b(a){e.addClass("designCardNoTransitions");a();e.removeClass("designCardNoTransitions")}var c,e=this.$el,f=0;if(a===e.hasClass("designCardCollapsed"))return P.delay(500);b(function(){c=e.height();f=a?0:e.height("auto").height();e.height(c).height()});e.height(f);e.toggleClass("designCardCollapsed",a);setTimeout(function(){a||b(function(){e.height("").height()})}.bind(this),500);return P.delay(500)});
d.Rf=function(a){this.$el.toggleClass("designCardDisappeared",a);return P.delay(500)};d.wh=function(a){this.$el.toggleClass("designCardLoading",a)};d.Tf=function(a){this.$el.toggleClass("titleEditPending",a)};d.Xp=function(a){this.trigger("postComment",a)};d.Qo=_.template('\x3ca class\x3d"designCardOwner" href\x3d"\x3c%- "/" + username %\x3e"\x3e\x3cimg src\x3d"\x3c%- avatarUrl %\x3e"\x3e\x3c%- displayName %\x3e\x3c/a\x3e');d.template=_.template('\x3cdiv class\x3d"designCardThumbnailContainer"\x3e\x3c% if (newMenuDesign) { %\x3e\x3cbutton class\x3d"button buttonSmall designCardMenuTrigger"\x3e\x3c/button\x3e\x3c% } %\x3e\x3c% if (isOwner \x26\x26 isUnderReview) { %\x3e\x3cdiv class\x3d"designCardIcon designCardUnderReviewIcon" title\x3d"\x3c%- stateUnderReview %\x3e"\x3e\x3c/div\x3e\x3c% } else if (isForSale) { %\x3e\x3cdiv class\x3d"designCardIcon designCardForSaleIcon" title\x3d"\x3c%- stateForSale %\x3e"\x3e\x3c/div\x3e\x3c% } else if (showVisibilityIcon) { %\x3e\x3c% if (socialItem.brandPublik) { %\x3e\x3cdiv class\x3d"designCardIcon designCardBrandPublicIcon" title\x3d"\x3c%- stateBrandPublic %\x3e"\x3e\x3c/div\x3e\x3c% } else if (socialItem.publik) { %\x3e\x3cdiv class\x3d"designCardIcon designCardPublicIcon" title\x3d"\x3c%- statePublic %\x3e"\x3e\x3c/div\x3e\x3c% } %\x3e\x3c% } %\x3e\x3c/div\x3e\x3cfigcaption\x3e\x3cdiv class\x3d"designCardTitle\x3c% if (showEditTitle) { %\x3e editable\x3c% } %\x3e\x3c% if (editingTitle) { %\x3e editing\x3c% } %\x3e" title\x3d"\x3c%- title %\x3e"\x3e\x3c% if (editingTitle) { %\x3e\x3cinput type\x3d"text" value\x3d"\x3c%- title %\x3e" /\x3e\x3c% } else { %\x3e\x3c%- title %\x3e\x3c% } %\x3e\x3c/div\x3e\x3c/figcaption\x3e');function zd(a){this.pg=a.pg;this.tf=$("\x3ciframe\x3e");this.pl=void 0;this.Za=a.Za;this.Gi=a.Gi;this.ck=$("\x3ciframe\x3e");this.hk=a.hk;this.dh=this.dh.bind(this);window.addEventListener("message",this.dh,!1)}d=zd.prototype;d.on=Backbone.Events.on;d.off=Backbone.Events.off;d.trigger=Backbone.Events.trigger;d.show=function(){var a=Bd(this.Gi,this.pg);this.tf.addClass("designImporterIframe").attr("src",a).hide().appendTo("body");$("body").addClass("modalContentVisible modalContentBlurAndDarkenVisible")};
d.remove=function(){window.removeEventListener("message",this.dh);this.tf.remove();this.ck.remove();$("body").removeClass("modalContentVisible modalContentBlurAndDarkenVisible")};
d.dh=function(a){var b=this.tf.get(0).contentWindow,c=this.ck.get(0).contentWindow,e=a.data&&"designImport"===a.data.type;if(a.origin===window.location.origin&&e)if(a.source===b)switch(a=a.data,a.name){case "import":this.pl=a.data;this.ck.attr("src",Bd(this.hk,this.pg)).hide().appendTo(document.body);break;case "loaded":this.tf.show();break;case "remove":this.remove();break;default:throw Error("unrecognized message from design importer: "+a.name);}else if(a.source===c){a=a.data;b=this.tf.get(0).contentWindow;
if(this.Za.Ra.get(ac))throw Error("design importer does not support team domains");c=window.location.origin;"loaded"===a.name&&(this.trigger("import",this.pl),b.postMessage({type:"designImportIframe",name:"remove"},c))}};function Cd(){this.items=[];this.Gg={}}d=Cd.prototype;d.contains=function(a){return a in this.Gg};d.getItem=function(a){if(!this.contains(a))throw Error('DesignStreamItem for document "'+a+'" not found.');return this.Gg[a]};d.getLength=function(){return this.items.length};d.previous=function(a){var b=this.getLength();a=this.items.indexOf(a);0<=a&&--a;return this.items[(a+b)%b]};d.next=function(a){var b=this.getLength();a=this.items.indexOf(a);return this.items[(a+1)%b]};
function Dd(a,b,c,e){this.Y=a;this.Ba=b.document.i();this.Ok=c.i();this.complete=e;Ed(b,e);a=c.i();Fd[a]=c;if(b=b.te)b=new Gd({eb:[b],N:b.id}),Hd(this.sc(),b)}d=Dd.prototype;d.gb=function(){return Id[this.Ba]};d.mf=function(){var a=this.sc();return a.items.filter(a.rl.bind(a)).length};
d.Ii=function(a,b){var c=new jQuery.Deferred,e=this.sc();if(e.complete||Ld(e,a))return window.setTimeout(function(){var f=e.il(a,b);c.resolve(f)},0),c.promise();if(e.Ue)return e.Ue;Md(this.Y,new Nd({object:this.Ba,limit:b,N:a})).finally(function(){e.Ue=null}).then(function(a){Hd(e,a);c.resolve(a)}).catch(function(a){c.reject(a[1])});e.Ue=c.promise();return e.Ue};
function Od(a,b){function c(a){a=a.document;f.complete=!0;Ed(a,!0);g.resolve(a)}function e(a){g.reject(a[1])}var f=a,g=new jQuery.Deferred,h=a.gb(),l=h.document.extensions["default"];b||!a.complete?a.Y.gb(new Pd({id:a.Ba,vg:l})).then(c).catch(e):window.setTimeout(function(){g.resolve(h)},0);return g.promise()}
d.Qc=function(a,b){var c=this,e=new jQuery.Deferred;this.Y.createComment(new Qd({object:this.Ba,content:a})).then(function(f){f=new Rd({object:c.Ba,id:f.id,dg:b.i(),Dc:b,content:a,Qb:f.Qb,Eh:f.Qb});var g=new Gd({eb:[f],N:f.id});Hd(c.sc(),g);e.resolve(f)}).catch(function(a){e.reject(a[1])});return e.promise()};d.Sb=function(a){var b=this;return this.Y.Sb(new Sd({object:this.Ba,id:a.id})).then(function(){b.sc().Sb(a)})};d.sc=function(){var a=Td[this.Ba];a||(a=new Ud,Td[this.Ba]=a);return a};
function Ed(a,b){var c=a.document.i();c in Id&&!b||(Id[c]=a)}function Vd(a,b,c,e){var f=Id[b];f||(f=new Wd({document:xc({_id:b,creationDate:0,extensions:{"default":c},owningBrand:"",tags:[]}),rg:yc({}),lb:e,gh:0,Na:0,Ye:0,Ca:!1}));return new Dd(a,f,e,!1)}var Id={},Fd={},Td={};function Ud(){this.Kk={};this.items=[];this.complete=!1;this.Ue=null}function Hd(a,b){b.eb.forEach(function(b){var e=Xd(a,b.id);0<=e?a.items[e]=b:a.items.splice(-1*(e+1),0,b)});a.complete=!b.N}
Ud.prototype.Sb=function(a){this.Kk[a.id]=a};Ud.prototype.il=function(a,b){null===a?a=0:(a=Xd(this,a),a=0>a?this.items.length:a+1);b=this.items.slice(a).filter(this.rl.bind(this)).slice(0,b);a=0===b.length?null:_.last(b).i();return new Gd({eb:b,N:a})};function Xd(a,b){for(var c=0,e=a.items.length-1;c<=e;){var f=c+e>>1,g;g=a.items[f].id;g="string"===typeof g?g:g.id;var h=Yd("string"===typeof b?b:b.id);g=Yd(g).localeCompare(h);if(0<g)c=f+1;else if(0>g)e=f-1;else return f}return-c-1}
function Ld(a,b){if(null===b)return 0<a.items.length;b=Xd(a,b);return-1<b&&b<a.items.length-1}Ud.prototype.rl=function(a){return!this.Kk.hasOwnProperty(a.id)};function Yd(a){a=a.split("-");return a[2]+a[1]+a[0]+a[3]+a[4]};function Zd(a){this.ka=new C;this.N=null;this.v=a.v;this.xa=a.xa;this.li=!1;this.nc=a.nc;this.element=$('\x3cdiv class\x3d"designStream"\x3e');this.ml=!0;this.sd=!1;this.Vi=!0;this.Wi=!1;this.ea=new H({bb:function(a){return Math.floor(a/250)}});this.Mg=0;this.Y=a.Y;this.Ah=a.Ah;this.j=a.j;this.ae=Sa(this.j)}_.extend(Zd.prototype,Backbone.Events);d=Zd.prototype;d.on=Backbone.Events.on;d.trigger=Backbone.Events.trigger;
function be(a,b){b=b.map(function(a){return this.wa(a).getElement()[0]},a);a.ea.push($(b))}d.wa=function(a){var b;b=a.document;a=a.Sh;var c=this.aj(b);b=new Dd(this.Y,b,a,!0);var e=this.nc;e.items.push(b);e.Gg[b.Ba]=b;return(new ed({v:this.v,Hc:b,Vb:id.bind(null,c),lb:a,Je:!0,Le:!0,Uc:!0,F:c,Y:this.Y,j:this.j})).render()};d.getElement=function(){return this.element};d.ne=function(){return this.ea.ne()};d.render=function(){this.element.empty().append(this.ea.$el).append(this.ka.render().$el);return this};
d.fetch=function(a){function b(a){var b=a.N,c=a.ak,e=0===c.length&&f.Vi;be(f,c);f.N=b||null;f.ml=!!b;e?f.ph():f.Vi&&(f.Mg=c[0].timestamp,f.Mg>a.read&&(f.li?(a=f,a.li=0===a.Mg,a.li||(b=a.Y,A(b.u,b.path+"/user/stream",ce(new de({read:a.Mg}))).get(0).then(ee).then(a.Hp.bind(a)))):f.Ah.addClass("unread")))}function c(){f.Wi=!0;f.qh()}function e(){f.ka.transitionDelay=-1;f.ka.hide();f.sd=!1;f.Vi=!1}var f=this;!this.ml||this.sd||this.Wi||(this.ka.transitionDelay=void 0!=a?a:-1,this.ka.show(),this.sd=!0,
fe(this.Y,new ge({limit:18,N:this.N})).then(b).catch(c).finally(e))};
d.aj=function(a){var b=a.document,c=a.Ye,e=b.i(),f=he,g=a.te&&ie(a.te),h=a.Ca,l=a.Na,m=b.Xi(this.v,this.xa)?Oc:"VIEWER",q=b.uc(),p=Mc(b),r=b.draft,v=b.draft;return je({commentCount:c,id:e,kind:f,latestComment:g,likedByMe:h,likerCount:l,myRole:m,name:q,publik:p,remixCount:a.gh,tags:b.Oi(),thumbnail:ke({height:r&&r.imageSets.thumbnail?r.imageSets.thumbnail.height:0,url:Jc(b),width:v&&v.imageSets.thumbnail?v.imageSets.thumbnail.width:0}),timestamp:Gc(b),type:le,version:b.getVersion()})};d.wc=function(){this.ea.wc()};
d.op=function(){this.element.find(".designStreamError").remove();this.Wi=!1;this.fetch()};d.ph=function(){this.element.append(this.ti({empty:this.ae.empty()}))};d.qh=function(){this.element.append(this.ce({error:this.ae.error('\x3ca href\x3d"https://support.canva.com/hc/requests/new"\x3e',"\x3c/a\x3e"),loadStream:this.ae.An()}));this.element.find(".designStreamError \x3e button").click(this.op.bind(this))};d.Hp=function(){this.Ah.removeClass("unread")};d.ti=_.template("\x3cp\x3e\x3c%- empty %\x3e\x3c/p\x3e");
d.ce=_.template('\x3cp class\x3d"designStreamError"\x3e\x3c%\x3d error %\x3e\x3cbutton class\x3d"button"\x3e\x3c%- loadStream %\x3e\x3c/button\x3e\x3c/p\x3e');function G(a,b){return location.protocol+"//"+location.host+"/design/"+encodeURIComponent(a)+""+(b?"/"+encodeURIComponent(b):"")}function me(a){var b="/design?create";null!=a.type&&(b+="\x26type\x3d"+encodeURIComponent(a.type));null!=a.width&&(b+="\x26width\x3d"+encodeURIComponent(String(a.width)));null!=a.height&&(b+="\x26height\x3d"+encodeURIComponent(String(a.height)));null!=a.zh&&(b+="\x26units\x3d"+encodeURIComponent(String(a.zh)));return b};function ne(a,b){this.C=a;this.am=b||null;this.Lh=this.fh=null}ne.prototype.read=function(a){this.fh||(oe++,pe.splice(oe,0,this));this.fh=a;if(I==qe||I==re)this.C.requestAnimationFrame(se),I=te;return this};ne.prototype.write=function(a){this.Lh||(ue++,ve.splice(ue,0,this));this.Lh=a;I==qe&&(this.C.requestAnimationFrame(se),I=te);return this};var qe=0,te=1,re=3,I=qe,pe=[],ve=[],oe=0,ue=0;
function se(){var a,b;I=2;ue=-1;for(a=0;a<pe.length;a++){oe=a;b=pe[a];var c=b.fh;b.fh=null;c&&c.call(b.am,b)}pe.length=0;oe=-1;I=re;for(a=0;a<ve.length;a++)ue=a,b=ve[a],c=b.Lh,b.Lh=null,c&&c.call(b.am,b);ve.length=0;ue=-1;I!=te&&(I=qe)};function we(a){this.u=a;this.Mk="/doctypes"}we.prototype.createDocumentType=function(a){return A(this.u,this.Mk,a).get(0).then(xe)};function ye(a){var b=new ze;b.fetchCategories=!0;b=a.Mk+"?"+b.ac();return B(a.u,b).get(0).then(Ae)};function Be(){}Be.prototype.getName=function(){return this.name};Be.prototype.jl=function(){return this.sentenceName};Be.prototype.nf=function(){return this.locale};Be.prototype.Ia=function(){return this.thumbnail};function Ce(){}function De(a){a.descriptions&&Object.keys(a.descriptions).forEach(function(b){a.descriptions[b]=Object.freeze(y(Be,a.descriptions[b]))});return Object.freeze(y(Ce,a))}Ce.prototype.i=function(){return this.id};Ce.prototype.getName=function(){return this.name};
Ce.prototype.getVersion=function(){return this.version};function Ee(){}Ee.prototype.hb=function(){return this.width};Ee.prototype.Ha=function(){return this.height};function Fe(a){switch(a){case "PIXELS":return"px";case "CENTIMETERS":return"cm";case "INCHES":return"in";case "MILLIMETERS":return"mm";default:throw Error("Unknown units: "+a);}}Ee.prototype.print=function(){var a=this.hb(),b=this.Ha(),c=Fe(this.units);return a+c+" × "+b+c};function Ge(){}
function yc(a){a.descriptions&&Object.keys(a.descriptions).forEach(function(b){a.descriptions[b]=Object.freeze(y(Be,a.descriptions[b]))});return Object.freeze(y(Ge,a))}Ge.prototype.Ia=function(){if(this.thumbnail)return Object.freeze(y(He,this.thumbnail))};function He(){}He.prototype.hb=function(){return this.width};He.prototype.getKey=function(){return this.key};He.prototype.fa=function(){return this.url};He.prototype.Ha=function(){return this.height};Ge.prototype.jl=function(){return this.sentenceName};
Ge.prototype.getName=function(){return this.name};Ge.prototype.i=function(){return this.id};Ge.prototype.O=function(){return this.brand};function Ie(){}function xe(a){a=_.extend({},a,{docType:a.docType&&yc(a.docType)});return Object.freeze(y(Ie,a))}function ze(){}d=ze.prototype;d.ac=function(){var a=this;return Object.keys(a).map(function(b){if("object"!==typeof a[b])return b+"\x3d"+encodeURIComponent(a[b])}).filter(function(a){return!!a}).join("\x26")};d.Cc=function(a){this.limit=a;return this};
d.Yc=function(a){this.continuation=a;return this};d.Db=function(){return this.limit};d.ia=function(){return this.continuation};function Je(){}function Ae(a){function b(a){return!!a}a=_.extend({},a,{categories:a.categories&&a.categories.filter(b).map(De),docTypes:a.docTypes&&a.docTypes.filter(b).map(yc)});return Object.freeze(y(Je,a))}Je.prototype.ia=function(){return this.continuation};function Ke(a){this.ed=a.ed;this.xg=void 0;this.ri=a.ri;this.W=a.W;this.view=a.view;this.listenTo(this.view,{clickCustom:this.Zn,clickRetry:this.Xk,expanding:this.Xk,submitCustomDimensions:this.$n})}d=Ke.prototype;d.listenTo=Backbone.Events.listenTo;d.off=Backbone.Events.off;d.on=Backbone.Events.on;d.trigger=Backbone.Events.trigger;d.stopListening=Backbone.Events.stopListening;var Le=new pc(0,0,120,120);
Ke.prototype.$n=function(a){function b(a){return c<=a&&a<=e}var c=Me(40,"px",a.zh),e=Me(5E3,"px",a.zh);b(a.width)&&b(a.height)?(window.open(me(a),String(Date.now())),Ne(this.view)):(window.alert(this.W.format("docTypeSelectorOversizeCustomDimensions",Math.ceil(1E3*c)/1E3,Math.floor(1E3*e)/1E3)),b(a.width)?this.view.Ci():this.view.yg())};Ke.prototype.Zn=function(){this.view.kc.$el.hasClass("docTypeCustomDimensionsShown")?Ne(this.view):Oe(this.view)};
Ke.prototype.Xk=function(){this.xg||(this.xg=ye(this.ri));this.xg.bind(this).then(function(a){var b=this.ed.slice(0,7);Pe(this.view,b,a.docTypes,a.categories)}).then(function(){2===this.view.state&&this.view.Sj()}).catch(function(){Qe(this.view);this.xg=void 0})};Ke.prototype.remove=function(){this.stopListening();this.view.remove()};function J(){}J=Backbone.View.extend({className:"docTypeList",tagName:"ul"});function Re(a,b){var c=b||65;a=Se(a).reverse().each(function(a,b){window.setTimeout(function(){$(b).addClass("docTypeItemDisappearing")},a*c)});return P.delay((a.length-1)*c+500)}J.prototype.Pc=function(a){var b=this,c;this.$el.empty();a.map(function(a){c=0<=J.qm.indexOf(a.id);return $(b.Zi(_.extend({},a,{skipThumbnailShadow:c})))}).forEach(function(a){b.$el.append(a)});this.$el.append($('\x3cli class\x3d"docTypeItem docTypeItemDummy"\x3e\x3c/li\x3e'))};
J.prototype.Bp=function(a){var b=50*(this.$el.children().not(".docTypeItemDummy").each(function(a,b){window.setTimeout(function(){$(b).removeClass("docTypeItemAppearing")},50*a)}).length-1);return P.delay(b+(a?0:300))};J.prototype.rp=function(a){var b=this.$el.children(".docTypeItemDisappearing").each(function(a,b){window.setTimeout(function(){$(b).removeClass("docTypeItemDisappearing")},75*a)});return P.delay(75*(b.length-1)+(a?0:500))};
function Se(a){var b=a.$el.height();return a.$(".docTypeItem").filter(function(){return $(this).position().top+20<=b})}J.prototype.Zi=_.template('\x3cli class\x3d"docTypeItem docTypeItemAppearing \x3c%\x3d showAsNew ? "docTypeItemNew" : "" %\x3e" data-type\x3d"\x3c%- id %\x3e"\x3e\x3ca class\x3d"docTypeItemLink" href\x3d"\x3c%- path %\x3e" target\x3d"_blank"\x3e\x3cfigure class\x3d"docTypeItemFigure"\x3e\x3cimg class\x3d"docTypeItemThumbnail \x3c%\x3d skipThumbnailShadow ? "docTypeItemThumbnail--noShadow" : "" %\x3e" src\x3d"\x3c%- thumbnail.url %\x3e" width\x3d"\x3c%- thumbnail.width %\x3e" height\x3d"\x3c%- thumbnail.height %\x3e"\x3e\x3cfigcaption class\x3d"docTypeItemCaption"\x3e\x3cp class\x3d"docTypeItemName"\x3e\x3c%- name %\x3e\x3c/p\x3e\x3cp class\x3d"docTypeItemDimensions"\x3e\x3c%- dimensions %\x3e\x3c/p\x3e\x3c/figcaption\x3e\x3c/figure\x3e\x3c/a\x3e\x3c/li\x3e');
J.qm=["TABQqnM7Tvw"];function Te(){}Te=J.extend({className:"docTypeList docTypeListBasic"});Te.prototype.Pc=function(a){J.prototype.Pc.apply(this,arguments);this.$el.children().removeClass("docTypeItemAppearing");this.xd=$(this.Hn({more:this.W.Wb()}));this.xd.prependTo(this.$el);this.$el.children().addClass("docTypeItemBasic");this.td()};
Te.prototype.td=function(){this.xd.prependTo(this.$el).css("display","none");this.xd.css("display","");var a=Se(this).length,b=this.$el.children().length;a===b?this.xd.insertBefore(this.$el.children(".docTypeItemDummy")):this.xd.insertBefore(this.$el.children().eq(a))};Te.prototype.initialize=function(a){J.prototype.initialize.apply(this,arguments);this.W=a.W;this.xd=$()};Te.prototype.Hn=_.template('\x3cli class\x3d"docTypeItem docTypeMore"\x3e\x3ca href\x3d"/create-a-design" class\x3d"button buttonLink docTypeButton docTypeMoreButton"\x3e\x3cfigure class\x3d"docTypeItemFigure"\x3e\x3cdiv class\x3d"docTypeMoreThumbnail docTypeItemThumbnail"\x3e\x3c/div\x3e\x3cfigcaption class\x3d"docTypeItemCaption"\x3e\x3cp class\x3d"docTypeItemName"\x3e\x3c%- more %\x3e\x3c/p\x3e\x3cp class\x3d"docTypeItemDimensions"\x3e\x26nbsp;\x3c/p\x3e\x3c/figcaption\x3e\x3c/figure\x3e\x3c/button\x3e\x3c/li\x3e');function Ue(){}Ue=Backbone.View.extend({className:"docTypeCustomDimensions customDimensions",tagName:"form"});d=Ue.prototype;d.initialize=function(a){this.W=a.W};d.events=function(){return{submit:this.bh,"change .docTypeCustomSize":this.Lo,"change .docTypeCustomUnits":this.Oo}};d.yg=function(){this.$(".docTypeCustomWidth").focus()};d.Ci=function(){this.$(".docTypeCustomHeight").focus()};d.hide=function(){this.$el.removeClass("docTypeCustomDimensionsShown")};
d.render=function(){this.$el.html(this.template({times:this.W.times(),width:this.W.width(),height:this.W.height(),pixelsUnit:this.W.Fl(),millimetersUnit:this.W.En(),inchesUnit:this.W.un(),design:this.W.$d()}));return this};d.show=function(){this.$el.addClass("docTypeCustomDimensionsShown");this.yg()};d.Lo=function(a){a=$(a.target);var b=this.$(".docTypeCustomUnits");a.data("userValue",parseFloat(a.val()));a.data("userUnit",b.val())};
d.bh=function(a){a.preventDefault();this.trigger("submitCustomDimensions",{width:parseFloat(this.$(".docTypeCustomWidth").val()),height:parseFloat(this.$(".docTypeCustomHeight").val()),zh:this.$(".docTypeCustomUnits").val()})};
d.Oo=function(a){var b=this.$(".docTypeCustomWidth"),c=this.$(".docTypeCustomHeight"),e=b.data("userUnit"),f=c.data("userUnit"),g=b.data("userValue")||0,h=c.data("userValue")||0;a=a.target.value;g&&(e=Me(g,e,a),b.val("px"===a?Math.ceil(e)+"":e.toFixed(3)));h&&(b=Me(h,f,a),c.val("px"===a?Math.ceil(b)+"":b.toFixed(3)))};d.template=_.template('\x3cdiv class\x3d"docTypeCustomInner"\x3e\x3cinput type\x3d"text" class\x3d"docTypeCustomChild docTypeCustomWidth docTypeCustomSize textInput" placeholder\x3d"\x3c%- width %\x3e"\x3e\x3cspan class\x3d"docTypeCustomChild"\x3e \x3c%- times %\x3e \x3c/span\x3e\x3cinput type\x3d"text" class\x3d"docTypeCustomChild docTypeCustomHeight docTypeCustomSize textInput" placeholder\x3d"\x3c%- height %\x3e"\x3e\x3cspan class\x3d"docTypeCustomChild"\x3e\x3cselect class\x3d"docTypeCustomUnits"\x3e\x3coption value\x3d"px" selected\x3e\x3c%- pixelsUnit %\x3e\x3c/option\x3e\x3coption value\x3d"mm"\x3e\x3c%- millimetersUnit %\x3e\x3c/option\x3e\x3coption value\x3d"in"\x3e\x3c%- inchesUnit %\x3e\x3c/option\x3e\x3c/select\x3e\x3cspan class\x3d"selectArrow"\x3e\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"docTypeCustomChild"\x3e \x3d \x3c/span\x3e\x3cbutton class\x3d"docTypeCustomChild button docTypeCustomizeButton"\x3e\x3c%- design %\x3e\x3c/button\x3e\x3c/div\x3e');function K(){}K=Backbone.View.extend({className:"docTypeSelector"});K.Zf=274;K.Se=500;
K.Xo=function(a){var b=a.Ia(),c=new pc(0,0,b.hb()||100,b.Ha()||100),e=c.width/c.height;c.width/c.height<Le.width/Le.height?(c.height=Le.height,c.width=e*c.height):(c.width=Le.width,c.height=c.width/e);c.left=Le.left-(c.width-Le.width)/2;c.top=Le.top-(c.height-Le.height)/2;c=c.round();e=Object.freeze(y(Ee,a.dimensions));return{id:a.i(),path:me({type:a.i()}),name:a.getName(),thumbnail:{url:b.fa(),width:c.hb(),height:c.Ha()},dimensions:e.print(),showAsNew:!!a.showAsNew}};d=K.prototype;
d.events=function(){return{"click .docTypeLessButton":this.trigger.bind(this,"clickCollapse"),"click .docTypeCustomButton":this.trigger.bind(this,"clickCustom")}};d.initialize=function(a){this.Zc=[];this.ed=a.ed;this.Pb=new Te({W:a.W});this.kc=new Ue({W:a.W});this.state=0;this.W=a.W;this.listenTo(this.Pb,"more",this.trigger.bind(this,"clickExpand"));this.listenTo(this.kc,"submitCustomDimensions",this.trigger.bind(this,"submitCustomDimensions"))};
function Ve(a){function b(){f.addClass("docTypeAdvancedHidden");return P.delay(500).then(c)}function c(){f.removeClass("docTypeAdvancedHidden");e.removeClass("docTypeCategoryAppearing")}var e=a.$(".docTypeAdvanced").find(".docTypeCategory"),f=a.$(".docTypeAdvanced");a.trigger("collapsing");We(a).bind(a).then(function(){return P.join(Xe(this),b())}).then(a.td).then(a.Pb.rp.bind(a.Pb,!0)).then(a.Jn).then(a.vi).then(a.trigger.bind(a,"collapsed"))}
function Ye(a){var b=a.$(".docTypeLessButton");a.trigger("expanding");We(a).bind(a).then(function(){b.addClass("doNotTransition").css(Ze(this)).forceLayout()}).then(function(){var a=this.$el.height();this.$el.removeClass("hidden");Re(this.Pb,0);return $e(this,a,af(this))}).then(a.mh.bind(a,!0)).then(function(){this.$el.addClass("expanded")}).then(a.trigger.bind(a,"expanded")).then(a.vi).delay(K.Se).then(a.Sj).then(function(){b.removeClass("doNotTransition")})}
function bf(a){a.trigger("expanding");We(a).bind(a).then(function(){this.$el.removeClass("hidden");return P.join(cf(this),Re(this.Pb),df(this))}).then(a.mh.bind(a,!0)).then(a.trigger.bind(a,"expanded")).then(a.vi).then(a.Sj)}
d.hide=function(){if(this.$el.hasClass("hidden"))return P.resolve();var a=this.$(".docTypeAdvanced").find(".docTypeCategory"),b=this.$(".docTypeLessButton"),c=Ze(this),e=this.$el.parents().filter(function(){return 0<this.scrollTop}).eq(0),f=e.height(),g;this.trigger("hiding");this.$el.addClass("hidden");e.length&&this.$el.height()>f&&(g=e.scrollTop(),c.top+=g,this.$el.height(f).scrollTop(g),b.css(c),e.scrollTop(0));b=this.$el.height();$e(this,b,0);return P.delay(K.Se).bind(this).then(function(){a.removeClass("docTypeCategoryAppearing");
this.$el.scrollTop(0);this.trigger("hidden")})};d.show=function(){if(!this.$el.hasClass("hidden"))return P.resolve();var a=this.$el.height();this.trigger("showing");this.$el.removeClass("hidden");$e(this,a,K.Zf);return P.delay(K.Se).then(this.trigger.bind(this,"shown"))};d.yg=function(){this.kc.yg()};d.Ci=function(){this.kc.Ci()};
function Ne(a){a.kc.hide();a.$el.removeClass("docTypeCustomDimensionsShown");a.$(".docTypeCustomButton").text(a.W.pk());a.$(".docTypeCategoryHeader").removeClass("docTypeBlur");a.$(".docTypeList").removeClass("docTypeBlur")}d.td=function(){this.Pb.td();2===this.state&&this.$(".docTypeLessButton").css(Ze(this))};
function Pe(a,b,c,e){var f=function(a){return _.groupBy(a,function(a){return a.category})}(c);a.Pc(a.W.format("docTypeSelectorPopularCategoryName"),b);e.forEach(function(a){this.Pc(a.getName(),f[a.i()])},a)}d.Pc=function(a,b){function c(b){return b.Bk===a}var e=b.map(K.Xo);"BASIC"===a?this.Pb.Pc(e):(b=_.find(this.Zc,c),b||(b={Bk:a,view:new J},this.Zc.push(b),this.Ll(b)),b.view.Pc(e))};
d.render=function(){this.$el.html(this.template({title:this.W.title(),showFewerDesigns:this.W.Dp(),useCustomDimensions:this.W.pk()}));this.Pb.render();this.Zc.forEach(this.Ll.bind(this));this.kc.render();this.$(".docTypeBasic").append(this.Pb.$el);this.$(".docTypeInner").append(this.kc.$el);this.Pc("BASIC",this.ed);return this};d.Ll=function(a){var b=$(this.zm({category:a.Bk}));a=a.view.render().$el;a.addClass("docTypeListAdvanced");b.append(a);b.appendTo(this.$(".docTypeAdvanced"))};
d.Ap=function(){$e(this,"","");return P.reduce(this.Zc,function(a,b){a=b.view;a.$el.parents(".docTypeCategory").addClass("docTypeCategoryAppearing");return P.delay(50).then(a.Bp.bind(a,!0))},this.Zc[0])};
function Oe(a){function b(a){var f=c.kc;0<$(a.target).closest(f.$(".docTypeCustomInner")).length||(a.stopPropagation(),a.preventDefault(),Ne(c),document.removeEventListener("click",b,!0))}var c=a;a.kc.show();a.$el.addClass("docTypeCustomDimensionsShown");a.$(".docTypeCustomButton").html(a.W.format("docTypeSelectorDontUseCustomDimensions","\x3cstrong\x3e","\x3c/strong\x3e"));a.$(".docTypeCategoryHeader").addClass("docTypeBlur");a.$(".docTypeList").addClass("docTypeBlur");document.addEventListener("click",
b,!0)}function Qe(a){function b(){e.remove();c.trigger("clickRetry")}var c=a,e=a.$(".docTypeError");0===e.length&&(e=$(a.xi({error:a.W.error(),retry:a.W.Sc()})),a.$(".docTypeAdvanced").append(e),e.find("button").on("click",b))}function We(a){a.$el.css("pointer-events","none");a.$(".docTypeLessButton, .docTypeCustomDimensions").css("pointer-events","none");return P.resolve()}
d.vi=function(){this.$el.css("pointer-events","");this.$(".docTypeLessButton, .docTypeCustomDimensions").css("pointer-events","");return P.resolve()};function af(a){return $(window).height()-a.$el.offset().top-parseInt(a.$el.css("padding-top"),10)+$(window).scrollTop()}function df(a){a.state=3;$e(a,K.Zf,af(a));return P.delay(K.Se)}function ef(a){function b(a){return 0<a.view.$(".docTypeItem").length}return 0<a.Zc.length&&a.Zc.every(b)}
function cf(a){var b=a.$(".docTypeLessButton"),c=ff(a,!1),e=Ze(a);b.css("visibility","visible").css(c).forceLayout().css(e);a.$el.addClass("expanding");return P.delay(700).then(function(){b.css("visibility","");this.$el.removeClass("expanding").addClass("expanded")}.bind(a))}d.Jn=function(){var a=this.$(".docTypeLessButton"),b=ff(this,!0);a.css(b);this.$el.addClass("collapsing").removeClass("expanded").forceLayout();return P.delay(700).then(function(){this.$el.removeClass("collapsing")}.bind(this))};
function ff(a,b){a=a.$(".docTypeMoreButton");var c=a.offset();return{right:$(window).width()-c.left-a.outerWidth(),top:c.top-(b?50:0)}}function Ze(a){var b=a.$el.offset();a=a.$el.outerWidth(!0);return{right:$(window).width()-a-b.left+20,top:b.top+22}}d.mh=function(a){this.$el.toggleClass("docTypeSelectorExpanded",a).forceLayout();this.state=a?2:0};d.Sj=function(){return ef(this)?P.resolve().bind(this).then(this.Ap):P.resolve()};
function Xe(a){a.state=1;$e(a,af(a),K.Zf);return P.delay(K.Se).then(a.mh.bind(a,!1))}function $e(a,b,c){a.$el.addClass("doNotTransition").height(b).forceLayout().removeClass("doNotTransition").height(c)}d.zm=_.template('\x3cdiv class\x3d"docTypeCategory"\x3e\x3ch2 class\x3d"docTypeCategoryHeader"\x3e\x3c%- category %\x3e\x3c/h2\x3e\x3c/div\x3e');d.template=_.template('\x3cdiv class\x3d"docTypeInner"\x3e\x3cdiv class\x3d"docTypeHeader"\x3e\x3ch1 class\x3d"docTypeTitle"\x3e\x3c%- title %\x3e\x3c/h1\x3e\x3cmenu class\x3d"docTypeMenu"\x3e\x3cli class\x3d"docTypeMenuItem"\x3e\x3cbutton class\x3d"button buttonLink docTypeButton docTypeLessButton docTypeMoreThumbnail"\x3e\x3c%- showFewerDesigns %\x3e\x3c/button\x3e\x3c/li\x3e\x3cli class\x3d"docTypeMenuItem"\x3e\x3cbutton class\x3d"button buttonLink docTypeButton docTypeCustomButton"\x3e\x3c%- useCustomDimensions %\x3e\x3c/button\x3e\x3c/li\x3e\x3c/menu\x3e\x3c/div\x3e\x3cdiv class\x3d"docTypeBasic"\x3e\x3c/div\x3e\x3cdiv class\x3d"docTypeAdvanced"\x3e\x3c/div\x3e\x3c/div\x3e');
d.xi=_.template('\x3cp class\x3d"docTypeError"\x3e\x3c%- error %\x3e\x3cbr/\x3e\x3cbutton class\x3d"button"\x3e\x3c%- retry %\x3e\x3c/button\x3e\x3c/p\x3e');function gf(a){var b=this;this.ji=a.ji;this.l=a.l;this.listenTo(this.l,{"fetch:start":this.ko,"fetch:success":this.lo,"fetch:fail":this.kj,"create:start":this.Wn,"create:success":this.Xn,"create:fail":this.Vn,"delete:start":this.fo,"delete:success":this.ho,"change:success":this.gj});this.Uf={};this.ca=a.ca;this.analytics=a.analytics;this.view=a.view;this.listenTo(this.view,{add:this.tm,clickGetMoreFolders:this.Bm,clickQuota:this.Dm,name:function(a,e){return b.lg(a,e)},retry:this.l.fetch})}d=gf.prototype;
d.ko=function(){this.view.Sf(!1);hf(this.view,!1);jf(this.view,!0)};d.lo=function(a){var b=this;jf(this.view,!1);kf(this.view);a.forEach(function(a){return b.view.gc(a)})};d.kj=function(a){jf(this.view,!1);a?hf(this.view,!0):this.view.Sf(!0)};d.Dm=function(){this.analytics.ab("quota_label","homepage","design_folder","design_folder_list");lf(this)};
function lf(a){var b=a.ji();a.listenTo(b,{signup:function(){return window.location="/brand/onboarding/upgrader"},hide:function(){return a.stopListening(b)}});mf(b)}d.tm=function(){var a=L({id:_.uniqueId("fake_"),name:this.ca.lc()});this.analytics.ab("create_folder","homepage","design_folder","design_folder_list");this.view.gc(a,!0);nf(M(this.view,a),!0)};d.Bm=function(){this.analytics.ab("get_more_folders","homepage","design_folder","design_folder_list");lf(this)};
d.lg=function(a,b){b=this.l.create(b);this.Uf[b]=a};d.Wn=function(a){if(a=this.Uf[a])nf(M(this.view,a),!1),M(this.view,a).jk(!1)};d.Xn=function(a){var b=this;delete this.Uf[a];kf(this.view);this.l.ya().forEach(function(a){return b.view.gc(a)})};d.Vn=function(a,b){var c=this.Uf[a];c&&(delete this.Uf[a],a="quota exceeded"===b?this.ca.format("designFolderListCreateFolderQuotaExceededError"):this.ca.format("designFolderListCreateFolderError"),window.alert(a),of(this.view,c))};
d.fo=function(a){M(this.view,a).Oe(!1)};d.ho=function(a){of(this.view,a)};d.gj=function(a,b){var c=this;a===pf?(kf(this.view),this.l.ya().forEach(function(a){return c.view.gc(a)})):a===qf&&rf(M(this.view,b),b).render()};d.qf=function(){var a=this;return this.l.ya().filter(function(a){return N(a,sf)}).map(function(b){return new tf(M(a.view,b).el,b)})};function uf(a,b){a.l.ya().forEach(function(c){N(c,sf)||M(a.view,c).$el.toggleClass("dndDimmed",b)})}d.kf=function(a){this.view.kf(a)};d.listenTo=Backbone.Events.listenTo;
d.off=Backbone.Events.off;d.on=Backbone.Events.on;d.stopListening=Backbone.Events.stopListening;function vf(a){Backbone.View.call(this,_.extend(a,{className:"designFolderList"}))}k(vf,Backbone.View);d=vf.prototype;d.events=function(){var a=this;return{"click .buttonCreateFolder--create":function(){a.trigger("add")},"click .buttonCreateFolder--getMore":function(){a.trigger("clickGetMoreFolders")},"click .buttonRetry":function(){a.trigger("retry")},"click .designFolder a":this.Pn,"click .designFolderList__quotaLabel":function(){return a.trigger("clickQuota")}}};
d.initialize=function(a){this.gi=a.gi;this.qb={};this.ca=a.ca;this.ye=null!==a.ye?a.ye:-1};d.render=function(){Object.keys(this.qb).forEach(function(a){var b=this.qb[a];this.stopListening(b);b.remove();delete this.qb[a]},this);this.$el.html(soydata.VERY_UNSAFE.ordainSanitizedHtml('\x3cmenu class\x3d"sidebarMenu"\x3e\x3c/menu\x3e\x3cmenu class\x3d"designFolderListMenu sidebarMenu"\x3e\x3c/menu\x3e').toString());wf(this);return this};
function wf(a){var b=Object.keys(a.qb).length;a.$("menu:first-child").replaceWith(xf({Ae:a.ca.Ae(),le:a.ca.le(),fe:a.ca.fe(a.ye),Mf:-1!==a.ye,ki:b,bj:a.ye}).toString())}d.Ch=function(a,b){var c=M(this,a);delete this.qb[a.i()];this.qb[b.i()]=c;rf(c,b);c.render()};d.kf=function(a){var b=M(this,a).el;b.classList.add("flashFolder");P.delay(800).then(function(){b.classList.remove("flashFolder")})};
d.gc=function(a,b){var c=this,e=this.gi(a),f=this.$(".designFolderListMenu"),g=e.render().$el;b?g.prependTo(f):g.appendTo(f);this.qb[a.i()]=e;this.listenTo(e,{create:function(a,b){return c.trigger("create",a,b)},name:function(a,b){return c.trigger("name",a,b)}});wf(this)};function kf(a){Object.keys(a.qb).forEach(function(b){return of(a,L({id:b}))})}function of(a,b){var c=M(a,b);a.stopListening(c);c.remove();delete a.qb[b.i()];wf(a)}
function jf(a,b){yf(a,{fk:zf,gk:{Jg:a.ca.format("designFolderListLoadingFolders")},cj:"designFolderListLoading",Di:"loading",visible:b})}d.Sf=function(a){yf(this,{fk:Af,gk:{be:soydata.VERY_UNSAFE.ordainSanitizedHtml(this.ca.be())},cj:"designFolderListError",Di:"error",visible:a})};function hf(a,b){yf(a,{fk:Bf,gk:{Sc:a.ca.Sc(),xe:a.ca.xe()},cj:"designFolderListRetry",Di:"retry",visible:b})}d.select=function(a){Cf(this,M(this,a))};function Ff(a){(a=Gf(a))&&a.$el.toggleClass("selected",!1)}
function M(a,b){if(a=a.qb[b.i()])return a;throw Error("no view for folder: "+b.i());}function Gf(a){var b;_.values(a.qb).some(function(a){if(a.$el.hasClass("selected"))return b=a,!0});return b||null}function yf(a,b){var c=a.$("."+b.cj);a.$el.toggleClass(b.Di,b.visible);b.visible&&0===c.length?(b=b.fk(b.gk).toString(),a.$el.append(b)):b.visible||c.remove()}function Cf(a,b){Gf(a)!==b&&(Ff(a),b.$el.toggleClass("selected",!0))}
d.Pn=function(a){var b=_.values(this.qb),c=$(a.target).closest(".designFolder").get(0),e;b.some(function(a){if(a.el===c)return e=a,!0});Cf(this,e)};function Hf(a){Backbone.View.call(this,{className:"designFolder",tagName:"li"});this.model=a.D;this.yf=!1;this.ca=a.ca}k(Hf,Backbone.View);Hf.prototype.events=function(){var a=this;return{"blur input":function(){a.yf&&(a.yf=!1,If(a))},"focus input":function(){a.yf=!0},"keydown input":function(b){27===b.which&&a.$("input").blur()},"keypress input":function(b){13===b.which&&If(a)}}};
Hf.prototype.render=function(){var a=this.model.getName()||this.ca.lc(),b=this.model.i();this.$el.html(Jf({lc:this.ca.lc(),name:a,link:"/folder/"+b}).toString());this.$el.toggleClass("sharedTeamFolder",!!this.model.shared);return this};function rf(a,b){a.model=b;return a}Hf.prototype.jk=function(a){this.$el.toggleClass("disabled",!a)};function nf(a,b){a.yf=!1;a.$el.toggleClass("naming",b);b&&(a.$("input").select().focus(),a.yf=!0)}Hf.prototype.Oe=function(a){this.$el.toggleClass("hidden",!a)};
function If(a){var b=a.$("input").val().trim()||a.ca.lc();a.$("a").text(b);a.trigger("name",a.model,b)};function xf(a){soy.asserts.assertType(goog.isString(a.Ae)||a.Ae instanceof goog.soy.data.SanitizedContent,"newFolder",a.Ae,"string|goog.soy.data.SanitizedContent");var b=a.Ae;soy.asserts.assertType(goog.isString(a.le)||a.le instanceof goog.soy.data.SanitizedContent,"getMoreFolders",a.le,"string|goog.soy.data.SanitizedContent");var c=a.le;soy.asserts.assertType(goog.isString(a.fe)||a.fe instanceof goog.soy.data.SanitizedContent,"folderQuotaHint",a.fe,"string|goog.soy.data.SanitizedContent");var e=
a.fe;soy.asserts.assertType(goog.isBoolean(a.Mf)||1===a.Mf||0===a.Mf,"showQuota",a.Mf,"boolean");var f=!!a.Mf;soy.asserts.assertType(goog.isNumber(a.ki),"currentCount",a.ki,"number");var g=a.ki;soy.asserts.assertType(goog.isNumber(a.bj),"maxCount",a.bj,"number");a=a.bj;var h=f&&g>=a,b=""+('\x3cmenu class\x3d"sidebarMenu"\x3e\x3cli class\x3d"noTab noHover"\x3e'+Kf({small:!0,Oa:"buttonCreateFolder buttonCreateFolder--"+(h?"getMore":"create"),text:h?c:b})+(f?'\x3cspan class\x3d"designFolderList__quotaLabel" title\x3d"'+
soy.$$escapeHtmlAttribute(e)+'"\x3e'+soy.$$escapeHtml(g)+"/"+soy.$$escapeHtml(a)+"\x3c/span\x3e":"")+"\x3c/li\x3e\x3c/menu\x3e");return soydata.VERY_UNSAFE.ordainSanitizedHtml(b)}
function zf(a){soy.asserts.assertType(goog.isString(a.Jg)||a.Jg instanceof goog.soy.data.SanitizedContent,"loadingText",a.Jg,"string|goog.soy.data.SanitizedContent");return soydata.VERY_UNSAFE.ordainSanitizedHtml('\x3cdiv class\x3d"designFolderListMessage designFolderListLoading"\x3e'+soy.$$escapeHtml(a.Jg)+"\x3c/div\x3e")}goog.DEBUG&&(zf.Zl="DesignFolderListTemplates.loading");
function Af(a){soy.asserts.assertType(goog.isString(a.be)||a.be instanceof goog.soy.data.SanitizedContent,"errorMessageHtml",a.be,"string|goog.soy.data.SanitizedContent");return soydata.VERY_UNSAFE.ordainSanitizedHtml('\x3cdiv class\x3d"designFolderListMessage designFolderListError"\x3e\x3cp\x3e'+soy.$$escapeHtml(a.be)+"\x3c/p\x3e\x3c/div\x3e")}goog.DEBUG&&(Af.Zl="DesignFolderListTemplates.error");
function Bf(a){soy.asserts.assertType(goog.isString(a.Sc)||a.Sc instanceof goog.soy.data.SanitizedContent,"retry",a.Sc,"string|goog.soy.data.SanitizedContent");var b=a.Sc;soy.asserts.assertType(goog.isString(a.xe)||a.xe instanceof goog.soy.data.SanitizedContent,"loadFolders",a.xe,"string|goog.soy.data.SanitizedContent");a=a.xe;return soydata.VERY_UNSAFE.ordainSanitizedHtml('\x3cdiv class\x3d"designFolderListMessage designFolderListRetry"\x3e\x3cp\x3e'+soy.$$escapeHtml(b)+"\x3c/p\x3e"+Kf({Oa:"buttonRetry",
text:a})+"\x3c/div\x3e")}goog.DEBUG&&(Bf.Zl="DesignFolderListTemplates.retry");
function Jf(a){soy.asserts.assertType(goog.isString(a.name)||a.name instanceof goog.soy.data.SanitizedContent,"name",a.name,"string|goog.soy.data.SanitizedContent");var b=a.name;soy.asserts.assertType(goog.isString(a.link)||a.link instanceof goog.soy.data.SanitizedContent,"link",a.link,"string|goog.soy.data.SanitizedContent");var c=a.link;soy.asserts.assertType(goog.isString(a.lc)||a.lc instanceof goog.soy.data.SanitizedContent,"defaultName",a.lc,"string|goog.soy.data.SanitizedContent");a=a.lc;return soydata.VERY_UNSAFE.ordainSanitizedHtml('\x3ca class\x3d"sidebarMenuLink" href\x3d"'+
soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(c))+'" title\x3d"'+soy.$$escapeHtmlAttribute(b)+'"\x3e'+soy.$$escapeHtml(b)+'\x3c/a\x3e\x3cinput type\x3d"text" placeholder\x3d"'+soy.$$escapeHtmlAttribute(a)+'" maxlength\x3d"255" value\x3d"'+soy.$$escapeHtmlAttribute(b)+'" /\x3e')};function Kf(a){soy.asserts.assertType(null==a.attributes||a.attributes instanceof soydata.SanitizedHtmlAttribute||a.attributes instanceof soydata.UnsanitizedText||goog.isString(a.attributes),"attributes",a.attributes,"?soydata.SanitizedHtmlAttribute|string|undefined");var b=a.attributes;soy.asserts.assertType(null==a.block||goog.isBoolean(a.block)||1===a.block||0===a.block,"block",a.block,"boolean|null|undefined");var c=a.block;soy.asserts.assertType(null==a.type||a.type instanceof goog.soy.data.SanitizedContent||
goog.isString(a.type),"type",a.type,"null|string|undefined");var e=a.type;soy.asserts.assertType(null==a.Oa||a.Oa instanceof goog.soy.data.SanitizedContent||goog.isString(a.Oa),"classes",a.Oa,"null|string|undefined");var f=a.Oa;soy.asserts.assertType(null==a.disabled||goog.isBoolean(a.disabled)||1===a.disabled||0===a.disabled,"disabled",a.disabled,"boolean|null|undefined");var g=a.disabled;soy.asserts.assertType(null==a.href||a.href instanceof goog.soy.data.SanitizedContent||goog.isString(a.href),
"href",a.href,"null|string|undefined");var h=a.href;soy.asserts.assertType(null==a.id||a.id instanceof goog.soy.data.SanitizedContent||goog.isString(a.id),"id",a.id,"null|string|undefined");var l=a.id;soy.asserts.assertType(null==a.small||goog.isBoolean(a.small)||1===a.small||0===a.small,"small",a.small,"boolean|null|undefined");var m=a.small;soy.asserts.assertType(null==a.tagName||a.tagName instanceof goog.soy.data.SanitizedContent||goog.isString(a.tagName),"tagName",a.tagName,"null|string|undefined");
var q=a.tagName;soy.asserts.assertType(goog.isString(a.text)||a.text instanceof goog.soy.data.SanitizedContent,"text",a.text,"string|goog.soy.data.SanitizedContent");a=a.text;var p=q?q:"button",b=""+("\x3c"+soy.$$filterHtmlElementName(p)+" "+(b?" "+soy.$$filterHtmlAttributes(b):"")+" "+(e?'type\x3d"'+soy.$$escapeHtmlAttribute(e)+'"':"")+' class\x3d"button'+(c?" buttonBlock":"")+(f?" "+soy.$$escapeHtmlAttribute(f):"")+(g&&"a"==q?" disabled":"")+(m?" buttonSmall":"")+'"'+(h?' href\x3d"'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(h))+
'"':"")+(l?' id\x3d"'+soy.$$escapeHtmlAttribute(l)+'"':"")+(g&&"a"!=q?" disabled":"")+"\x3e"+soy.$$escapeHtml(a)+"\x3c/"+soy.$$filterHtmlElementName(p)+"\x3e");return soydata.VERY_UNSAFE.ordainSanitizedHtml(b)};function Lf(a){this.u=a;this.url="/folders"}d=Lf.prototype;d.lg=P.method(function(a){return A(this.u,this.url+"/~",a).get(0).then(Mf)});d.Yk=P.method(function(a){a=this.url+"/~?"+Nf(a);return B(this.u,a).get(0).then(Of)});d.Z=P.method(function(a){a=this.fa(a.Z());return B(this.u,a).get(0).then(Pf)});d.fa=function(a){var b=a.oe();return b?[this.url,"~/system",b.X(),b.rb()].join("/"):[this.url,a.i()].join("/")};d.gp=P.method(function(a){var b=this.fa(a.Z())+"?removeItems";return A(this.u,b,a).return()});
d.vd=P.method(function(a){a=this.fa(a.Z())+"?list\x26"+a.ac();return B(this.u,a).get(0).then(Qf)});P.method(function(a){var b=this.fa(a.Mq())+"?moveItems";return A(this.u,b,a).return()});Lf.prototype.Ch=P.method(function(a){var b;if(a.Z().oe())throw Error("System folders cannot be updated");b=this.url+"/"+a.Z().i();return A(this.u,b,a).get(0).then(Rf)});function Sf(){}d=Sf.prototype;d.ac=function(){var a=this;return Object.keys(a).map(function(b){if("object"!==typeof a[b])return b+"\x3d"+encodeURIComponent(a[b])}).filter(function(a){return!!a}).join("\x26")};d.rk=function(a){this.items=a;return this};d.Bc=function(a){this.folder=a;return this};d.qd=function(){return this.items};d.Z=function(){return this.folder};function Tf(){}function Uf(a){return Object.freeze(y(Tf,a))}Tf.prototype.i=function(){return this.id};
Tf.prototype.oe=function(){if(this.systemFolder)return Object.freeze(y(Vf,this.systemFolder))};function Wf(a){return a.oe()?Uf({systemFolder:Object.freeze(y(Vf,{brand:a.O(),type:a.oe(),user:a.X()}))}):Uf({id:a.i()})}function Vf(){}Vf.prototype.O=function(){return this.brand};Vf.prototype.rb=function(){return this.type};Vf.prototype.X=function(){return this.user};function Xf(){}function Rf(a){return Object.freeze(y(Xf,a))}Xf.prototype.Z=function(){if(this.folder)return L(this.folder)};
Xf.prototype.Cb=function(){return this.access};function Yf(a){a=void 0===a?{}:a;this.id=a.id||"";this.thumbnail=a.hr;this.systemFolder=a.Nd||null;this.acl=a.Ka;this.access=a.Nh;this.name=a.name||null;this.description=a.description||null;this.brand=a.G||"";this.itemCount=a.Vq||0;this.user=a.o||"";this.modifiedDate=a.Zq||0;this.shared=a.dr||!1;this.type=a.type||Zf}var Zf="DESIGN";function L(a){return Object.freeze(y(Yf,a))}Yf.prototype.i=function(){return this.id};
Yf.prototype.Ia=function(){if(this.thumbnail)return Object.freeze(y($f,this.thumbnail))};Yf.prototype.oe=function(){return this.systemFolder};var Uc="LOGOS",Vc="UNFOLDERED";d=Yf.prototype;d.ie=function(){if(this.acl)return Object.freeze(y(ag,this.acl))};d.Cb=function(){if(this.access)return this.access};d.getName=function(){return this.name};d.Bg=function(){return this.description};d.O=function(){return this.brand};d.X=function(){return this.user};d.rb=function(){return this.type};
d.bd=function(a){a=_.extend(_.pick(this,Object.keys(this)),a);return L(a)};function N(a,b){var c;if(c="undefined"!==typeof a.Cb())c=[bg,cg,sf,dg],c=c.indexOf(a.Cb())<=c.indexOf(b);return c}L({brand:"",id:"FACEBOOK",itemCount:0,modifiedDate:0,name:"Facebook",systemFolder:null,thumbnail:{height:200,url:"https://static.canva.com/static/images/upload_folder_facebook.png",width:200},user:""});
var Wc=L({brand:"",id:"UPLOADED_MEDIA",itemCount:0,modifiedDate:0,name:null,systemFolder:null,thumbnail:{height:200,url:"https://static.canva.com/static/images/default_folder_thumbnail_grey_bg.png",width:200},user:""}),Xc=L({brand:"",id:"ROYALTY_FREE",itemCount:0,modifiedDate:0,name:null,systemFolder:null,thumbnail:{height:200,url:"https://static.canva.com/static/images/purchased_folder_thumbnail.png",width:200},user:""});function $f(){}$f.prototype.Ha=function(){return this.height};$f.prototype.hb=function(){return this.width};
$f.prototype.fa=function(){return this.url};function ag(a){a=void 0===a?{}:a;this.entries=a.entries}ag.prototype.bd=function(a){a=_.extend(_.pick(this,Object.keys(this)),a);return Object.freeze(y(ag,a))};ag.prototype.getEntries=function(){if(this.entries)return this.entries.filter(function(a){return!!a}).map(function(a){return Object.freeze(y(eg,a))})};function eg(a){a=void 0===a?{}:a;this.user=a.o;this.brand=a.G;this.access=a.Nh}
eg.prototype.bd=function(a){a=_.extend(_.pick(this,Object.keys(this)),a);return Object.freeze(y(eg,a))};eg.prototype.O=function(){return this.brand};eg.prototype.Cb=function(){return this.access};var dg="VIEWER",sf="EDITOR",cg="ADMIN",bg="OWNER";eg.prototype.X=function(){return this.user};function fg(){}d=fg.prototype;d.ac=function(){var a=this;return Object.keys(a).map(function(b){if("object"!==typeof a[b])return b+"\x3d"+encodeURIComponent(a[b])}).filter(function(a){return!!a}).join("\x26")};
d.Bc=function(a){this.folder=a;return this};d.sk=function(a){this.name=a;return this};d.Z=function(){if(this.folder)return Uf(this.folder)};d.ie=function(){if(this.acl)return Object.freeze(y(ag,this.acl))};d.getName=function(){return this.name};d.Bg=function(){return this.description};function gg(){}gg.prototype.i=function(){return this.id};gg.prototype.rb=function(){return this.type};function hg(){}function Qf(a){return Object.freeze(y(hg,a))}hg.prototype.qd=function(){if(this.items)return this.items.filter(function(a){return!!a}).map(function(a){return ig(a)})};
hg.prototype.ia=function(){return this.continuation};hg.prototype.Z=function(){if(this.folder)return L(this.folder)};hg.prototype.Cb=function(){return this.access};function jg(){}function ig(a){return Object.freeze(y(jg,a))}d=jg.prototype;d.i=function(){return this.id};d.Ia=function(){if(this.thumbnail)return Object.freeze(y($f,this.thumbnail))};d.getName=function(){return this.name};d.rb=function(){return this.type};d.bd=function(a){a=_.extend(_.pick(this,Object.keys(this)),a);return ig(a)};
function kg(){}d=kg.prototype;d.ac=function(){var a=this;return Object.keys(a).map(function(b){if("object"!==typeof a[b])return b+"\x3d"+encodeURIComponent(a[b])}).filter(function(a){return!!a}).join("\x26")};d.Cc=function(a){this.limit=a;return this};d.Bc=function(a){this.folder=a;return this};d.Yc=function(a){this.continuation=a;return this};d.Db=function(){return this.limit};d.Z=function(){if(this.folder)return Uf(this.folder)};d.ia=function(){return this.continuation};function pg(){}
function Pf(a){return Object.freeze(y(pg,a))}pg.prototype.Z=function(){if(this.folder)return L(this.folder)};pg.prototype.Cb=function(){return this.access};function qg(){}function Of(a){return Object.freeze(y(qg,a))}qg.prototype.ya=function(){if(this.folders)return this.folders.filter(function(a){return!!a}).map(function(a){return L(a)})};qg.prototype.ia=function(){return this.continuation};function rg(){}d=rg.prototype;
d.ac=function(){var a=this;return Object.keys(a).map(function(b){if("object"!==typeof a[b])return b+"\x3d"+encodeURIComponent(a[b])}).filter(function(a){return!!a}).join("\x26")};d.Cc=function(a){this.limit=a;return this};d.ec=function(a){this.brand=a;return this};d.Yf=function(a){this.user=a;return this};function sg(){var a=new rg;a.folderTypes=[Zf];return a}d.Yc=function(a){this.continuation=a;return this};d.rk=function(a){this.items=a;return this};function tg(a,b){a.accessFilter=b;return a}
d.Db=function(){return this.limit};d.O=function(){return this.brand};d.X=function(){return this.user};d.ia=function(){return this.continuation};function Nf(a){return Object.keys(a).map(function(a){var c=this[a];if(Array.isArray(c))return a+"\x3d"+c.map(encodeURIComponent).join(",");if("object"!==typeof c)return a+"\x3d"+encodeURIComponent(c)},a).filter(Boolean).join("\x26")}function ug(){}function Mf(a){return Object.freeze(y(ug,a))}ug.prototype.Cb=function(){return this.access};ug.prototype.Z=function(){if(this.folder)return L(this.folder)};
function vg(){}d=vg.prototype;d.ac=function(){var a=this;return Object.keys(a).map(function(b){if("object"!==typeof a[b])return b+"\x3d"+encodeURIComponent(a[b])}).filter(function(a){return!!a}).join("\x26")};d.sk=function(a){this.name=a;return this};d.ec=function(a){this.brand=a;return this};d.Yf=function(a){this.user=a;return this};function wg(a){a.type=Zf;return a}d.getName=function(){return this.name};d.O=function(){return this.brand};d.X=function(){return this.user};d.rb=function(){return this.type};function xg(a){this.u=a;this.path="/profile"}xg.prototype.X=P.method(function(a){return B(this.u,this.path+"/users/"+encodeURIComponent(a)).get(0).then(O)});function yg(a){var b=R.$f;B(a.u,a.path+"/user/uiinfo").get(0).then(function(a){if(!0===a[b])return a;a[b]=!0;return A(this.u,this.path+"/user/uiinfo",a).get(0)}.bind(a))}function zg(a,b){return A(a.u,a.path+"/users/"+encodeURIComponent(b.user),b).get(0).then(Ag)}xg.prototype.O=function(a){return B(this.u,this.path+"/brands/"+encodeURIComponent(a)).get(0).then(Bg)};
P.method(function(a){var b=this.path+"/brands/"+encodeURIComponent(a.O())+"/invitations";return A(this.u,b,a).spread(Cg)});P.method(function(a){a=this.path+"/brands/"+encodeURIComponent(a.O())+"/invitations?"+(null!=a.ia()?"\x26continuation\x3d"+encodeURIComponent(a.ia()):"")+(null!=a.Db()?"\x26limit\x3d"+encodeURIComponent(a.Db()):"")+(a.countOnly?"\x26countOnly\x3d"+encodeURIComponent(a.countOnly):"");return B(this.u,a).spread(Dg)});
P.method(function(a){var b=this.path+"/brands/"+encodeURIComponent(a.O())+"/invitations?update\x3dtrue";return A(this.u,b,a).spread(Eg)});
xg.prototype.hf=P.method(function(a){a=this.path+"/brands/"+encodeURIComponent(a.O())+"/members?"+(a.includeAvatars?"\x26includeAvatars\x3d"+encodeURIComponent(a.includeAvatars):"")+(a.includeEmails?"\x26includeEmails\x3d"+encodeURIComponent(a.includeEmails):"")+(a.countOnly?"\x26countOnly\x3d"+encodeURIComponent(a.countOnly):"")+(null!=a.ia()?"\x26continuation\x3d"+encodeURIComponent(a.ia()):"")+(null!=a.Db()?"\x26limit\x3d"+encodeURIComponent(a.Db()):"");return B(this.u,a).spread(Fg)});
P.method(function(a){var b=this.path+"/brands/"+encodeURIComponent(a.O())+"/members";return A(this.u,b,a).spread(Gg)});function Hg(a,b){return B(a.u,a.path+"/names/available?"+("assignee"in b?"\x26assignee\x3d"+encodeURIComponent(b.assignee):"")+("username"in b?"\x26username\x3d"+encodeURIComponent(b.username):"")+("brandname"in b?"\x26brandname\x3d"+encodeURIComponent(b.brandname):"")+("email"in b?"\x26email\x3d"+encodeURIComponent(b.email):"")).get(0).then(Ig)}
function Jg(a,b){return A(a.u,a.path+"/user/avatars",{mimeType:b}).get(0).then(Kg)}function Lg(a,b,c){return A(a.u,a.path+"/user/avatars/"+b,{version:b,mimeType:c}).spread(function(a){if(!a.ok)return P.reject()})};function Mg(){}Mg.prototype.clone=function(){return Object.freeze(y(Mg,JSON.parse(JSON.stringify(this))))};Mg.prototype.equals=function(a){function b(a){for(var e in a){var f=a[e];null===f?delete a[e]:f instanceof Object&&b(f)}return a}return _.isEqual(b(JSON.parse(JSON.stringify(this))),b(JSON.parse(JSON.stringify(a))))};Mg.prototype.al=function(){if(this.brandColor)return Object.freeze(y(Ng,this.brandColor))};function Ng(a){this.hexString=a.Sq;this.name=a.name}Ng.prototype.getName=function(){return this.name};
Ng.prototype.bd=function(a){a=_.extend(_.pick(this,Object.keys(this)),a);return Object.freeze(y(Ng,a))};function Og(a){a=void 0===a?{}:a;this.id=a.id||"";this.displayName=a.displayName||null;this.brandname=a.yq||null;this.personal=a.$q||!1;this.contributor=a.Aq||!1;this.thirdParty=a.fr||!1;this.brandColor=a.$c||null}Og.prototype.i=function(){return this.id};Og.prototype.sa=function(){return this.displayName};Og.prototype.bl=function(){return this.brandname};Og.prototype.al=function(){return this.brandColor};
function Bg(a){if(!a)return null;var b=y(Og,a);a.brandKit&&(b.brandKit=Object.freeze(y(Mg,a.brandKit)));return b}var qd="ROOT",rd="SUPPORT";function Pg(a){a=void 0===a?{}:a;this.id=a.id||"UNKNOWN_USER_ID";this.username=a.username||"";this.personalBrand=a.vj||"";this.displayName=a.displayName||"";this.homepage=a.Tq||null;this.city=a.zq||null;this.countryCode=a.Cq||null;this.avatar=a.xq||null;this.roles=a.Ql||[];this.deactivated=a.Fq||!1}d=Pg.prototype;d.i=function(){return this.id};d.Da=function(){return this.username};
d.me=function(){return this.personalBrand};d.sa=function(){return this.displayName};d.fl=function(){return this.homepage};d.cl=function(){return this.city};d.Ji=function(){return this.countryCode};d.je=function(){return this.avatar};d.tc=function(){return this.roles};function O(a){if(!a)return null;a=y(Pg,a);a.avatar&&(a.avatar=Qg(a.avatar));return a}d.Lc=function(a){var b=this.je();return b&&(a=Rg(b,a))?a.fa():null};d.za=function(){return"UAAAAAAAAAA"===this.id};function Sg(){}
function Tg(){this.id="";this.creationDate=0;this.temporary=this.deactivated=!1;this.email=this.displayName="";this.emailVerified=!1;this.username="";this.userNotificationSettings=this.countryCode=this.city=this.homepage=null;this.avatars=[];this.facebook=this.credentials=this.avatar=null;this.apiDetails=this["google]"]=null;this.roles=[];this.personalBrand="";this.brands={};this.uiInfo=null;this.features=[]}d=Tg.prototype;d.i=function(){return this.id};d.Ki=function(){return this.creationDate};
d.sa=function(){return this.displayName};d.Mc=function(){return this.email};d.Da=function(){return this.username};d.fl=function(){return this.homepage};d.cl=function(){return this.city};d.Ji=function(){return this.countryCode};d.zg=function(){if(this.avatars)return this.avatars.map(Qg)};d.je=function(){return this.avatar};d.tc=function(){return this.roles};d.me=function(){return this.personalBrand};d.kl=function(){return this.uiInfo};d.Lc=function(a){var b=this.je();return b&&(a=Rg(b,a))?a.fa():null};
d.za=function(){return"UAAAAAAAAAA"===this.id};d.bm=function(){return O({id:this.id,username:this.username,personalBrand:this.personalBrand,displayName:this.displayName,homepage:this.homepage,city:this.city,countryCode:this.countryCode,avatar:this.avatar,roles:this.roles,deactivated:this.deactivated})};function Ug(a){a=void 0===a?{}:a;this.version=a.version||0;this.sizes=a.sizes||{}}Ug.prototype.getVersion=function(){return this.version};Ug.prototype.zg=function(){return this.sizes};
function Rg(a,b){return a.sizes&&a.sizes[b]||null}function Qg(a){if(!a)return null;a=y(Ug,a);var b;var c=a.sizes,e={};if(c){for(b in c){var f=b,g;g=(g=c[b])?y(Vg,g):null;e[f]=g}b=e}else b=null;a.sizes=b;return a}function Vg(a){a=void 0===a?{}:a;this.size=a.size||0;this.width=a.width||0;this.height=a.height||0;this.url=a.url||""}Vg.prototype.hb=function(){return this.width};Vg.prototype.Ha=function(){return this.height};Vg.prototype.fa=function(){return this.url};
var Wg=Qg({version:0,sizes:{50:{size:50,width:50,height:50,url:"https://static.canva.com/static/images/default_avatar_50.png"},200:{size:200,width:200,height:200,url:"https://static.canva.com/static/images/default_avatar_200.png"}}});function Xg(){this.user="";this.generateApiKeyWithType=this.avatar=this.locale=this.countryCode=this.city=this.homepage=this.currentPassword=this.roles=this.displayName=this.password=this.username=this.emailVerified=this.email=null}Xg.prototype.Kh=function(a){this.user=a;return this};
function Yg(a,b){a.username=b;return a}function Zg(a,b){a.displayName=b;return a}function $g(a,b){a.homepage=b;return a}function ah(a,b){a.city=b;return a}function bh(a,b){a.countryCode=b;return a}function ch(a){a.locale="es-ES";return a}function dh(){this.user=void 0;this.verificationEmailSent=null}dh.prototype.X=function(){return this.user};
function Ag(a){if(!a)return null;a=y(dh,a);var b;b=a.user;var c;b?(c=y(Tg,b),c.avatar=Qg(c.avatar),b.userNotificationSettings&&(c.userNotificationSettings=y(Sg,b.userNotificationSettings)),b=c):b=null;a.user=b;return a}function eh(){this.brandname=this.username=this.email=this.assignee=null}function fh(a){var b=new eh;b.assignee=null;b.email=null;b.username=a;b.brandname=null;return b}function gh(a,b){var c=new eh;c.assignee=b;c.email=null;c.username=a;c.brandname=null;return c}
function hh(){this.brandname=this.username=this.email=null}hh.prototype.Mc=function(){return this.email};hh.prototype.Da=function(){return this.username};hh.prototype.bl=function(){return this.brandname};function Ig(a){return a?y(hh,a):null}function ih(){this.version=0;this.originalUrl=""}ih.prototype.getVersion=function(){return this.version};ih.prototype.fa=function(){return this.originalUrl};function Kg(a){return a?y(ih,a):null}function jh(){}function Cg(a){return Object.freeze(y(jh,a))}
function kh(){}kh.prototype.ia=function(){return this.continuation};kh.prototype.getCount=function(){return this.count};function Dg(a){return Object.freeze(y(kh,a))}function lh(a){a=void 0===a?{}:a;this.user=a.o;this.email=a.email;this.role=a.br}lh.prototype.X=function(){return O(this.user)};lh.prototype.Mc=function(){return this.email};function mh(a){return Object.freeze(y(lh,a))}function nh(){}d=nh.prototype;d.ec=function(a){this.brand=a;return this};d.O=function(){return this.brand};
d.Yc=function(a){this.continuation=a;return this};d.ia=function(){return this.continuation};d.Cc=function(a){this.limit=a;return this};d.Db=function(){return this.limit};function oh(a){a.includeAvatars=!0;return a}function ph(a){a.includeEmails=!0;return a}function qh(){var a=new nh;a.countOnly=!0;return a}function rh(a){a=void 0===a?{}:a;this.members=a.wd}rh.prototype.pf=function(){return this.members.map(mh)};rh.prototype.ia=function(){return this.continuation};rh.prototype.getCount=function(){return this.count};
function Fg(a){return Object.freeze(y(rh,a))}function sh(){}sh.prototype.pf=function(){return this.members.map(mh)};sh.prototype.O=function(){return this.brand};function Gg(a){return Object.freeze(y(sh,a))}function th(){}function Eg(a){return Object.freeze(y(th,a))};function uh(a){this.u=a;this.path="/social"}uh.prototype.gb=function(a){var b=a.vg;return B(this.u,this.path+"/documents/"+encodeURIComponent(a.id)+"/profile"+(b?"?extension\x3d"+encodeURIComponent(b):"")).get(0).then(vh)};function wh(a,b){var c=b.ge;return A(a.u,c?a.path+"/users/"+encodeURIComponent(c)+"/followees":a.path+"/user/followees",xh(b)).get(0).then(yh)}
function zh(a,b){var c=b.ge;return Ah(a.u,c?a.path+"/users/"+encodeURIComponent(c)+"/followees/"+encodeURIComponent(b.Kc):a.path+"/user/followees/"+encodeURIComponent(b.Kc)).get(0).then(Bh)}function Ch(a,b){var c=b.ve;return A(a.u,c?a.path+encodeURIComponent(c)+"/likes":a.path+"/user/likes",Dh(b)).get(0).then(Eh)}function Fh(a,b){var c=b.ve;return Ah(a.u,c?a.path+"/users/"+encodeURIComponent(c)+"/likes/"+encodeURIComponent(b.sb):a.path+"/user/likes/"+encodeURIComponent(b.sb)).get(0).then(Gh)}
function Md(a,b){var c=b.N;return B(a.u,a.path+"/comments/"+encodeURIComponent(b.object)+"?limit\x3d"+encodeURIComponent(String(b.limit))+(c?"\x26continuation\x3d"+encodeURIComponent(c):"")).get(0).then(Hh)}uh.prototype.createComment=function(a){return A(this.u,this.path+"/comments/"+encodeURIComponent(a.object),Ih(a)).get(0).then(Jh)};uh.prototype.Sb=function(a){return Ah(this.u,this.path+"/comments/"+encodeURIComponent(a.object)+"/"+encodeURIComponent(a.id)).get(0).then(Kh)};
function fe(a,b){var c=b.N;return B(a.u,a.path+"/user/stream?limit\x3d"+encodeURIComponent(String(b.limit))+(c?"\x26continuation\x3d"+encodeURIComponent(c):"")).get(0).then(Lh)};function Mh(a){switch(a){case "COMMENT":return"COMMENT";case "FOLLOW":return"FOLLOW";case "LIKE":return"LIKE";case "PUBLICIFY":return"PUBLICIFY";default:throw new TypeError('expected ActivityVerb for property "verb", found: '+JSON.stringify(a));}}function Wd(a){this.document=a.document;this.rg=a.rg;this.lb=a.lb;this.gh=a.gh;this.Na=a.Na;this.Ye=a.Ye;this.Ca=a.Ca;this.te=a.te}d=Wd.prototype;d.getDocument=function(){return this.document};d.hl=function(){return this.Na};d.mf=function(){return this.Ye};
d.gl=function(){return this.Ca};d.Cg=function(){return this.te};function Nh(a){var b=xc(t.required("document",a)),c=yc(t.required("documentType",a)),e=O(t.required("owner",a)),f=pa.optional("remixCount",a)||0,g=pa.optional("likerCount",a)||0,h=pa.optional("commentCount",a)||0,l=oa.optional("likedByMe",a)||!1,m;m=Oh;m=(a=t.optional("latestComment",a))?m(a):a;return new Wd({document:b,rg:c,lb:e,gh:f,Na:g,Ye:h,Ca:l,te:m})}
function Rd(a){this.object=a.object;this.id=a.id;this.dg=a.dg;this.Dc=a.Dc;this.content=a.content;this.Qb=a.Qb;this.Eh=a.Eh;this.mi=a.mi}Rd.prototype.i=function(){return this.id};Rd.prototype.getContent=function(){return this.content};
function ie(a){var b=u.required("object",a.object),c=u.required("id",a.id),e=u.required("authorId",a.dg),f;f=ua.required("author",a.Dc);return{object:b,id:c,authorId:e,author:f,content:u.optional("content",a.content),created:va("created",a.Qb),updated:va("updated",a.Eh),deleter:u.optional("deleter",a.mi)}}
function Oh(a){return new Rd({object:n.required("object",a),id:n.required("id",a),dg:n.required("authorId",a),Dc:O(t.required("author",a)),content:n.optional("content",a),Qb:pa.optional("created",a)||0,Eh:pa.optional("updated",a)||0,mi:n.optional("deleter",a)})}function Ph(a){this.document=a.document;this.jm=a.jm;this.Sh=a.Sh;this.timestamp=a.timestamp}Ph.prototype.getDocument=function(){return this.document};
function Qh(a){var b=Nh(t.required("document",a)),c;c=Mh(n.required("verb",a));return new Ph({document:b,jm:c,Sh:O(t.required("actor",a)),timestamp:pa.optional("timestamp",a)||0})}function Pd(a){this.id=a.id;this.vg=a.vg;this.gq=a.gq}Pd.prototype.i=function(){return this.id};Pd.prototype.getExtension=function(){return this.vg};function Rh(a){this.document=a.document}Rh.prototype.getDocument=function(){return this.document};function vh(a){return new Rh({document:Nh(t.required("document",a))})}
function Sh(a){this.ge=a.ge;this.type=a.type;this.Kc=a.Kc}Sh.prototype.rb=function(){return this.type};function xh(a){return{follower:u.optional("follower",a.ge),type:u.required("type",a.type),followee:u.required("followee",a.Kc)}}function Th(){}function yh(){return new Th}function Uh(a){this.ge=a.ge;this.type=a.type;this.Kc=a.Kc}Uh.prototype.rb=function(){return this.type};function Vh(){}function Bh(){return new Vh}function Wh(a){this.ve=a.ve;this.type=a.type;this.sb=a.sb}Wh.prototype.rb=function(){return this.type};
function Dh(a){return{liker:u.optional("liker",a.ve),type:u.required("type",a.type),liked:u.required("liked",a.sb)}}function Xh(){}function Eh(){return new Xh}function Yh(a){this.ve=a.ve;this.type=a.type;this.sb=a.sb}Yh.prototype.rb=function(){return this.type};function Zh(){}function Gh(){return new Zh}function Qd(a){this.object=a.object;this.content=a.content}Qd.prototype.getContent=function(){return this.content};
function Ih(a){return{object:u.required("object",a.object),content:u.required("content",a.content)}}function $h(a){this.id=a.id;this.Qb=a.Qb}$h.prototype.i=function(){return this.id};function Jh(a){return new $h({id:n.required("id",a),Qb:pa.optional("created",a)||0})}function Nd(a){this.object=a.object;this.limit=a.limit;this.N=a.N}Nd.prototype.Db=function(){return this.limit};Nd.prototype.ia=function(){return this.N};function Gd(a){this.eb=a.eb||[];this.N=a.N}Gd.prototype.Ii=function(){return this.eb};
Gd.prototype.ia=function(){return this.N};function Hh(a){return new Gd({eb:qa(Oh,"comments",a),N:n.optional("continuation",a)})}function Sd(a){this.object=a.object;this.id=a.id}Sd.prototype.i=function(){return this.id};function ai(){}function Kh(){return new ai}function ge(a){this.o=a.o;this.limit=a.limit;this.N=a.N}ge.prototype.X=function(){return this.o};ge.prototype.Db=function(){return this.limit};ge.prototype.ia=function(){return this.N};
function bi(a){this.ak=a.ak||[];this.read=a.read;this.N=a.N}bi.prototype.ia=function(){return this.N};function Lh(a){var b=qa(Qh,"stories",a),c;c=pa.optional("read",a);return new bi({ak:b,read:c,N:n.optional("continuation",a)})}function de(a){this.o=a.o;this.read=a.read}de.prototype.X=function(){return this.o};function ce(a){return{user:u.optional("user",a.o),read:va("read",a.read)}}function ci(){}function ee(){return new ci};function di(a){this.u=a}di.prototype.vd=function(a,b){var c=b.filter,e=b.Db(),f=b.ia(),g=b.decorations;a="/vfolders/"+a+b.Z()+"?format\x3d"+encodeURIComponent(b.format)+(c?"\x26filter\x3d"+encodeURIComponent(c):"")+(e?"\x26limit\x3d"+encodeURIComponent(String(e)):"")+(f?"\x26continuation\x3d"+encodeURIComponent(f):"")+(g?"\x26decorations\x3d"+encodeURIComponent(g.join(",")):"");return B(this.u,a).get(0).then(ei)};var fi={iq:"/designs/all",jq:"/designs/challenges",kq:"/designs/layouts",lq:"/designs/portfolio",mq:"/designs/sharedwith",nq:"/designs/trash",qq:"/media/portfolio",sq:"/media/uploads",rq:"/media/rf_purchases",oq:"/designs/layouttemplates"};function gi(){this.width=this.height=0;this.url="";this.version=0}gi.prototype.hb=function(){return this.width};gi.prototype.Ha=function(){return this.height};gi.prototype.getVersion=function(){return this.version};gi.prototype.fa=function(){return this.url};
function ke(a){return a?$.extend(new gi,a):null}function hi(){this.kind=ii;this.type=le;this.name=this.id="";this.timestamp=this.version=0;this.trashedTimestamp=null;this.thumbnail=new gi;this.tags=[];this.folders=this.owner=this.marketplaceStatus=null}var ii="SIMPLE",he="SOCIAL",le="DESIGN";d=hi.prototype;d.rb=function(){return this.type};d.i=function(){return this.id};d.getName=function(){return this.name};d.getVersion=function(){return this.version};d.Ia=function(){return this.thumbnail};
d.Oi=function(){return this.tags};d.ya=function(){return this.folders};function ji(){}ji.prototype.X=function(){return this.user};ji.prototype.O=function(){return this.brand};function ki(){}ki.prototype=new hi;function li(){this.publik=this.brandPublik=!1;this.myRole=Nc;this.commentCount=this.likerCount=this.remixCount=0;this.likedByMe=!1;this.ownerUser=this.latestComment=null}li.prototype=new hi;li.prototype.hl=function(){return this.likerCount};li.prototype.mf=function(){return this.commentCount};
li.prototype.gl=function(){return this.likedByMe};li.prototype.Cg=function(){return this.latestComment};function je(a){if(!a)return null;a=$.extend(new li,a);a.kind=he;a.latestComment&&(a.latestComment=Oh(a.latestComment));a.owner&&(a.owner=Object.freeze(y(ji,a.owner)));a.thumbnail&&(a.thumbnail=ke(a.thumbnail));a.ownerUser=O(a.ownerUser);return a}function mi(){}d=mi.prototype;d.ec=function(a){this.brand=a;return this};d.O=function(){return this.brand||null};d.Yf=function(a){this.user=a;return this};
d.X=function(){return this.user||null};d.Bc=function(a){this.folder=a;return this};d.Z=function(){return this.folder};d.Yc=function(a){this.continuation=a;return this};d.ia=function(){return this.continuation||null};d.Cc=function(a){this.limit=a;return this};d.Db=function(){return this.limit};function ni(){this.items=[];this.folders=this.continuation=null}ni.prototype.qd=function(){return this.items};ni.prototype.ia=function(){return this.continuation};ni.prototype.ya=function(){return this.folders};
function ei(a){function b(a){a.kind===ii?a?(a=$.extend(new ki,a),a.kind=ii,a.owner&&(a.owner=Object.freeze(y(ji,a.owner))),a.thumbnail&&(a.thumbnail=ke(a.thumbnail))):a=null:a=a.kind===he?je(a):a;return a}if(!a)return null;a=$.extend(new ni,a);a.items&&(a.items=a.items.map(b));a.folders&&(a.folders=a.folders.map(L));return a};function oi(a){this.window=a}function pi(a,b){$(a.window).on("popstate",b)}oi.prototype.fa=function(){return this.window.location.href};oi.prototype.pushState=function(a,b){this.window.history.pushState(a,"",b)};oi.prototype.replaceState=function(a,b){this.window.history.replaceState(a,"",b)};function qi(a){this.u=a}d=qi.prototype;d.rf=function(a){throw ri(a[0].errorKey);};d.uf=function(a){return"CreditCardInvalid"===a[0].errorType};d.Jm=P.method(function(a,b){return A(this.u,"/billing/brands/"+encodeURIComponent(a)+"/account",{brand:a,stripeToken:b}).get(0).get("account").then(si).catch(this.uf,this.rf)});function ti(a,b,c){a.u.get("/billing/brands/"+encodeURIComponent(b)+"/account",function(a,b){200!=a?c(a,null):c(a,si(b))})}
function ui(a,b){return new P(function(a,e){ti(this,b,function(b,g){vi(b)?a(g):e(b)})}.bind(a))}d.getSubscription=P.method(function(a){return B(this.u,a.brand?"/billing/brands/"+a.brand+"/subscription"+(null!=a.excludeStandard?"?excludeStandard\x3d"+(a.excludeStandard?"true":"false"):""):"/billing/subscriptions/"+a.id).get(0).then(wi)});d.bq=P.method(function(a){return A(this.u,a.brand?"/billing/brands/"+a.brand+"/subscription":"/billing/subscriptions/"+a.id,a).get(0).then(xi).catch(this.uf,this.rf)});
P.method(function(a){return A(this.u,"/billing/brands/"+a.brand+"/subscription?refund",a).get(0).then(yi).catch(this.uf,this.rf)});P.method(function(a){return A(this.u,"/billing/campaign",a).spread(zi)});P.method(function(a){return Ah(this.u,"/billing/campaign/"+encodeURIComponent(a)).spread()});P.method(function(a,b){return B(this.u,"/billing/coupon/"+encodeURIComponent(a)+"?validate\x3d"+encodeURIComponent(b)).spread(Ai)});
P.method(function(a){a="/billing/brands/"+encodeURIComponent(a.O())+"/invoices?"+a.ac();return B(this.u,a).get(0).then(Bi)});P.method(function(a){a="/billing/invoices/"+encodeURIComponent(a.i())+"?"+a.ac();return B(this.u,a).get(0).then(Ci)});P.method(function(a){a=a.O()?"/billing/brands/"+encodeURIComponent(a.O())+"/invoice?upcoming":"/billing/brand/invoice?upcoming";return B(this.u,a).get(0).then(Di).catch(this.uf,this.rf)});
P.method(function(a){var b=a.O()?"/billing/brands/"+encodeURIComponent(a.O())+"/invoice?create":"/billing/brand/invoice?create";return A(this.u,b,a).get(0).then(Ei)});P.method(function(a){return A(this.u,"/billing/invoices/"+encodeURIComponent(a.invoiceId)+"?pay",a).get(0).then(Fi).catch(this.uf,this.rf)});function Gi(){}Gi.prototype.i=function(){return this.id};Gi.prototype.X=function(){return this.user};Gi.prototype.Ni=function(){return this.status};function Hi(){}function Ii(a){a=y(Hi,a);a.licenses=a.licenses.map(Ji);a.credits=a.credits.map(Ki);a.subscriptionCharges=a.subscriptionCharges.map(Li);return Object.freeze(a)}function Mi(){}function Ki(a){a=y(Mi,a);a.date=new Date(a.date);return Object.freeze(a)}Mi.prototype.getDate=function(){return this.date};function Ni(){}
function Li(a){a=y(Ni,a);a.fromDate=new Date(a.fromDate);a.toDate=new Date(a.toDate);return Object.freeze(a)}Ni.prototype.getSubscription=function(){return this.subscription};Ni.prototype.Bg=function(){return this.description};function Oi(){}Oi.prototype.getSubscription=function(){return this.subscription};function wi(a){a=y(Oi,a);a.subscription=Pi(a.subscription);return a}function Qi(){}Qi.prototype.i=function(){return this.id};Qi.prototype.O=function(){return this.brand};Qi.prototype.Ni=function(){return this.status};
function Pi(a){a=y(Qi,a);a.plan=Object.freeze(y(Ri,a.plan));null!=a.trialEnd&&(a.trialEnd=new Date(a.trialEnd));null!=a.paidUntil&&(a.paidUntil=new Date(a.paidUntil));null!=a.periodEnd&&(a.periodEnd=new Date(a.periodEnd));return a}function Ri(){}Ri.prototype.i=function(){return this.id};Ri.prototype.sa=function(){return this.displayName};Ri.prototype.Pi=function(){return this.trialPeriodDays};function S(a){return a.billingInterval}Ri.prototype.rd=function(){return this.price};
function Si(a){return("YEARLY"===S(a)?1:12)*a.rd()}function Ti(){}Ti.prototype.ec=function(a){this.brand=a;return this};function Ui(){}Ui.prototype.getSubscription=function(){return this.subscription};function xi(a){a=y(Ui,a);a.subscription=Pi(a.subscription);return a}function Vi(){}function yi(a){return Object.freeze(y(Vi,a))}function Wi(){}Wi.prototype.i=function(){return this.id};Wi.prototype.sa=function(){return this.displayName};Wi.prototype.rb=function(){return this.type};Wi.prototype.Pi=function(){return this.trialPeriodDays};
function Xi(a){a=y(Wi,a);null!=a.created&&(a.created=new Date(a.created));null!=a.expiry&&(a.expiry=new Date(a.expiry));return a}function Yi(){}Yi.prototype.X=function(){return this.user};Yi.prototype.O=function(){return this.brand};function Zi(){}Zi.prototype.X=function(){return this.user};Zi.prototype.O=function(){return this.brand};function $i(){}function zi(a){a=y($i,a);a.campaign=Xi(a.campaign);return a}function aj(){}
function Ai(a){a=y(aj,a);var b=y(Zi,a.coupon);b.campaign=Xi(b.campaign);null!=b.dateRedeemed&&(b.dateRedeemed=new Date(b.dateRedeemed));if(null!=b.couponRedemption){var c=y(Yi,b.couponRedemption);c.dateRedeemed=new Date(c.dateRedeemed);b.couponRedemption=c}a.coupon=b;return a}function bj(a){a=void 0===a?{}:a;this.brand=a.G||"";this.last4=a.Wq||"";this.expMonth=a.Hq||null;this.expYear=a.Iq||null}bj.prototype.O=function(){return this.brand};function cj(){}
function dj(a){a=y(cj,a);a.card=Object.freeze(y(bj,a.card));a.addedDate&&(a.addedDate=new Date(a.addedDate));a.deletedDate&&(a.deletedDate=new Date(a.deletedDate));return Object.freeze(a)}cj.prototype.Ag=function(){return this.card};function ej(a){a=void 0===a?{}:a;this.brand=a.G||"";this.stripe=a.Nb||!1;this.stripeKey=a.er||null;this.credit=a.Eq||0;this.card=a.Ea||null;this.delinquent=a.Gq||!1;this.archivedCards=a.wq||[]}
function si(a){a=y(ej,a);a.archivedCards&&(a.archivedCards=a.archivedCards.map(dj));return Object.freeze(a)}ej.prototype.O=function(){return this.brand};ej.prototype.Ag=function(){if(this.card)return Object.freeze(y(bj,this.card))};function fj(a){a=void 0===a?{}:a;this.media=a.media||"";this.version=a.version||0;this.title=a.title||"";this.contributorName=a.Bq||null;this.thumbUrl=a.gr||null;this.price=a.ar||0;this.sessionCreationDate=a.cr||null;this.layout=a.td||""}fj.prototype.getVersion=function(){return this.version};
fj.prototype.uc=function(){return this.title};fj.prototype.rd=function(){return this.price};function Ji(a){return a?$.extend(new fj,a):null}function gj(){}function Bi(a){return Object.freeze(y(gj,a))}function hj(){}function Ci(a){a=y(hj,a);a.invoice=Object.freeze(y(Gi,a.invoice));a.details&&(a.details=Ii(a.details));return Object.freeze(a)}function ij(){}function Di(a){a=y(ij,a);a.invoice=Object.freeze(y(Gi,a.invoice));a.details=Ii(a.details);return Object.freeze(a)}function jj(){}
function Ei(a){a=y(jj,a);return Object.freeze(a)}function kj(){}function Fi(a){a=y(kj,a);return Object.freeze(a)}function lj(){fj.call(this)}lj.prototype=Object.create(fj.prototype);lj.prototype.constructor=lj;function mj(){}function nj(){var a=y(mj,window.clientInfo),b;b=y(oj,a.brandInfo);b.brand=Bg(b.brand);b.brandKit&&(b.brandKit=Object.freeze(y(Mg,b.brandKit)));b.subscription&&(b.subscription=Pi(b.subscription));b=Object.freeze(b);a.brandInfo=b;b=y(pj,a.user);b.avatar=Qg(b.avatar);b=Object.freeze(b);a.user=b;return Object.freeze(a)}function oj(){}oj.prototype.O=function(){return this.brand};oj.prototype.getSubscription=function(){return this.subscription||null};function pj(){}d=pj.prototype;d.i=function(){return this.id};
d.Mc=function(){return this.email};d.Da=function(){return this.username};d.sa=function(){return this.displayName};d.tc=function(){return this.roles};d.me=function(){return this.personalBrand};d.kl=function(){return this.uiInfo};d.Ki=function(){return this.creationDate};d.nf=function(){return this.locale};d.bm=function(){return O({id:this.i(),username:this.Da(),personalBrand:this.me(),displayName:this.sa(),avatar:this.avatar,roles:this.tc()})};function qj(a){this.analytics=a.analytics;this.$a=null;this.fi=a.fi;this.hi=a.hi;this.na=a.na||null;this.v=a.v;this.document=a.document;this.qg=null;this.Za=a.Za;this.Gb=a.Gb;this.view=a.view;this.listenTo(this.Gb,"route",this.Do);this.listenTo(this.view,{resize:this.pc,scroll:this.pc})}d=qj.prototype;
d.init=function(){var a;a=this.v;a={id:a.i(),username:a.Da(),vj:a.me(),displayName:a.sa(),zn:a.Lc("200"),Ql:a.tc()&&a.tc().join(", ")};this.na&&"0"==this.na.getItem("onboardingPhase")?this.Za.Ra.get(jc)?(a.Bd="appcues_homepage_onboarding_1",this.na.setItem("onboardingPhase","1")):this.Za.Ra.get(kc)?(a.Bd="appcues_homepage_onboarding_2",this.na.setItem("onboardingPhase","1")):this.Za.Ra.get(lc)?(a.Bd="appcues_homepage_onboarding_3",this.na.setItem("onboardingPhase","1")):this.Za.Ra.get(mc)&&(a.Bd=
"appcues_homepage_onboarding_4",this.na.setItem("onboardingPhase","1")):this.na&&"2"==this.na.getItem("onboardingPhase")&&(this.na.removeItem("onboardingPhase"),a.Bd="complete");this.analytics.identify(this.v.i(),a);a.Bd?this.analytics.track("homepage_visit_logged_in",{onboarding:a.Bd}):this.analytics.track("homepage_visit_logged_in")};d.remove=function(){this.stopListening()};d.pc=function(){this.$a&&this.$a.pc()};
d.Do=function(a){a===T?this.analytics.track("your_designs_visit"):a===rj?this.analytics.track("shared_designs_visit"):a===sj?this.analytics.track("team_stream_visit"):a===tj?this.analytics.track("trash_visit"):a===uj?this.analytics.track("design_stream_visit"):vj(a)&&this.analytics.track("design_folder_visit");wj(this,a)};
function wj(a,b){a.$a&&(a.stopListening(a.$a),a.$a.remove());if(b===xj)a=a.view,a.fc&&a.fc.remove();else{var c=yj(a.view,b);a.$a=a.hi(b,c);a.document.title=c.uc();a.$a.init();a.$a.pc();a.listenTo(a.$a,"import",a.Ep);a.qg&&a.qg.stop();a.$a.bk&&(a.qg=a.fi(a.$a.R,a.$a),a.qg.start())}}d.Ep=function(a){0<a.length&&this.$a.R===T&&wj(this,T)};d.listenTo=Backbone.Events.listenTo;d.stopListening=Backbone.Events.stopListening;d.trigger=Backbone.Events.trigger;d.off=Backbone.Events.off;d.on=Backbone.Events.on;function zj(a){var b=this;Backbone.View.call(this);this.Ic=a.Ic;this.vb=a.vb;this.ua=a.ua;this.ii=a.ii;this.C=a.C;this.window=a.window;this.fc=null;this.El=_.debounce(function(){return b.De()},200);this.listenTo(this.ua,"scroll",function(){return b.trigger("scroll")});this.listenTo(this.Ic,{expanded:function(){return a.tj.addClass("docTypeSelectorExpanded")},collapsing:function(){return a.tj.removeClass("docTypeSelectorExpanded")},hiding:function(){return a.tj.removeClass("docTypeSelectorExpanded")}})}
k(zj,Backbone.View);zj.prototype.init=function(){$(this.window).on("resize",this.El)};zj.prototype.remove=function(){$(this.window).off("resize",this.El);Backbone.View.prototype.remove.call(this)};function yj(a,b){if(a.fc){var c=a.fc;a.C.setTimeout(function(){return c.remove()},500)}a.fc=a.ii(b);a.fc.Ml().appendTo(Aj(a.vb).empty());return a.fc}zj.prototype.De=function(){this.fc&&this.fc.wc();this.trigger("resize")};function Bj(a){this.vb=a.vb;this.l=a.l;this.Ic=a.Ic;this.Ib=a.Ib;this.yb=a.yb;this.Tc=a.Tc;this.ni=a.ni;this.$b=a.$b;this.tabIndex=null;this.Rd=-1;this.R=null;this.window=a.window;this.history=a.history;this.Fk="/";this.listenTo(this.l,{"fetch:success":this.Bh,"create:success":this.Bh,"change:success":this.Bh,"delete:success":this.no});this.listenTo(this.Ic,"clickCollapse",this.pn)}d=Bj.prototype;
d.init=function(){var a=this;$(this.window).on("click.homeRouter",function(b){if(b.target.getAttribute("href")){var c=b.target.getAttribute("href"),e=Cj(c);e&&(b.preventDefault(),e!==a.R&&(a.history.pushState(null,"",c),a.route(e,c)))}});$(this.window).on("popstate.homeRouter",function(){return Dj(a)});Dj(this)};d.remove=function(){$(this.window).off("click.homeRouter");$(this.window).off("popstate.homeRouter");this.stopListening()};
function Dj(a){var b=a.window.location.hash;if(vj(b.substr(1)))a.window.history.replaceState(null,"","/");else{var c={"#your-designs":"/","#shared-with-you":"/shared-with-you","#team-stream":"/team-stream","#design-stream":"/design-stream","#create-a-design":"/create-a-design","#trashed-designs":"/trash"};c[b]&&a.window.history.replaceState(null,"",c[b])}b=a.window.location.pathname;(c=Cj(b))&&a.route(c,b)}
d.route=function(a,b){if(!this.R||a!==this.R){var c=Ej(this,b,a);if(-1===c.Eb)Fj(this,xj,this.R),this.Ib.select(-1),this.yb&&Ff(this.yb),this.Tc.select(-1),Gj(this.$b,!0),this.tabIndex=null,this.R=xj,this.trigger("route",this.R);else{var e=c.ai(Hj(this.Ib).length,this.l?this.l.ya().length:0),f=this.tabIndex?this.tabIndex.ai(Hj(this.Ib).length,this.l?this.l.ya().length:0):Number.MAX_VALUE;e<f?(0===this.vb.Fc&&Ij(this.vb),this.vb.rh(0)):(1===this.vb.Fc&&Ij(this.vb),this.vb.rh(1));0===c.Eb?(this.Ib.select(c.ad),
this.yb&&Ff(this.yb),this.Tc.select(-1)):1===c.Eb?(this.Ib.select(-1),this.yb.select(this.l.ya()[c.ad]),this.Tc.select(-1)):2===c.Eb?(this.Ib.select(-1),this.yb&&Ff(this.yb),this.Tc.select(c.ad)):(this.Ib.select(-1),this.yb&&Ff(this.yb),this.Tc.select(-1));this.ni.toggleClass("on",-2===c.Eb);Gj(this.$b,!1).update(e);Fj(this,a,this.R);this.tabIndex=c;this.Rd=e;this.R=a;this.Fk=b;this.trigger("route",a,e,f)}}};
function Fj(a,b,c){var e=c===T,f=c===xj,g=b===T;b=b===xj;var h=a.Ic;null!==c||g||b?e&&b?bf(h):e&&!b?h.hide():f&&g?Ve(h):f&&!g?h.hide().then(function(){h.$el.removeClass("expanded");h.Pb.$el.children(".docTypeItemDisappearing").addClass("doNotTransition").removeClass("docTypeItemDisappearing").forceLayout().removeClass("doNotTransition");h.mh(!1)}):b?Ye(h):g&&h.show():h.$el.hasClass("hidden")||h.$el.addClass("hidden doNotTransition").height(0).forceLayout().removeClass("doNotTransition")}
d.Bh=function(){this.R&&(this.tabIndex=Ej(this,this.window.location.pathname,this.R),this.Rd=this.tabIndex.ai(Hj(this.Ib).length,this.l?this.l.ya().length:0),this.$b.update(this.Rd,!1))};
d.no=function(a){ma(!!this.R,"tabId must be present before handling folder deletes");if(1===this.tabIndex.Eb&&this.R.substr(7)===a.i()){if(0<this.tabIndex.ad)a=this.l.ya()[this.tabIndex.ad-1];else if(1<=this.l.ya().length)a=this.l.ya()[0];else return this.history.pushState(null,"","/"),this.route(T,"/");a="/folder/"+a.i();this.history.pushState(null,"",a);this.route("folder-"+a.substr(8),a)}else this.Bh()};
function Ej(a,b,c){if(c===xj)return new Jj(-1,0);if(c===uj)return new Jj(-2,0);var e=Kj(a.Ib,b);if(-1!==e)return new Jj(0,e);if(a.l&&(e=Lj(a,c),-1!==e))return new Jj(1,e);a=Kj(a.Tc,b);if(-1!==a)return new Jj(2,a);throw Error("Cannot calculate tab index for",b,c);}function Lj(a,b){return a.l.ya().map(function(a){return a.i()}).indexOf(b.substr(7))}
function Cj(a){return"/"===a?T:"/shared-with-you"===a?rj:"/team-stream"===a?sj:"/trash"===a?tj:"/folder/"===a.substr(0,8)?"folder-"+a.substr(8):"/design-stream"===a?uj:"/create-a-design"===a?xj:null}d.pn=function(){this.history.pushState(null,"",this.Fk);Dj(this)};Object.defineProperties(Bj.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return this.R}}});function Jj(a,b){this.Eb=a;this.ad=b}
Jj.prototype.ai=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];if(0>this.Eb)return-1;if(0===this.Eb)return this.ad;if(b.length<this.Eb)throw Error("Insufficient number of group child counts passed, required: "+this.Eb);return b.slice(0,this.Eb).reduce(function(a,b){return a+b},0)+this.ad};d=Bj.prototype;d.listenTo=Backbone.Events.listenTo;d.stopListening=Backbone.Events.stopListening;d.trigger=Backbone.Events.trigger;d.off=Backbone.Events.off;d.on=Backbone.Events.on;function vj(a){return"folder-"===a.substr(0,7)};function Mj(){}Mj=Backbone.View.extend({className:"sidebarViewportContainer"});d=Mj.prototype;d.initialize=function(a){this.Mj=new Nj(this.$(".sidebarViewport"),!0);this.listenTo(this.Mj,{"change:scrollability":this.On,scroll:this.Fo});this.Gb=a.Gb;this.listenTo(this.Gb,"route",this.Dl);this.Gb.Rd&&this.Dl(0,this.Gb.Rd,-1);this.$b=a.$b||null;this.Mj.render()};d.remove=function(){this.Mj.remove();Backbone.View.prototype.remove.call(this)};
d.On=function(a,b){this.$el.toggleClass("sidebarScrollable",b);Oj(this)};
d.Fo=function(){var a=this.$(".sidebarViewport").find("li.on,li.selected:not(.hidden)"),b=this.Gb?this.Gb.Rd:null;if(0<a.length){var c=$(document.body).scrollTop()||$(document).scrollTop(),e=this.$(".sidebarViewport"),f=e.offset().top,c=e.scrollTop()-c,g=e.height(),h=a.offset().top-e.offset().top,e=a.height();a.hasClass("sidebarItemSticky")?(h=parseInt(a.data("nonStickyItemOffsetTop"),10),h=isNaN(h)?a.get(0).offsetTop:h,(a.hasClass("sidebarItemStickyTop")?c+f<h:a.hasClass("sidebarItemStickyBottom")&&
c+f+g>=h+e)&&Pj(this,a)):0>=h?(c=$(document.body).scrollTop()||$(document).scrollTop(),a.data("nonStickyItemOffsetTop",a.offset().top+this.$(".sidebarViewport").scrollTop()-c).addClass("sidebarItemSticky sidebarItemStickyTop").css("top",f-c),a.parent("menu").removeClass("sidebarMenuStickyBottom").addClass("sidebarMenuStickyTop"),this.$el.addClass("sidebarItemListSticky sidebarItemListStickyTop")):h+e>g&&(f=$(window).height()-(f+g),c=$(document.body).scrollTop()||$(document).scrollTop(),a.data("nonStickyItemOffsetTop",
a.offset().top+this.$(".sidebarViewport").scrollTop()-c).addClass("sidebarItemSticky sidebarItemStickyBottom").css("bottom",f+c),a.parent("menu").removeClass("sidebarMenuStickyTop").addClass("sidebarMenuStickyBottom"),this.$el.addClass("sidebarItemListSticky sidebarItemListStickyBottom"));this.$b&&null!==b&&this.$b.update(b,!1)}Oj(this)};
function Oj(a){var b=a.$(".sidebarViewport"),c=parseInt(b.scrollTop(),10),e=b.height();a.$el.toggleClass("sidebarScrollableTop",0<c).toggleClass("sidebarScrollableBottom",c+e<b.prop("scrollHeight"))}
d.Dl=function(a,b,c){a=this.$(".sidebarMenu").children("li:not(.noTab)");var e=a.eq(c);a=a.eq(b);-1!==c&&Pj(this,e);if(-1!==b&&0!==a.length&&!a.hasClass("sidebarItemSticky")){b=this.$(".sidebarViewport");c=parseInt(b.scrollTop(),10);var e=b.height(),f=a.offset().top-b.offset().top;a=a.height();0>=f?b.scrollTop(c+f):f+a>e&&b.scrollTop(c+f+a-e)}};
function Pj(a,b){a.$el.removeClass("sidebarItemListSticky sidebarItemListStickyTop sidebarItemListStickyBottom");a.$(".sidebarMenuStickyTop").removeClass("sidebarMenuStickyTop");a.$(".sidebarMenuStickyBottom").removeClass("sidebarMenuStickyBottom");b.removeData("nonStickyItemOffsetTop").removeClass("sidebarItemSticky sidebarItemStickyTop sidebarItemStickyBottom").css("top","").css("bottom","")};function Qj(){this.xhr=null}Qj.prototype.cancel=function(){this.xhr&&(this.xhr.abort(),this.xhr=null)};Qj.prototype.finish=function(){this.xhr=null};function Rj(a){this.Uh=a&&a.analyticsContext||null;this.cg=a&&a.authToken||null;this.eg=a&&a.authzToken||null;this.Yh=a&&a.brandRestriction||null;this.Zh=a&&a.buildName||null;this.$h=a&&a.buildSha||null;this.Ec=a&&a.csrfTokens||{};this.kh=a&&a.serverRoot||null;this.vp=!!this.kh;this.wp=this.kh?this.kh+"/_ajax":"/_ajax"}
Rj.prototype.copy=function(a){var b={analyticsContext:this.Uh,authToken:this.cg,authzToken:this.eg,brandRestriction:this.Yh,buildName:this.Zh,buildSha:this.$h,serverRoot:this.kh},c;for(c in a)b[c]=a[c];if(null===a.csrfTokens)c=null;else{c={};a=a.csrfTokens||{};for(var e in this.Ec)c[e]=this.Ec[e];for(e in a)c[e]=a[e]}b.csrfTokens=c;return new Rj(b)};function Sj(a){var b=a.indexOf("/",1);return-1==b?a:a.substring(0,b)}function vi(a){return 200<=a&&300>a}
Rj.prototype.get=function(a,b){var c=new Qj;this.send("GET",a,null,!0,null,c,null,b);return c};function B(a,b){var c;return(new P(function(e,f){c=a.get(b,function(a,b){vi(a)?e([b,a]):f([b,a])})})).cancellable().catch(P.CancellationError,function(a){c.cancel();throw a;})}Rj.prototype.post=function(a,b,c,e){var f=new Qj;Tj(this,"POST",a,b,!0,0,f,c,e);return f};
function A(a,b,c){var e;return(new P(function(f,g){e=a.post(b,c,null,function(a,b){vi(a)?f([b,a]):g([b,a])})})).cancellable().catch(P.CancellationError,function(a){e.cancel();throw a;})}function Uj(a,b,c){var e=new Qj;Tj(a,"DELETE",b,null,!0,0,e,null,c);return e}function Ah(a,b){var c;return(new P(function(e,f){c=Uj(a,b,function(a,b){vi(a)?e([b,a]):f([b,a])})})).cancellable().catch(P.CancellationError,function(a){c.cancel();throw a;})}
function Tj(a,b,c,e,f,g,h,l,m){var q=Sj(c);if(q in a.Ec){var p=a.Ec[q];a.send(b,c,e,f,p,h,l,function(r,v){418==r&&1>g?(a.Ec[q]==p&&delete a.Ec[q],Tj(a,b,c,e,f,g+1,h,l,m)):(m&&m(r,v),h.finish())})}else a.send("GET","/csrf"+q,null,f,null,h,null,function(p,v){200==p?(q in a.Ec||(a.Ec[q]=String(v)),Tj(a,b,c,e,f,g,h,l,m)):(m(p,null),h.finish())})}
Rj.prototype.send=function(a,b,c,e,f,g,h,l){function m(){4==p.readyState&&q()}function q(){var a,b,c;try{a=p.status;var e,f;try{e=p.getResponseHeader("X-Canva-Auth")}catch(h){}try{f=p.getResponseHeader("X-Canva-Authz")}catch(h){}e&&(r.cg="!"!=e?e:null);f&&(r.eg="!"!=f?f:null);b=p.responseText}catch(h){if(h.message&&h.message.match(/c00c023f/))a=0,b="";else throw g.finish(),h;}b=b&&b.trim?b.trim():"";e=b.substring(0,20);if(0<e.length){if("'\"])}while(1);\x3c/x\x3e//"!=e){l(500,null);g.finish();return}b=
b.substring(20);try{c=JSON.parse(b)}catch(h){l(500,null);g.finish();return}}else c=null;l(a,c);g.finish()}b=this.wp+b;var p=g.xhr=new XMLHttpRequest,r=this;p.open(a,b,e);this.vp&&(p.withCredentials=!0);"GET"!=a&&f&&p.setRequestHeader("X-Csrf-Token",f);this.Uh&&p.setRequestHeader("X-Canva-Analytics",this.Uh);this.cg&&p.setRequestHeader("X-Canva-Auth",this.cg);this.eg&&p.setRequestHeader("X-Canva-Authz",this.eg);this.Yh&&p.setRequestHeader("X-Canva-Brand",this.Yh);this.Zh&&p.setRequestHeader("X-Canva-Build-Name",
this.Zh);this.$h&&p.setRequestHeader("X-Canva-Build-Sha",this.$h);null===c?a=null:"object"==typeof c&&"undefined"!==typeof Blob&&c instanceof Blob?(p.setRequestHeader("Content-Type",c.type),h&&p.upload.addEventListener("progress",h,!1),a=c):(p.setRequestHeader("Content-Type","application/json;charset\x3dUTF-8"),a=JSON.stringify(c));e?(p.onreadystatechange=m,p.send(a)):(p.send(a),q())};function pd(){}pd=Backbone.View.extend({className:"your comment form",tagName:"li"});d=pd.prototype;d.initialize=function(a){this.template=a&&a.template||pd.template;this.H=a.H;this.Ee=a&&a.Ee||this.H.format("commentFormWriteAComment");this.ce=a&&a.ce||pd.nm;this.Nl=!1};d.clear=function(){Vj(this);this.$("textarea").val("").trigger("autosize.resize");return this};d.disable=function(){this.$("textarea").blur().prop("disabled",!0);return this};
d.enable=function(){this.$("textarea").prop("disabled",!1);return this};d.events=function(){return{"keydown textarea":this.kb}};d.kb=function(a){var b=$(a.target).val(),c=a.altKey||a.shiftKey;13!==a.which||c||(a.preventDefault(),b&&this.trigger("submit",b))};d.render=function(){if(!this.Nl){this.$el.html(this.template({placeholder:this.Ee}));var a=this.$("textarea");a.attr("placeholder",this.Ee);a.one("focus",function(){$(this).autosize({append:""})});this.Nl=!0}return this};
function sd(a,b){a.render();a.$(".avatar").prop("src",b.Lc(50))}function Wj(a,b){var c=a.$("textarea");a.render();c.attr("placeholder",b);c.autosize({append:""});Xb(function(){c.css("min-height",c.css("height"))})}d.qh=function(a){this.render();Vj(this);this.$("textarea").after(this.ce({errorMessage:a}));return this};function Vj(a){a.$(".error").remove()}pd.template=_.template('\x3cimg class\x3d"avatar" src\x3d""\x3e\x3ctextarea class\x3d"textInput" placeholder\x3d"\x3c%- placeholder %\x3e" maxlength\x3d"1024"\x3e\x3c/textarea\x3e');
pd.nm=_.template('\x3cdiv class\x3d"error"\x3e\x3c%- errorMessage %\x3e\x3c/div\x3e');function Xj(){}Xj=Backbone.Model.extend();Xj.prototype.gb=function(){return this.get("documentProfile")};function Yj(a,b){Zj(a);a.set({documentProfile:b,pageCount:b.document.Nc()},{silent:!0})}Xj.prototype.Nc=function(){return this.get("pageCount")};function ak(a){return a.get("pageWidth")}function bk(a){return a.get("pageHeight")}
function ck(a){Zj(a);Ic(a.gb().document).forEach(function(c,e){if(a.re&&a.re[c])a.ld[e]="loaded",a.trigger("previewImage:loaded",e);else{var f=new XMLHttpRequest;a.uj.push(f);f.open("GET",c,!0);f.responseType="blob";f.onload=function(){a.ld[e]="loaded";a.re||(a.re={});try{a.re[c]=b?b.createObjectURL(f.response):c}catch(g){a.re[c]=c}a.trigger("previewImage:loaded",e)};f.onprogress=function(b){b.lengthComputable&&a.trigger("previewImage:progress",a,e,parseInt(b.loaded/b.total*100,10))};f.onloadstart=
function(){a.ld[e]="downloading";a.trigger("previewImage:progress",a,e,0)};f.onloadend=function(){a.trigger("previewImage:progress",a,e,100)};f.onreadystatechange=function(){4===f.readyState&&200!==f.status&&(a.ld[e]="error",a.trigger("previewImage:error",e,f.status))};f.send()}});var b=window.URL||window.webkitURL}function Zj(a){a.uj&&a.uj.forEach(function(a){a.abort()});a.uj=[];a.ld={}}
function dk(a,b){return a.ld&&a.ld[b]?a.ld[b]:null!==a.gb()&&null!==Ic(a.gb().document)?"downloading":"loading"};function ek(){}ek=Backbone.View.extend({className:"lightboxPagination"});d=ek.prototype;d.events=function(){return{"click .lightboxPaginationNext":this.Go,"click .lightboxPaginationPage":this.Ho,"click .lightboxPaginationPrevious":this.Io}};d.initialize=function(a){this.da=a.da;this.Va=this.Rb=0};
d.render=function(a){this.$el.html(this.template({currentPageIndex:a.Rb,pageCount:a.Va,page:this.da.page(),next:this.da.next(),previous:this.da.previous()}));this.$el.toggleClass("hidden",2>a.Va);this.Va=a.Va;this.Mb(a.Rb);return this};
d.Mb=function(a){a+=this.Va;a%=this.Va;this.$el.toggleClass("lightboxPaginationEllipsisEnd",8<this.Va&&a<this.Va-4);this.$el.toggleClass("lightboxPaginationAnimated",fk(this,this.Rb)&&fk(this,a));this.$el.toggleClass("lightboxPaginationEllipsisStart",8<this.Va&&3<a);this.Rb=a;this.$(".lightboxPaginationPage").removeClass("active").eq(a).addClass("active");var b=Math.max(0,Math.min(a-3,this.Va-8));this.$(".lightboxPaginationSlidingPages \x3e div").css({transform:"translate3d(-"+30*b+"px, 0, 0)"});
this.trigger("pageSelect",a)};function fk(a,b){return 8<a.Va&&b<a.Va-4&&8<a.Va&&3<b}d.Go=function(a){a.preventDefault();this.Mb(this.Rb+1)};d.Ho=function(a){a.preventDefault();this.Mb(this.$(".lightboxPaginationPage").index(a.currentTarget))};d.Io=function(a){a.preventDefault();this.Mb(this.Rb-1)};d.template=_.template('\x3c% if (pageCount \x3e 1) { %\x3e\x3ca class\x3d"lightboxPaginationPrevious" href\x3d"#"\x3e\x3c%- previous %\x3e\x3c/a\x3e\x3cspan\x3e\x3c%- page %\x3e\x3c/span\x3e\x3ca class\x3d"lightboxPaginationFirstPage lightboxPaginationPage" href\x3d"#"\x3e1\x3c/a\x3e\x3cdiv class\x3d"lightboxPaginationSlidingPages"\x3e\x3cdiv\x3e\x3c% _.range(2, pageCount).forEach(function(page) { %\x3e\x3ca class\x3d"lightboxPaginationPage" href\x3d"#"\x3e\x3c%- page %\x3e\x3c/a\x3e\x3c% }); %\x3e\x3c/div\x3e\x3c/div\x3e\x3ca class\x3d"lightboxPaginationLastPage lightboxPaginationPage" href\x3d"#"\x3e\x3c%- pageCount %\x3e\x3c/a\x3e\x3ca class\x3d"lightboxPaginationNext" href\x3d"#"\x3e\x3c%- next %\x3e\x3c/a\x3e\x3c% } %\x3e');function gk(){}gk=Backbone.View.extend({className:"lightboxViewPreview"});gk.pm=200;gk.$k=function(a){a=Math.min(a,99.9999);var b=a/100*360*(Math.PI/180);return"M52.5,27.5 A25,25 0 "+(50<a?1:0)+",1 "+(27.5+25*Math.cos(b))+","+(27.5+25*Math.sin(b))};d=gk.prototype;
d.initialize=function(a){this.listenTo(this.model,"change:documentProfile",this.reset);this.listenTo(this.model,"change",this.render);this.listenTo(this.model,"previewImage:loaded",this.hh);this.listenTo(this.model,"previewImage:progress",_.throttle(this.$o,200));this.listenTo(this.model,"previewImage:error",this.hh);this.Kg=[];this.Hg=a.da};
d.render=function(){this.model.Nc()!==hk(this).length&&hk(this).remove();var a=this.model.Nc();if(this.model.gb())for(var b=0;b<a;b++)this.hh(b);ik(this);a=this.model.get("currentPageIndex");hk(this).removeClass("active").eq(a).addClass("active");a*=ak(this.model);this.$el.css("transform","translate(-"+a+"px, 0)");return this};function hk(a){return a.$el.find(".lightboxViewPage")}
function jk(a){kk(a);a.Kg.push(window.setTimeout(function(){hk(a).removeClass("preload")},500));a.Kg.push(window.setTimeout(function(){for(var b,c=a.model.Nc(),e=0;e<c;e++)"loading"===dk(a.model,e)&&(b=hk(a).eq(e),b.addClass("loadingLong"))},2E4))}
d.hh=function(a){function b(){q.hasClass("hidden")&&m.removeClass("hidden");e.model.get("currentPageIndex")===a&&ik(e)}function c(){m.addClass("hidden");q.removeClass("hidden");ik(e)}var e=this,f=hk(this).eq(a);0===f.length&&(f=$(e.Ro({spinnerUrl:Ca?"https://static.canva.com/static/images/lightbox_spinner@2x.png":"https://static.canva.com/static/images/lightbox_spinner.png",spinnerSize:50,makingPreview:e.Hg.Bn(),makingPreviewLong:e.Hg.Cn(),previewDownloading:e.Hg.Yo(),previewError:e.Hg.Zo()})),f.addClass("preload"),f.appendTo(this.$el));var g=
Jc(this.model.gb().document),h=Hc(this.model.gb().document,a),l=dk(this.model,a),m=f.find("img.thumbnail"),q=f.find("img.preview"),p=m.hasClass("empty"),r=q.hasClass("empty");f.removeClass("loaded loading downloading error");f.addClass(l);"loading"===l?f.find(".downloading .hidden").removeClass("hidden"):"loaded"===l&&r?q.one("load",c).removeClass("empty").prop("src",this.model.re[h]):"loaded"!==l&&p&&m.one("load",b).removeClass("empty").prop("src",g)};
d.Ro=_.template(['\x3cdiv class\x3d"lightboxViewPage"\x3e\x3cimg class\x3d"page thumbnail hidden empty"\x3e\x3cimg class\x3d"page preview hidden empty"\x3e\x3cdiv class\x3d"loading"\x3e\x3cimg class\x3d"spinner" src\x3d"\x3c%- spinnerUrl %\x3e" width\x3d"\x3c%- spinnerSize %\x3e" height\x3d"\x3c%- spinnerSize %\x3e"\x3e\x3cp class\x3d"loadingShort"\x3e\x3c%- makingPreview %\x3e\x3c/p\x3e\x3cp class\x3d"loadingLong"\x3e\x3c%- makingPreviewLong %\x3e\x3c/p\x3e\x3c/div\x3e\x3cdiv class\x3d"downloading"\x3e\x3csvg class\x3d"progress" data-progress\x3d"0"\x3e\x3ccircle cx\x3d"\x3c%- (spinnerSize + 5)/2 %\x3e" cy\x3d"\x3c%- (spinnerSize + 5)/2 %\x3e" r\x3d"\x3c%- spinnerSize / 2 %\x3e" stroke\x3d"#333333" stroke-width\x3d"4" fill\x3d"transparent"/\x3e\x3cpath fill\x3d"none" stroke\x3d"#96c600" stroke-width\x3d"4"\x3e','\x3canimate id\x3d"downloading" attributeName\x3d"d" fill\x3d"freeze" begin \x3d "indefinite" dur \x3d "'+
gk.pm+'ms"/\x3e','\x3c/path\x3e\x3c/svg\x3e\x3cp class\x3d"hidden"\x3e\x3c%- previewDownloading %\x3e\x3c/p\x3e\x3c/div\x3e\x3cdiv class\x3d"error"\x3e\x3cp class\x3d"error"\x3e\x3c%- previewError %\x3e\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e'].join(""));function kk(a){a.Kg.forEach(function(a){window.clearTimeout(a)});a.Kg=[]}
function ik(a){var b=hk(a),c=ak(a.model),e=a.$el.height(),e=-Math.floor((bk(a.model)-e)/2);a.$el.css("width",c*b.length);b.css("width",c);b=b.children(".loading,.downloading,.error");b.css("width",ak(a.model)).css("height",bk(a.model)).css("top",e);b.each(function(){var b=$(this),c=b.parent(".lightboxViewPage").index();b.css("left",c*ak(a.model))});b.css("padding-top",Math.round((bk(a.model)-50)/2))}d.reset=function(){hk(this).remove();kk(this)};
d.$o=function(a,b,c){a=hk(this).eq(b).find("svg.progress");if(0!==a.length){for(var e=a.find("#downloading")[0],f=parseFloat(a.data("progress")),g=gk.$k(f),h=!!e.beginElement,l=Math.ceil(c-f),m=[],q,p=0;p<=l;p++)q=f+p/l*(c-f),m.push(gk.$k(q));a.find("path").attr("d",g);a.data("progress",c);e.setAttribute("values",m.join(";"));h?e.beginElement():(a.find("path").attr("d",_.last(m)),c=100);this.hh(b);100===c&&a.data("progress",0)}};function lk(a){this.analytics=a.analytics;this.Y=a.Y;this.history=a.history;this.j=a.j;this.$e=a.$e;this.Xa=function(){var a=$(".lightboxViewPreview"),a={documentProfile:null,currentPageIndex:-1,pageCount:a.children().length,pageWidth:a.data("width")||0,pageHeight:a.data("height")||0};return new Xj(a)}();this.K=new mk({Xa:this.Xa,j:this.j,analytics:this.analytics});this.visible=0!=this.K.$el.parent().length;this.Th=this.wg=!1;this.kg=null;this.zb=[];this.xb=-1;this.ra="";this.v=a.v;this.xa=a.xa;this.ih=
"/";this.lk={};var b=this;pi(this.history,function(a){var e=a.originalEvent.state||null;a=-1;e&&"LIGHTBOX"==e.type?(a=e.designStreamIndex,e=e.documentId):e=nk(b.history.window.location.pathname);e||(b.ih=b.history.fa());e==b.ra&&a==b.xb||a>=b.zb.length||(b.xb=a,b.ra=e,b.render(),b.visible=!!e)});this.K.mj=function(a){b.Qc(a)};this.K.Al=function(a){b.Sb(a)};this.K.Ff=function(){pk(b)};this.K.pj=function(a){a=nk(a);b.show(b.zb[b.xb]||new Cd,a)};this.K.hj=function(){b.hide()};this.visible&&(this.ra=
this.K.$el.data("designId")||"")}function qk(a){var b=a.zb[a.xb]||null;if(b&&b.contains(a.ra))return b.getItem(a.ra);a.xb=-1;var b=a.K.$el.data("extension")||null,c=a.K.$el.data("authorId")||"UNKNOWN_USER_ID",e=a.Y;a=a.ra;var f=Fd[c];f||(f=O({id:c}));return Vd(e,a,b,f)}d=lk.prototype;
d.show=function(a,b,c){this.visible||(this.ih=this.history.fa());this.ra=b;a.contains(this.ra)?this.xb=this.zb.indexOf(a):this.xb=-1;a={type:"LIGHTBOX",designStreamIndex:this.xb,documentId:b};c=c&&c.get(0)?c.get(0):null;this.history.pushState(a,G(b,"view"));this.K.Rh=c;this.render();this.visible=!0};
function rk(a,b){function c(a){Ic(a.getDocument())&&e.ra===f?(Yj(e.Xa,a),ck(e.Xa),sk(e.K)):void 0===e.lk[f]&&(a=window.setTimeout(function(){Od(b,!0).then(function(a){delete e.lk[f];c(a)})},1E4),e.lk[f]=a)}var e=a,f=b.Ba;a=b.gb();c(a)}d.hide=function(){this.visible&&(this.xb=-1,this.ra="",this.history.pushState({type:"LIGHTBOX",designStreamIndex:this.xb,documentId:this.ra},this.ih),this.render(),this.visible=!1)};
d.render=function(){if(this.ra){var a=qk(this),b=Fd[a.Ok],a=a.gb(),c=this.K;c.$(".lightboxViewDocumentInfo").empty();c.$(".discussion \x3e li:not(.your)").remove();var e=this.zb[this.xb]||null;if(e&&1<e.getLength()){var f=qk(this),c=G(e.previous(f).Ba,"view"),e=G(e.next(f).Ba,"view");tk(this.K,c,e)}else tk(this.K,"","");c=this.ih;this.K.$(".dialogViewClose").prop("href",c);c=this.K;a&&(e=c.Xa,Zj(e),e.set({documentProfile:a,currentPageIndex:0,pageCount:a.document.Nc()}),jk(c.Bj),sk(c),e=a.document,
f=e.draft,c.Aj=f&&f.imageSets.preview?f.imageSets.preview.width:0,e=e.draft,c.zj=e&&e.imageSets.preview?e.imageSets.preview.height:0,uk(c),c.Yb.Mb(0));c=this.K;a&&(a=a.document,e=c.$(".lightboxViewDocumentInfo"),e.html(c.Xm({authorHtml:c.Wm({user:{avatarUrl:b.Lc(50),displayName:b.sa(),profilePath:"/"+encodeURIComponent(b.Da())}}),document:{description:a.uc(),publishDate:Gc(a)}})),ud(e.find(".content"),mk.Mh));this.Hj();vk(this);this.visible||this.K.show();rk(this,qk(this))}else this.visible&&this.K.hide();
this.Th=this.wg=!1;this.kg=null};d.Hj=function(){if(this.v.za())this.Jj();else{var a=this.K,b=this.v,c;b?(c=a.$(".discussion"),sd(a.cb,b),a.cb.render(),a.cb.$el.prependTo(c)):a.cb.$el.detach()}wk(this.K)};d.Jj=function(){var a=this,b=qk(this);Od(b,!1).always(function(){var c=b.gb().rg,c=c&&c.jl()||"design",e=xk({loginRedirect:window.location.pathname});a.K.Jj(c,e)})};
function vk(a){var b=a.ra;Od(qk(a),!1).then(function(c){a.ra===b&&(a.K.Ij(c,a.v.za(),a.Y),yk(a.K,c,a.v,a.xa),zk(a.K,c,a.$e),a.analytics&&(c=a.analytics,c.$d=a.ra,c.Ab=null,c.track("design_open",{design:c.$d,source:"lightbox",template:c.Ab})))})}
d.Qc=function(a){if(this.v.za())throw Error("You can't post a comment unless you're logged in!");var b=this,c=this.ra,e=qk(this);e.Qc(a,this.v).then(function(a){var g=Ak(b,a,e);b.ra===c&&(Bk(b.K,a,!0,g),Ck(b.K),b.K.cb.enable(),b.K.cb.clear())},function(){var a=b.K;a.cb.qh(a.H.format("commentFormErrorPosting"));b.K.cb.enable()})};
d.Sb=function(a){if(this.v.za())throw Error("You can't delete a comment unless you're logged in!");var b=this,c=this.ra;qk(this).Sb(a).then(function(){b.ra===c&&b.K.Ej(a)},function(){b.ra===c&&b.K.Rc(a)})};
function pk(a){function b(a){e.wg=!1;e.ra===f&&(a.eb.forEach(function(a){var b=Ak(e,a,g);Bk(e.K,a,!1,b)}),Ck(e.K),e.kg=a.N||null,e.kg?wk(e.K):(e.Th=!0,0===g.mf()&&Dk(e.K)))}function c(){var a=e.K,b=a.$(".discussion"),a=$("\x3cli\x3e").text(a.H.format("commentFormErrorFetching")).addClass("comment error commentFetchingError"),c=b.children().first().filter(".comment.form");0<c.length?a.insertAfter(c):a.prependTo(b)}var e=a,f=a.ra,g=qk(a);a.Th||a.wg||(a.wg=!0,g.Ii(a.kg,20).then(b,c))}
function Ak(a,b,c){if(a.v.za())return!1;b=a.v.i()===b.Dc.i();c=a.v.i()===Fd[c.Ok].i();var e=-1<a.v.tc().indexOf(rd);a=-1<a.v.tc().indexOf(qd);return b||c||e||a}function nk(a){a=a.split("/");return"design"==a[1]&&3<=a.length?a[2]:""};function mk(){}mk=Backbone.View.extend({className:"dialogViewOverlay lightboxViewOverlay"});d=mk.prototype;
d.initialize=function(a){this.analytics=a.analytics;this.Fg=0;this.eb={};this.jb=Qa(a.j);this.H=Oa(a.j);this.da=jb(a.j);this.cb=new pd({H:this.H});this.listenTo(this.cb,"submit",this.Tn);this.ud=null;this.ob=!0;this.pj=this.Ff=this.mj=this.hj=this.Rh=null;this.Yb=new ek({da:this.da});this.listenTo(this.Yb,"pageSelect",function(a){this.Xa.set("currentPageIndex",a)});this.th=null;this.Xa=a.Xa;a=$(".lightboxViewOverlay");0===a.length?this.$el.html(this.template({next:this.da.next(),previous:this.da.previous()})):
this.setElement(a);this.Bj=new gk({model:this.Xa,el:this.$(".lightboxViewPreview"),da:this.da});this.zj=this.Aj=0;this.kb=this.kb.bind(this);this.Qi=this.Qi.bind(this);this.De=_.debounce(this.De,200).bind(this);this.qj=_.throttle(this.qj,200);0<a.length&&(this.Yb.render({Rb:0,Va:this.Xa.Nc()}),this.Yb.$el.insertAfter(this.Bj.$el.parent()),this.ob=!1,this.Aj=ak(this.Xa),this.zj=bk(this.Xa),uk(this),this.Yb.Mb(0),this.show(),this.ob=!0,ud(this.$(".content"),mk.Mh))};
d.events=function(){return{click:this.Qn,"click .lightboxViewNextDocument":this.Sn,"click .content \x3e .more":this.Rn,mousemove:this.vo,"scroll .lightboxViewSidebar":this.qj}};
d.show=function(){0==this.$el.parent().length&&this.$el.appendTo(document.body);var a=this.$(".lightboxView");if(this.ob){var b="scale(0.5)";if(this.Rh)var b=this.Rh.getBoundingClientRect(),c=b.width/ak(this.Xa),b="translate("+(b.left+b.width/2-(window.innerWidth-350*c)/2)+"px,"+(b.top+b.height/2-window.innerHeight/2)+"px) scale("+c+")";a.css("transform",b)}a.forceLayout();$(document.body).addClass("modalContentVisible modalContentBlurAndDarkenVisible lightboxVisible");$(document.activeElement).blur();
this.ob&&a.css("transform","scale(1)");Ek(this,7500);this.Vh()};d.hide=function(){$(document.body).removeClass("modalContentVisible modalContentBlurAndDarkenVisible lightboxVisible");this.$el.forceLayout();this.Fj()};function tk(a,b,c){var e=a.$(".lightboxViewNextDocument.previous");a=a.$(".lightboxViewNextDocument.next");b?e.prop("href",b).removeClass("hidden"):e.prop("href","#").addClass("hidden");c?a.prop("href",c).removeClass("hidden"):a.prop("href","#").addClass("hidden")}
function sk(a){a.Yb.render({Rb:0,Va:a.Xa.Nc()});a.Yb.$el.insertAfter(a.Bj.$el.parent())}function Ek(a,b){0<b&&(0!=a.Fg&&window.clearTimeout(a.Fg),a.Fg=window.setTimeout(a.Qi,b));a.$(".lightboxPagination").addClass("on")}d.Qi=function(){this.Fg=0;this.$(".lightboxPagination").removeClass("on")};d.Ij=function(a,b,c){this.ud&&(this.ud.off(),this.ud.remove());this.ud=new yd({Ba:a.document.i(),za:b,Ca:a.Ca,Na:a.Na,Y:c,jb:this.jb});a=this.$(".socialButtons");this.ud.render().$el.prependTo(a)};
function yk(a,b,c,e){function f(a,b){$("\x3ca\x3e").attr("href",a).attr("target","_blank").addClass("button buttonSmall button edit").text(b).appendTo(g)}var g=a.$(".socialButtons");b=b.document;var h=b.i();g.find(".edit").remove();!c.za()&&Kc(b,c.i(),e.i(),"EDITOR")&&f(G(h,"edit"),a.da.Ym());!c.za()&&Kc(b,c.i(),e.i(),"REMIXER")&&f(G(h,"remix"),a.da.format("lightboxRemix"));g.removeClass("preparing");window.setTimeout(function(){g.removeClass("noTransitions")},0)}
function zk(a,b,c){var e=a.$(".socialButtons").append('\x3cbutton class\x3d"button lightGreyButton buttonSmall moreActionsButton"\x3e\x26bull;\x26bull;\x26bull;\x3c/button\x3e').find(".moreActionsButton"),f=G(b.document.i(),"view");e.on("click",function(){var b=document.queryCommandSupported("copy");if(b)try{document.execCommand("copy")}catch(e){b=!1}bd(c(a.da,f,b),$(this))})}
d.Jj=function(a,b){a={Ab:a,Od:b,da:this.da,analytics:this.analytics};this.th?this.th.render(a):(this.th=(new Fk(a)).render(),this.th.$el.insertBefore(this.$el.find(".lightboxViewSidebar")))};function Dk(a){Wj(a.cb,a.H.format("commentFormWriteFirstComment"))}
function Bk(a,b,c,e){function f(){this.Al&&this.Al(b)}var g,h=a.$(".discussion"),l=b.Dc,l=$(a.Gm({authorHtml:a.Fm({user:{avatarUrl:l.Lc(50),displayName:l.sa()||l.Da(),profilePath:"/"+encodeURIComponent(l.Da())}}),comment:{content:b.content,id:b.id,timestamp:b.Qb},showDelete:e,deleteLabel:a.H.format("commentFormCommentDelete")}));c?(l.insertAfter(h.children().first()),a.$(".lightboxViewSidebar").prop("scrollTop",0)):(ud(l.find(".content"),mk.Mh),l.appendTo(h));e&&(g=new Qc({Vf:l.find(".buttonDelete"),
H:a.H}),g.render().$el.appendTo(l),g.on({cancel:g.hide.bind(g),confirm:f.bind(a),hide:l.removeClass.bind(l,"commentMenuVisible"),show:l.addClass.bind(l,"commentMenuVisible")}));Wj(a.cb,a.H.format("commentFormWriteAComment"));a.eb[b.id]={element:l,ha:g}}d.Ej=function(a){if(a=this.eb[a.id])a.ha&&(a.ha.off(),a.ha.remove()),a.element.remove()};d.Rc=function(a){(a=this.eb[a.id])&&a.ha&&a.ha.Rc()};
function Ck(a){a.$(".lightboxViewSidebar .autoformat.date").each(function(){var a=$(this).data("timestamp");$(this).text(moment(a).fromNow())})}function wk(a){var b=a.$(".lightboxViewSidebar");a.Ff&&b.prop("clientHeight")>=b.prop("scrollHeight")&&a.Ff()}
function uk(a){var b=a.Aj,c=a.zj;0===b||0===c?(b=600,c=800):430>b&&(c=Math.round(430*c/b),b=430);var e=window.innerWidth-68-368,f=window.innerHeight-68-68;if(b>e||c>f)e=Math.min(e/b,f/c),b=Math.floor(e*b),c=Math.floor(e*c);800>c+40&&c+40<f&&(c=Math.min(800,f));f=a.$(".lightboxView");a.ob||f.addClass("noTransitions");f.css("height",c);f.css("width",b);a.ob||(f.forceLayout(),f.removeClass("noTransitions"));a=a.Xa;a.set({pageWidth:b,pageHeight:c});a.trigger("change:pageSize",a,b,c)}
d.Tn=function(a){this.mj&&(Vj(this.cb),this.cb.disable(),this.mj(a))};d.kb=function(a){function b(a){Ek(c,2E3);c.Yb.Mb(a)}var c=this;if(!$(document.activeElement).is("textarea, .button")&&!a.shiftKey&&!a.altKey){if(a.ctrlKey||a.metaKey)switch(a.keyCode){case 37:b(0);break;case 39:b(-1);break;default:return}else switch(a.keyCode){case 36:case 38:b(0);break;case 33:case 37:b(this.Yb.Rb-1);break;case 34:case 39:b(this.Yb.Rb+1);break;case 35:case 40:b(-1);break;case 27:this.close();break;default:return}a.preventDefault()}};
d.De=function(){this.ob=!1;uk(this);this.ob=!0};d.Qn=function(a){var b=$(a.target);if(b.hasClass("lightboxViewOverlay")||b.hasClass("lightboxViewContainer")||b.hasClass("dialogViewClose"))this.close(),a.preventDefault()};d.Sn=function(a){var b=$(a.currentTarget);this.pj&&this.pj(b.prop("pathname"));a.preventDefault()};d.Rn=function(a){a.preventDefault();td($(a.currentTarget).parent())};d.vo=function(){Ek(this,2E3)};
d.qj=function(a){a=a.currentTarget;this.Ff&&a.scrollTop+150>=a.scrollHeight-a.clientHeight&&(this.Ff(),this.$(".commentFetchingError").remove())};d.close=function(){if(this.hj){var a=this.$(".dialogViewClose").prop("href");this.hj(a)}};d.Vh=function(){this.delegateEvents();$(document).on("keydown",this.kb);$(window).on("resize",this.De)};d.Fj=function(){this.undelegateEvents();$(document).off("keydown",this.kb);$(window).off("resize",this.De)};d.Fm=_.template('\x3ca class\x3d"author" href\x3d"\x3c%- user.profilePath %\x3e"\x3e\x3cimg class\x3d"avatar" src\x3d"\x3c%- user.avatarUrl %\x3e"\x3e\x3c/a\x3e\x3ca class\x3d"author displayName" href\x3d"\x3c%- user.profilePath %\x3e"\x3e\x3c%- user.displayName %\x3e\x3c/a\x3e');
d.Gm=_.template('\x3cli class\x3d"comment"\x3e\x3cdiv\x3e\x3c%\x3d authorHtml %\x3e\x3cspan class\x3d"autoformat date" data-timestamp\x3d"\x3c%- comment.timestamp %\x3e"\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"content"\x3e\x3c%- comment.content %\x3e\x3c/div\x3e\x3c% if (showDelete) { %\x3e\x3cdiv class\x3d"commentButtons"\x3e\x3cbutton class\x3d"button buttonTiny buttonIcon buttonDelete"\x3e\x3c%- deleteLabel %\x3e\x3c/button\x3e\x3c/div\x3e\x3c% } %\x3e\x3c/li\x3e');d.Wm=_.template('\x3ca class\x3d"author" href\x3d"\x3c%- user.profilePath %\x3e"\x3e\x3cimg class\x3d"avatar" src\x3d"\x3c%- user.avatarUrl %\x3e"\x3e\x3c/a\x3e\x3ca class\x3d"author displayName" href\x3d"\x3c%- user.profilePath %\x3e"\x3e\x3c%- user.displayName %\x3e\x3c/a\x3e');
d.Xm=_.template('\x3cdiv\x3e\x3c%\x3d authorHtml %\x3e\x3cbr\x3e\x3cspan class\x3d"autoformat date" data-timestamp\x3d"\x3c%- document.publishDate %\x3e"\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"content"\x3e\x3c%- document.description %\x3e\x3c/div\x3e\x3cdiv class\x3d"socialButtons preparing noTransitions"\x3e\x3c/div\x3e');d.template=_.template('\x3ca class\x3d"dialogViewClose" href\x3d"#"\x3eClose\x3c/a\x3e\x3ca href\x3d"#" class\x3d"lightboxViewNextDocument previous hidden"\x3e\x3c%- previous -\x3e\x3c/a\x3e\x3cdiv class\x3d"lightboxViewContainer"\x3e\x3cdiv class\x3d"lightboxView"\x3e\x3cdiv class\x3d"lightboxViewPreviewContainer"\x3e\x3cdiv class\x3d"lightboxViewPreview"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"lightboxViewSidebar"\x3e\x3cdiv class\x3d"lightboxViewDocumentInfo"\x3e\x3c/div\x3e\x3cdiv class\x3d"lightboxViewDiscussion"\x3e\x3col class\x3d"discussion"\x3e\x3c/ol\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3ca href\x3d"#" class\x3d"lightboxViewNextDocument next hidden"\x3e\x3c%- next -\x3e\x3c/a\x3e\x3cdiv class\x3d"lightboxViewCanvaLogo"\x3e\x3c/div\x3e');
mk.Mh=400;function Fk(){}Fk=Backbone.View.extend({className:"button lightboxCta",tagName:"a"});d=Fk.prototype;d.events=function(){return{click:this.ab}};d.initialize=function(a){this.analytics=a.analytics;this.Ab=a.Ab;this.Od=a.Od;this.da=a.da};d.render=function(a){a=a||{Ab:this.Ab,Od:this.Od};this.$el.html(this.template({designType:a.Ab,ctaCreateYourOwn:this.da.Pm(a.Ab),ctaGetStarted:this.da.Qm()}));this.$el.prop("href",a.Od);this.Ab=a.Ab;this.Od=a.Od;return this};
d.ab=function(){this.analytics.ab("get_started","logged_out_homepage","user_profile","view_design")};d.template=_.template('\x3c%-ctaCreateYourOwn %\x3e\x3cbr/\x3e\x3cspan class\x3d"button buttonSmall"\x3e\x3c%- ctaGetStarted %\x3e\x3c/span\x3e');function Bd(a,b){a="/login/switch?brand\x3d"+encodeURIComponent(a);void 0!==b&&(a+="\x26redirect\x3d"+encodeURIComponent(b));return a};function Gk(a,b,c){this.rc=a;this.zc=b;this.ic=c}var Hk=[];function Ik(a,b){if("in"==a)throw Error('Cannot define measurement unit conversion from "in" to itself');if(0==b)throw Error("Cannot define measurement unit conversion with conversionFactor \x3d 0");var c=new Gk("in",a,b);a=new Gk(a,"in",1/b);b=[c,a];Jk(c,b,1);Jk(a,b,0);Array.prototype.push.apply(Hk,b)}
function Me(a,b,c){if(b==c)return a;for(var e=0;e<Hk.length;e++){var f=Hk[e];if(f.rc==b&&f.zc==c)return f.ic*a}throw Error('Unknown measurement unit conversion from "'+b+'" to "'+c+'"');}
function Jk(a,b,c){var e,f,g;for(f=0;f<Hk.length;f++){var h=Hk[f];if(h.rc==a.zc){if(e=new Gk(a.rc,h.zc,a.ic*h.ic),b.push(e),0!=c)for(g=0;g<Hk.length;g++)h=Hk[g],e.rc==h.zc&&b.push(new Gk(e.zc,h.rc,1/(h.ic*e.ic)))}else if(h.zc==a.rc&&(e=new Gk(h.rc,a.zc,h.ic*a.ic),b.push(e),0!=c))for(g=0;g<Hk.length;g++)h=Hk[g],e.zc==h.rc&&b.push(new Gk(e.rc,h.zc,e.ic*h.ic))}}Ik("mm",25.4);Ik("px",96);function Kk(a){Backbone.View.call(this,_.extend(a,{className:"tabPointer"}));this.Hk=-1}k(Kk,Backbone.View);Kk.prototype.initialize=function(a){this.dk=a.dk;this.Xf=!!a.Xf;this.style=a.style||"arrow";this.$el.addClass(this.style).toggleClass("tabPointerVertical",this.Xf)};function Lk(a,b,c){c=void 0===c?!1:c;a=a.dk.children("li");c||(a=a.not(".noTab"));return a.eq(b)}function Gj(a,b){a.$el.toggleClass("tabPointerHidden",b);return a}
Kk.prototype.update=function(a,b,c){c=void 0===c?!1:c;(b=0<=this.Hk&&(void 0===b?!0:b))||this.$el.addClass("doNotTransition");if("arrow"===this.style){c=Lk(this,a,c);var e=c.offsetParent().offset(),f=c.position(),g=c.width(),h=c.height(),l=this.$el.offsetParent().offset(),m=e.top-l.top,e=e.left-l.left;c.length&&(this.Xf?this.$el.css("transform","translateY("+Math.round(f.top+m+(h-20)/2)+"px)"):this.$el.css("transform","translateX("+Math.round(f.left+e+(g-20)/2)+"px)"))}else if("rectangle"===this.style)c=
Lk(this,a,c),f=c.children("a"),g=parseInt(f.css("marginLeft"),10)?0:10,c.length&&(this.Xf?(h=Math.round(f.position().top),this.$el.css("transform","translate3d( -"+g+"px, "+h+"px, 0px)"),this.$el.css("height",f.height())):(h=Math.round(f.position().left-g),this.$el.css("transform","translateX("+h+"px)"),this.$el.css("height",f.height()-20)),this.$el.css("width",c.width()+g));else throw Error("unrecognised TabPointerStyle");b||(Vb(this.$el),this.$el.removeClass("doNotTransition"));this.Hk=a};function Mk(a){var b={};Backbone.View.call(this,{el:a.el,events:(b["click li:not(.noTab):not(.on) a"]=function(a){var b=Hj(this);a=$(a.target).closest("li");this.select(b.index(a))},b)})}k(Mk,Backbone.View);function Nk(a){var b=a.Gk,c=new Mk({el:a.el});0>b.indexOf("#")?c.select(a.bf||0):c.select(Math.max(0,Kj(c,b)));return c}function Hj(a){return a.$el.children("li:not(.noTab)")}function Ok(a){a=Hj(a);var b=a.filter(".on");return a.index(b)}
function Kj(a,b){a=Hj(a).find("a").toArray().map(function(a){return a.href});var c;a.some(function(a){var f=a.lastIndexOf(b);if(-1!==f&&f===a.length-b.length)return c=a,!0});return a.indexOf(c)}Mk.prototype.select=function(a){var b=Hj(this);b.removeClass("on");-1<a&&a<b.length&&(b.eq(a).addClass("on"),this.trigger("change",a))};Mk.prototype.remove=function(){this.$el.off("click")};function Pk(a){this.Fc=-1;this.Ya=a.Ya;this.C=a.C;this.Zj="number"===typeof a.Zj?a.Zj:-1;this.Qf=a.Qf||null;this.sl=!1;this.ob=!0}d=Pk.prototype;d.init=function(){var a=this;this.sl=!0;var b=this.Qf?Ok(this.Qf):-1,b=0<=b?b:this.Zj;0<=b&&this.rh(b);this.Qf&&this.listenTo(this.Qf,"change",this.rh);this.Ya.on("transitionend.PanelPresenter_init",function(b){b.target===a.Ya.get(0)&&a.Ya.hasClass("panelContainer--transitioning")&&Qk(a)});return this};
d.remove=function(){this.Ya.off("transitionend.PanelPresenter_init");this.stopListening();this.trigger("remove")};
d.rh=function(a){ma(this.sl,"PanelPresenter.init() must be called before showPanel()");var b=this.ob&&-1===this.Fc;b&&(this.ob=!1,Rk(this).addClass("doNotTransition"),Qk(this));var c=Rk(this);if(!(0>a||a>=c.length||a===this.Fc)){if(c.hasClass("panelContainer__panel--active")){var e=c.filter(".panelContainer__panel--active"),c=c.eq(a),f=e.outerHeight(),g=c.outerHeight();e.removeClass("panelContainer__panel--active");c.addClass("panelContainer__panel--active");this.ob&&f!==g&&(this.Ya.addClass("panelContainer--transitioning"),
this.Ya.css("height",f),Vb(this.Ya),this.Ya.css("height",g))}else c.eq(a).addClass("panelContainer__panel--active");b&&(this.ob=!0,Vb(this.Ya),Rk(this).removeClass("doNotTransition"));this.Fc=a;this.trigger("change",Aj(this),a)}};function Aj(a){return Rk(a).eq(a.Fc)}function Ij(a){var b=Rk(a),c=b.eq(0),e=b.eq(1),f=$("\x3cdiv\x3e");c.before(f);e.before(c);f.replaceWith(e);c.hasClass("panelContainer__panel--active")?a.Fc=1:e.hasClass("panelContainer__panel--active")&&(a.Fc=0);Vb(b)}
function Rk(a){return a.Ya.children(".panelContainer__panel")}function Qk(a){a.Ya.removeClass("panelContainer--transitioning");a.Ya.css("height","")}d.off=Backbone.Events.off;d.on=Backbone.Events.on;d.once=Backbone.Events.once;d.listenTo=Backbone.Events.listenTo;d.stopListening=Backbone.Events.stopListening;d.trigger=Backbone.Events.trigger;$.fn.reverse=[].reverse;$.fn.forceLayout=function(){if(0===this.length)return this;var a=this.get(0);(a=window.getComputedStyle(a))&&a.getPropertyValue("left");return this};Array.max=function(a){return Math.max.apply(Math,a)};Array.min=function(a){return Math.min.apply(Math,a)};Array.lowerBound=function(a,b,c){!c&&(c=function(a,b){return a-b});for(var e=0,f,g=a.length,h;0<g;)f=e+(h=g/2|0),0>c(a[f],b)?(e=++f,g-=h+1):g=h;return e};
Array.upperBound=function(a,b,c){!c&&(c=function(a,b){return a-b});for(var e=0,f,g=a.length,h;0<g;)f=e+(h=g/2|0),0<=c(b,a[f])?(e=++f,g-=h+1):g=h;return e};Array.Yq=function(a,b,c){var e=a.map(b,c),f=Array.min(e);return a.filter(function(a,b){return e[b]==f})};$.fn.delay=function(a,b){jQuery.fx.step.delay=function(){};return this.animate({delay:1},a,b)};
function Sk(){var a,b,c="T"+"transform".slice(1),e=["Moz","Webkit","ms"],f=document.createElement("div");if("transform"in f.style)b="transform";else for(var g=0;g<e.length;g++)if(a=e[g]+c,a in f.style){b=a;break}return $.support.transform=b}$(function(){var a=Sk();a&&"transform"!==a&&($.cssHooks.transform={get:function(b){return $.css(b,a)},set:function(b,c){b.style[a]=c}})});
$(function(){function a(){var b=document.createElement("p"),c={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"},e;document.body.insertBefore(b,null);for(var f in c)if(void 0!==b.style[f]){b.style[f]="translate3d(1px,1px,1px)";e=window.getComputedStyle(b,null);if(!e){window.setTimeout(a,500);return}e.getPropertyValue(c[f])}document.body.removeChild(b)}a()});
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),g=Math.max(0,16-(c-a)),h=window.setTimeout(function(){b(c+g)},g);a=c+g;return h});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(a){clearTimeout(a)})})();function ud(a,b){var c=a.text().trim();var e,f;e=c.trim();"undefined"==typeof f&&(f="…");if(e.length<=b)b=e;else{var g=e.substr(0,b);e=e.substr(b).match(/^\S+/);var h=g.match(/\S+$/);g.match(/\s$/)||null===e||(10>=e[0].length?g+=e[0]:10>=h[0].length&&(g=g.substr(0,b-h[0].length)));b=g=g.trim()+f}c!=b&&a.data("fullText",c).text(b+" ").append('\x3cbutton class\x3d"more" tabindex\x3d"-1"\x3eSee more\x3c/button\x3e')}
function td(a){var b=a.data("fullText");void 0!==b&&a.text(b).removeData("fullText")};function Tk(a){this.profiles=a.profiles;this.submit=a.submit;this.qc=a.qc}Tk.prototype.Zb=function(a,b){$(a).next(".formError").remove();if(null!=b){var c=$('\x3cspan class\x3d"formError"\x3e');c.text(b);$(a).after(c).focus().select()}a=0<$(".formError").length;this.submit&&$(this.submit).prop("disabled",a);return null==b};function Uk(a,b,c){var e=$(b).val().toString();Hg(a.profiles,c?gh(e,c):fh(e)).then(function(c){a.Zb(b,c.Da()?null:this.qc.format("formValidatorInvalidNameUnavailable"))})};function Vk(a,b,c,e,f,g,h,l){var m=this;this.o=b;this.aa=c;this.sn=f;this.analytics=g;this.$el=a;this.Gh=this.Xc=null;this.Aa=h;this.qc=l;this.Wh=!1;this.$el.on("change","input",function(){var a=$(this),b=a.get(0),c=a.data("originalValue");if(0<a.parent(".userName").length){var a=m.Fi,e=$(b).val().toString(),f=null;255<e.length?f=a.qc.format("formValidatorInvalidNameTooLong"):6>e.length&&c!==e?f=a.qc.format("formValidatorInvalidNameTooShort"):e.match(/[^a-zA-Z0-9._-]/)&&(f=a.qc.format("formValidatorInvalidNameSyntax"));
a.Zb(b,f)&&Uk(m.Fi,b,m.o.i())}}).on("keypress","input",function(a){13===a.keyCode&&Wk(m,!0)}).on("click","#editInfo",function(){Xk(m)}).on("click","button.cancel",function(){Wk(m,!1)}).on("click","button.save",function(){Wk(m,!0)}).on("click",".avatar",function(){m.$el.find("#avatarUpload").trigger("click")}).on("change","#avatarUpload",function(a){Yk(m,a.target.files[0])});window.addEventListener("beforeunload",function(a){var b=m.Aa.format("userProfileUploadingAvatarMessage");if(m.Xc)return(a||
window.event).returnValue=b})}_.extend(Vk.prototype,Backbone.Events);Vk.prototype.on=Backbone.Events.on;Vk.prototype.trigger=Backbone.Events.trigger;var Zk=_.template("\x3c% var angle \x3d percentage / 100 * 360 %\x3e\x3c% var radians \x3d angle * (Math.PI / 180) %\x3e\x3c% var x \x3d size/2 + Math.cos(radians) * radius %\x3e\x3c% var y \x3d size/2 + Math.sin(radians) * radius %\x3e\x3c% var largeArc \x3d percentage \x3e 50 ? 1 : 0 %\x3eM\x3c%\x3d size/2 + radius %\x3e,\x3c%\x3d size/2 %\x3e A\x3c%\x3d radius %\x3e,\x3c%\x3d radius %\x3e 0 \x3c%\x3d largeArc %\x3e,1 \x3c%\x3d x %\x3e,\x3c%\x3d y %\x3e");
function $k(a){a=a.get(0);return(void 0!==a.innerText?a.innerText:a.textContent).trim()}d=Vk.prototype;d.X=function(){return this.o};d.Da=function(){return this.$el.find(".editable.userName").text()};
d.render=function(){var a=this;this.$el.find(".displayName").text(this.o.sa()||this.o.Da());this.$el.find(".userName").text(this.o.Da());this.$el.find(".homepage").text(this.o.fl()||"");this.$el.find(".city").text(this.o.cl()||"");this.$el.find(".country").data("countryCode",this.o.Ji()||"").text(this.tk[this.o.Ji()]);var b=this.o.Lc(200);b&&al(this,b);["displayName","userName","homepage","city","country"].forEach(function(b){b=a.$el.find("."+b);b.toggleClass("empty",0===$k(b).length)})};d.ln=_.template('\x3cspan class\x3d"editing formButtons"\x3e\x3cbutton class\x3d"button buttonSmall save"\x3e\x3c%- saveButtonText %\x3e\x3c/button\x3e\x3cbutton class\x3d"cancel button buttonSmall buttonSecondary"\x3e\x3c%- cancelButtonText %\x3e\x3c/button\x3e\x3c/span\x3e');
function Xk(a){function b(a){var b=$("\x3cselect\x3e\x3c/select\x3e");$('\x3coption value\x3d"ZZ"\x3e\x3c/option\x3e').text(e.Aa.format("userProfileSelectCountry")).appendTo(b);var h=$('\x3cinput class\x3d"textInput textInputSmall" type\x3d"text" readonly tabindex\x3d"-1"\x3e').attr("placeholder",e.Aa.format("userProfileCountryPlaceholder")),l=$('\x3cspan class\x3d"countryWrapper"\x3e');_.pairs(e.tk).sort(function(a,b){return a[1].localeCompare(b[1])}).forEach(function(a){$("\x3coption\x3e").attr("value",
a[0]).text(a[1]).appendTo(b)});var m=a.data("countryCode")||"ZZ";b.val(m).data("originalValue",m).appendTo(l);h.val(b.find("option:selected").text());a.empty().append(h).append(l);a.on("change","select",c).on("focus","select",function(){h.addClass("focus")}).on("blur","select",function(){h.removeClass("focus")})}function c(a){var b=e.$el.find(".country input");a=$(a.target);"ZZ"!==a.val()?b.val(a.find("option:selected").text()):b.val("Select a country")}var e=a;a.$el.find(".editable").each(function(){var a=
$(this);if(a.hasClass("country"))b(a);else if(a.hasClass("avatar")){var c=Rg(Wg,200).fa(),c=a.data("currentUrl")===c;$('\x3cinput id\x3d"avatarUpload" type\x3d"file" accept\x3d"image/*"\x3e').insertAfter(a);a.toggleClass("default",c)}else{var c=$k(a),e=$('\x3cinput type\x3d"text"\x3e'),l=a.data("placeholder");e.addClass("textInput textInputSmall").val(c).data("originalValue",c).attr("placeholder",l).css("font-weight",a.css("font-weight"));a.html(e)}});a.$el.find(".formButtons").after(a.ln({saveButtonText:e.Aa.format("userProfileSaveChangesButton"),
cancelButtonText:e.Aa.format("userProfileCancelButton")}));a.$el.addClass("editing");a.Fi=new Tk({profiles:a.aa,submit:a.$el.find(".save").get(0),qc:a.qc});a.trigger("beginEditing");a.Wh=!1}
function Wk(a,b){function c(){g.Gh=window.setTimeout(function(){g.Xc?c():(bl(g),Wk(g,!0))},1E3)}function e(){function a(){function h(b){b&&b.zg()&&0!==Object.keys(b.zg()).length?(c(),$("#currentUser .avatar img").attr("src",Rg(b,50).fa())):a()}e=Math.min(1.4*e,15E3);setTimeout(function(){var a=g.aa;B(a.u,a.path+"/user/avatars/"+f).get(0).then(Qg).then(h).catch(b)},e)}function b(){window.alert("user update failed");g.render()}function c(){A(g.sn,"/session/user?invalidateCache",null)}var e=1E3,f=g.$el.find(".avatar").data("uploadedVersion"),
h=g.$el.find(".avatar").data("uploadedType"),p=bh(ah($g(Zg(Yg((new Xg).Kh(g.o.i()),$k(g.$el.find(".userName"))||null),$k(g.$el.find(".displayName"))||null),$k(g.$el.find(".homepage"))),$k(g.$el.find(".city"))),g.$el.find(".country").data("countryCode")||null);zg(g.aa,p).then(function(a){$.extend(g.o,a.user);(l||m)&&c()}).catch(b);void 0!==f&&void 0!==h&&Lg(g.aa,f,h).then(a).catch(b)}function f(){var a=$(this);if(a.hasClass("country")){var c=a.find(".countryWrapper"),e=c.find("select"),e=(b?e.val():
e.data("originalValue")).trim().replace(/\s+/g," ");a.empty().text(g.tk[e]||"").data("countryCode",e).toggleClass("empty","ZZ"==e);c.remove()}else a.hasClass("avatar")?(a=a.next("input[type\x3dfile]"),b||cl(g),a.remove()):(a=$(this).find("input"),a=(b?a.val():a.data("originalValue")).trim().replace(/\s+/g," "),$(this).text(a).toggleClass("empty",""==a))}var g=a,h=a.$el.find(".displayName input"),l=h.data("originalValue")!==h.val(),h=a.$el.find(".userName input"),m=h.data("originalValue")!==h.val(),
h=a.$el.find(".homepage input"),h=h.data("originalValue")!==h.val(),q=a.$el.find(".city input"),q=q.data("originalValue")!==q.val(),p=a.$el.find(".country select"),r=p.data("originalValue")!==p.val(),p=a.$el.find("button.save"),h=g.Wh||l||m||h||q||r;b&&g.Xc?(p.prop("disabled",!0).val("Finishing upload..."),!g.Gh&&c()):(g.$el.find(".editing.formButtons").remove(),g.$el.find(".editable").each(f),g.$el.removeClass("editing"),b&&e());a.trigger("endEditing",h);a.Fi=null}
function Yk(a,b){var c=window.URL||window.webkitURL;if(!c)throw Error("Failed to create object url. Unsupported browser.");var e=c.createObjectURL(b);(function(a,b){var c=$('\x3cimg class\x3d"offscreen"\x3e');c.one("load",function(){c.remove();b()});c.appendTo($("body")).attr("src",a)})(e,function(){al(a,e);window.setTimeout(function(){c.revokeObjectURL(e)},500)});cl(a);dl(a,b)}
function dl(a,b){function c(a){window.clearInterval(m);m=null;g.Xj(100);h.data("uploadedVersion",a);h.data("uploadedType",l);window.setTimeout(function(){bl(g)},2200);g.Wh=!0}function e(a){a.lengthComputable&&(a=a.loaded/a.total*9E3/100,90>a?g.Xj(a):m||(m=window.setInterval(function(){q+=.1;g.Xj(Math.min(q,99))},200)))}function f(){window.alert("There was an error uploading your avatar. Please try again later.");bl(g);al(g,h.data("currentUrl"))}var g=a,h=a.$el.find(".avatar"),l=b.type,m,q=90;h.addClass("uploading");
Jg(a.aa,l).then(function(a){var h=new XMLHttpRequest;g.Xc=h;h.upload.addEventListener("progress",e,!1);h.onreadystatechange=function(){4===h.readyState&&(200===h.status?c(a.getVersion()):0===h.status?bl(g):f(),g.Xc=null)};h.open("PUT",a.fa(),!0);h.setRequestHeader("Content-Type",l);h.send(b)}).catch(f)}
d.Xj=_.throttle(function(a){function b(a){a=Math.min(a,99.9999);return{size:140,radius:65,percentage:a}}var c=this.$el.find("svg.progress");0===c.length&&(c=$('\x3csvg class\x3d"progress" data-progress\x3d"0"\x3e\x3cpath fill\x3d"none" stroke\x3d"#00c4cc" stroke-width\x3d"10"\x3e\x3canimate id\x3d"uploading" attributeName\x3d"d" fill\x3d"freeze" begin \x3d "indefinite" dur \x3d "200ms"/\x3e\x3canimate id\x3d"processing" attributeName\x3d"stroke" begin\x3d"indefinite" values\x3d"#00c4cc; #99c432; #00c4cc" dur\x3d"1s" repeatCount\x3d"2"/\x3e\x3c/path\x3e\x3c/svg\x3e'),c.prependTo(this.$el.find(".avatar")).forceLayout().css("opacity",
1));for(var e=c.find("#uploading")[0],f=parseFloat(c.data("progress")),g=Zk(b(f)),h=!!e.beginElement,l=Math.ceil(a-f),m=[],q,p=0;p<=l;p++)q=f+p/l*(a-f),m.push(Zk(b(q)));c.find("path").attr("d",g);c.data("progress",a);e.setAttribute("values",m.join(";"));h?(e.beginElement(),100===a&&c.find("#processing").get(0).beginElementAt(.2)):c.find("path").attr("d",_.last(m))},200);
function bl(a){var b=a.$el.find("svg.progress"),c=a.$el.find(".avatar");b.css("opacity",0);window.setTimeout(function(){b.remove();c.removeClass("uploading")},200)}function cl(a){var b=a.$el.find(".avatar").data("currentUrl");a.Xc&&a.Xc.abort();a.Xc=null;window.clearTimeout(a.Gh);a.Gh=null;al(a,b)}function al(a,b){var c=Rg(Wg,200).fa();a=a.$el.find(".avatar");var e="url("+b+")";a.toggleClass("default",b===c);a.css("background-image")!=e&&a.css("background-image",e)};function H(a){this.jg=a.jg||"";this.bb=a.bb;this.$el=$("\x3cdiv\x3e").addClass("masonryLayout")}d=H.prototype;d.on=Backbone.Events.on;d.off=Backbone.Events.off;d.trigger=Backbone.Events.trigger;d.add=function(a,b){function c(){return _.min(_.range(e.length),function(a){return e[a]})}var e,f;this.oa||el(this,fl(this));e=this.oa.get().map(this.Ha,this);this.oa.eq(0).append(a);f=a.get().map(this.Ha,this);a.each(function(a,h){var l=c();e[l]+=f[a];b?this.oa.eq(l).prepend(h):this.oa.eq(l).append(h)}.bind(this))};
d.contains=function(a){return!(!this.oa||!this.oa.children().filter(a).length)};function el(a,b){var c="masonryLayoutColumn "+a.jg;a.oa=_.range(b).map(function(){return $("\x3cdiv\x3e").addClass(c).width(100/b+"%")}).reduce($.merge);a.oa.appendTo(a.$el)}function fl(a){var b;"function"===typeof a.bb?(b=a.$el.width(),a=a.bb(b)):a=a.bb;return Math.max(a,1)}
d.Ha=function(a){var b=window.getComputedStyle(a);a=a.getBoundingClientRect().height;var c=Math.pow(10,2);return Math.round(a*c)/c+(parseInt(b.marginBottom,10)||0)+(parseInt(b.marginTop,10)||0)};d.qd=function(){var a;a=this.oa.children().get();a.sort(function(a,c){return a.offsetTop!==c.offsetTop?a.offsetTop-c.offsetTop:a.offsetLeft-c.offsetLeft});return $(a)};
function gl(a,b){function c(a){return a.offsetHeight+a.offsetTop}var e;if(!a.contains(b))throw Error("The given element is not an item in the masonry layout.");e=c(b[0]);return $(a.oa.children().get().filter(function(a){return c(a)>e}))}d.ne=function(){var a;return this.oa?(a=_.min(this.oa.get(),this.Ha,this),$(a)):null};d.isEmpty=function(){return!(this.oa&&this.oa.children().length)};d.push=function(a){this.add(a)};
d.wc=function(){var a=fl(this);this.oa&&a!==this.oa.length&&(a=this.qd().detach(),this.oa&&this.oa.remove(),this.oa=void 0,this.push(a),this.trigger("redraw"))};d.remove=function(a){this.oa&&this.oa.children().filter(a).remove()};
d.split=function(a){var b,c;if(!this.contains(a))throw Error("The given element is not an item in the masonry layout.");b=gl(this,a);if(0===b.length)return null;c=new H({jg:this.jg,bb:this.bb});el(c,this.oa.length);this.oa.each(function(a,f){f=$(f).children().filter(b);c.oa.eq(a).append(f)});return c};d.unshift=function(a){this.add(a,!0)};function Nj(a,b){this.Uk=this.Tk=this.Sk=this.Rk=this.Qe=this.pe=this.Kj=this.Lj=this.scrollHeight=this.scrollWidth=this.scrollTop=this.scrollLeft=0;this.Ih=this.Eg=null;this.em=!!b;this.mk=new ne(x,this);this.nk=new ne(x,this);this.uh=new hl({attributes:!0,attributeFilter:["class","style"],childList:!0,characterData:!1,subtree:!0});this.ja=a;this.Fb=$("\x3cdiv\x3e").addClass("scrollThumb");this.Ob=$("\x3cdiv\x3e").addClass("scrollThumb");this.Oc=this.Oc.bind(this);this.ah=this.ah.bind(this);this.Wg=
this.Wg.bind(this);this.Xg=this.Xg.bind(this);this.Ug=this.Ug.bind(this);this.Vg=this.Vg.bind(this);this.Cf=this.Cf.bind(this);this.Df=this.Df.bind(this);this.Sg=this.Sg.bind(this);this.Tg=this.Tg.bind(this)}d=Nj.prototype;d.trigger=Backbone.Events.trigger;d.on=Backbone.Events.on;d.off=Backbone.Events.off;
d.render=function(){this.ja.addClass("scrollElement");$("\x3cdiv\x3e").addClass("scrollTrack hScrollTrack").append(this.Fb).insertAfter(this.ja);$("\x3cdiv\x3e").addClass("scrollTrack vScrollTrack").append(this.Ob).insertAfter(this.ja);il(this);this.ja.on("scroll",this.ah);this.ja.on("transitionend",this.Oc);this.ja.on("mouseenter",this.Wg);this.ja.on("mouseleave",this.Xg);this.Fb.on("mousedown",this.Ug);this.Ob.on("mousedown",this.Vg);this.uh.on("attrModified",this.Oc);this.uh.on("subtreeModified",
this.Oc);this.uh.observe(this.ja);$("\x3cspan\x3e").appendTo(this.ja).remove();$(window).on("resize",this.Oc);return this};d.remove=function(){var a=this.uh;a.Pk.disconnect();a.Ce=null;this.ja.off("scroll",this.ah);this.ja.off("transitionend",this.Oc);this.ja.off("mouseenter",this.Wg);this.ja.off("mouseleave",this.Xg);this.Fb.off("mousedown",this.Ug);this.Ob.off("mousedown",this.Vg);$(window).off("resize",this.Oc);return this};
function il(a){(new ne(x,a)).read(function(a){var c=this.ja.prop("clientWidth"),e=this.ja.prop("offsetWidth"),f=this.ja.prop("clientHeight"),g=this.ja.prop("offsetHeight");a.write(function(){e>c&&this.ja.css("margin-right",c-e);g>f&&this.ja.css("margin-bottom",f-g);this.wc()})})}d.wc=function(){this.mk.read(this.fm)};
d.fm=function(){var a=this.scrollWidth,b=this.scrollHeight,c=this.pe,e=this.Qe;this.scrollWidth=this.ja.prop("scrollWidth");this.scrollHeight=this.ja.prop("scrollHeight");this.Lj=this.ja.prop("clientWidth");this.Kj=this.ja.prop("clientHeight");this.pe=this.Fb.parent().outerWidth();this.Qe=this.Ob.parent().outerHeight();if(a!==this.scrollWidth||b!==this.scrollHeight||c!==this.pe||e!==this.Qe)this.scrollTop=this.scrollLeft=-1,this.mk.write(this.jp),this.nk.read(this.hm)};
d.jp=function(){var a=Math.round(this.Qe*this.Kj/this.scrollHeight);this.Fb.css("width",Math.round(this.pe*this.Lj/this.scrollWidth)+"px");this.Ob.css("height",a+"px");var a=this.Lj<this.scrollWidth,b=this.Kj<this.scrollHeight,c=a!==this.Eg,e=b!==this.Ih;c&&(this.Eg=a,this.Fb.toggleClass("disabled",!a));e&&(this.Ih=b,this.Ob.toggleClass("disabled",!b));this.em&&(c||e)&&this.trigger("change:scrollability",this.Eg,this.Ih)};
d.hm=function(){var a=this.scrollLeft,b=this.scrollTop;this.scrollLeft=this.ja.scrollLeft();this.scrollTop=this.ja.scrollTop();if(a!==this.scrollLeft||b!==this.scrollTop)this.nk.write(this.kp),this.em&&(this.Eg||this.Ih)&&this.trigger("scroll",this.scrollLeft,this.scrollTop)};d.kp=function(){var a=Math.round(this.Qe*this.scrollTop/this.scrollHeight);this.Fb.css("transform","translateX("+Math.round(this.pe*this.scrollLeft/this.scrollWidth)+"px)");this.Ob.css("transform","translateY("+a+"px)")};
d.Oc=function(){this.mk.read(this.fm)};d.ah=function(){this.nk.read(this.hm)};d.Wg=function(){this.Fb.addClass("ready");this.Ob.addClass("ready")};d.Xg=function(){this.Fb.removeClass("ready");this.Ob.removeClass("ready")};d.Ug=function(a){0===a.button&&(this.Rk=a.screenX,this.Tk=this.scrollLeft,this.Fb.addClass("active"),$(document).on("mousemove",this.Cf).on("mouseup",this.Sg),a.preventDefault(),a.stopPropagation())};
d.Cf=function(a){this.ja.scrollLeft(this.Tk+Math.round((a.screenX-this.Rk)*this.scrollWidth/this.pe))};d.Sg=function(a){this.Cf(a);this.Fb.removeClass("active");$(document).off("mousemove",this.Cf).off("mouseup",this.Sg)};d.Vg=function(a){0===a.button&&(this.Sk=a.screenY,this.Uk=this.scrollTop,this.Ob.addClass("active"),$(document).on("mousemove",this.Df).on("mouseup",this.Tg),a.preventDefault(),a.stopPropagation())};
d.Df=function(a){this.ja.scrollTop(this.Uk+Math.round((a.screenY-this.Sk)*this.scrollHeight/this.Qe))};d.Tg=function(a){this.Df(a);this.Ob.removeClass("active");$(document).off("mousemove",this.Df).off("mouseup",this.Tg)};function jl(a){this.md=a;this.en=$.isWindow(this.md[0]);this.ll=_.throttle(this.dispatchEvent.bind(this),200)}function kl(){var a=window,a=$(a),b=a.data("CANVA_SCROLL_TARGET");if(!b){var c=b=new jl(a);c.stopListening();c.md.on("scroll",c.ll);a.data("CANVA_SCROLL_TARGET",b)}return b}d=jl.prototype;d.stopListening=function(){this.md.off("scroll",this.ll)};
function ll(a,b){var c;c=_.defaults({},c,{vn:!1});var e=b.offset().top;c=c.vn?parseInt(b.css("margin-bottom"),10):0;b=b.outerHeight();e=e+b+c;b=a.en?a.md.scrollTop():a.md.offset().top+parseInt(a.md.css("border-top-width"),10);a=a.md.innerHeight();return e-(b+a)}d.on=Backbone.Events.on;d.once=Backbone.Events.once;d.off=Backbone.Events.off;d.trigger=Backbone.Events.trigger;d.dispatchEvent=function(){this.trigger("scroll",this)};function hl(a){var b=this,c=window.MutationObserver||window.WebKitMutationObserver;this.Ce=null;this.sf={nodeinserted:[],noderemoved:[],characterdatamodified:[],attrmodified:[]};this.qa=a?a:{attributes:!1,childList:!0,characterData:!0,subtree:!0};this.Pk=new c(function(a){a.forEach(function(a){b.handle(a)})})}hl.prototype.normalize=function(a){return a.toLowerCase()};hl.prototype.on=function(a,b){a=this.normalize(a);this.sf.hasOwnProperty(a)||(this.sf[a]=[]);this.sf[a].push(b);return this};
hl.prototype.handle=function(a){function b(b){var f=c.normalize(b),g=new jQuery.Event(b);c.Ce&&(g.target=a.target,g.currentTarget=c.Ce.get(0),c.sf.hasOwnProperty(f)&&c.sf[f].forEach(function(a){a.call(c.Ce,g)}))}var c=this;"childList"===a.type?(a.addedNodes&&0<a.addedNodes.length?b("nodeInserted"):a.removedNodes&&0<a.removedNodes.length&&b("nodeRemoved"),b("subtreeModified")):"attributes"===a.type?b("attrModified"):"characterData"===a.type&&b("characterDataModified")};
hl.prototype.observe=function(a){var b=$(a).get(0);if(this.Ce)throw Error("Already observing an element");b&&(this.Pk.observe(b,this.qa),this.Ce=$(a))};function yd(){}yd=Backbone.View.extend({className:"button buttonLike buttonSmall"});d=yd.prototype;d.attributes=function(){return{tabindex:0}};d.events=function(){return{click:this.Ad}};d.initialize=function(a){this.Ba=a.Ba;this.za=a.za;this.Ca=a.Ca;this.Na=a.Na;this.Y=a.Y;this.jb=a.jb};d.Li=function(){return window.location.pathname+window.location.search};
d.Ig=function(){var a=this;this.Ca=!0;this.Na++;this.render();Ch(this.Y,new Wh({sb:this.Ba,type:"DOCUMENT"})).catch(function(){a.Ca=!1;a.Na--;a.render();a.trigger("unlike")});this.trigger("like")};d.navigate=function(a){window.location=a};d.Ad=function(){this.$el.removeClass("buttonLikeNoAnimation");this.za?this.navigate(xk({loginRedirect:this.Li()})):this.Ca?ml(this):this.Ig()};
d.render=function(){if(1>this.$el.children().length)this.$el.html(this.template(this.jh())),this.$el.addClass("buttonLikeNoAnimation");else if(this.Ui()){var a=this.Ca?this.jb.Ig():this.jb.sb();this.$(".buttonLikeText").attr("data-alternate-text",a)}this.$(".buttonLikeText").html(this.Up(this.jh()));this.$el.toggleClass("buttonActive",this.Ca);this.$el.toggleClass("buttonLikeFirstLike",this.Ui());return this};
d.jh=function(){return{isFirstLike:this.Ui(),likedByMe:this.Ca,likerCount:this.Na,likeLabel:this.jb.Ig(),likedLabel:this.jb.sb()}};d.Ui=function(){return 1>this.Na-this.Ca};d.template=_.template('\x3cspan class\x3d"buttonLikeFill"\x3e\x3c/span\x3e\x3cspan class\x3d"buttonLikeIcon"\x3e\x3c/span\x3e\x3cspan class\x3d"buttonLikeText"\x3c% if (isFirstLike) { %\x3e data-alternate-text\x3d"\x3c%- likedByMe ? likeLabel : likedLabel %\x3e"\x3c% } %\x3e\x3e\x3c/span\x3e');d.Up=_.template("\x3c% if (isFirstLike) { %\x3e\x3c%- likedByMe ? likedLabel : likeLabel %\x3e\x3c% } else { %\x3e\x3c%- likerCount %\x3e\x3c% } %\x3e");
function ml(a){a.Ca=!1;a.Na--;a.render();Fh(a.Y,new Yh({sb:a.Ba})).catch(function(){a.Ca=!0;a.Na++;a.render();a.trigger("like")});a.trigger("unlike")};function xk(a){a=_.map(a,function(a,c){if(void 0!==a)return[encodeURIComponent(c),encodeURIComponent(a)].join("\x3d")});a=_.flatten(a).join("\x26");return window.signupLink||"/signup"+(a?"?"+a:"")};function U(a){Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor);this.message=a}U.prototype=Object.create(Error.prototype);U.prototype.constructor=U;
function ri(a){switch(a){case "card_declined":return new nl;case "expired_card":return new ol;case "incorrect_cvc":return new pl;case "incorrect_number":return new ql;case "invalid_cvc":return new rl;case "invalid_expiry_month":return new sl;case "invalid_expiry_year":return new tl;case "invalid_number":return new ul;case "missing":return new vl;case "processing_error":return new wl;default:return new xl(a)}}
function yl(a,b){if(b instanceof nl)return a.format("creditCardDeclined");if(b instanceof ol)return a.format("creditCardExpired");if(b instanceof pl)return a.format("creditCardCvcIncorrect");if(b instanceof ql)return a.format("creditCardNumberIncorrect");if(b instanceof rl)return a.format("creditCardCvcIncorrect");if(b instanceof sl)return a.format("creditCardExpiryMonthIncorrect");if(b instanceof tl)return a.format("creditCardExpiryYearIncorrect");if(b instanceof ul)return a.format("creditCardNumberIncorrect");
if(b instanceof vl)return a.format("creditCardMissingButRequired");if(b instanceof wl)return a.format("creditCardProcessingError");if(b instanceof xl)return a.format("creditCardUnknownProcessingError",b.errorCode);if(b instanceof zl)return a.format("creditCardNoCardEntered");throw Error("unrecognized CreditCardError");}function nl(){U.call(this,"credit card declined")}nl.prototype=Object.create(U.prototype);nl.prototype.constructor=nl;function ol(){U.call(this,"credit card expired")}
ol.prototype=Object.create(U.prototype);ol.prototype.constructor=ol;function pl(){U.call(this,"credit card cvc incorrect")}pl.prototype=Object.create(U.prototype);pl.prototype.constructor=pl;function ql(){U.call(this,"credit card number incorrect")}ql.prototype=Object.create(U.prototype);ql.prototype.constructor=ql;function rl(){U.call(this,"credit card cvc invalid")}rl.prototype=Object.create(U.prototype);rl.prototype.constructor=rl;function sl(){U.call(this,"credit card expiry month invalid")}
sl.prototype=Object.create(U.prototype);sl.prototype.constructor=sl;function tl(){U.call(this,"credit card expiry year invalid")}tl.prototype=Object.create(U.prototype);tl.prototype.constructor=tl;function ul(){U.call(this,"credit card number invalid")}ul.prototype=Object.create(U.prototype);ul.prototype.constructor=ul;function vl(){U.call(this,"credit card missing but required")}vl.prototype=Object.create(U.prototype);vl.prototype.constructor=vl;
function wl(){U.call(this,"credit card processing error")}wl.prototype=Object.create(U.prototype);wl.prototype.constructor=wl;function xl(a){U.call(this,"unknown credit card processing error "+a);this.errorCode=a}xl.prototype=Object.create(U.prototype);xl.prototype.constructor=xl;function zl(){U.call(this,"no credit card entered")}zl.prototype=Object.create(U.prototype);zl.prototype.constructor=zl;function Al(){var a=window.stripeConfig;switch(a.impl){case "local":return new Bl;case "stripe":return new Cl(a.publishableKey,window.Stripe||null);default:throw Error('unexpected stripe impl "'+a.impl+'"');}}function Bl(){}Bl.prototype.createToken=P.method(function(a){return JSON.stringify({brand:"Visa",expMonth:a.Vk,expYear:a.Wk,last4:a.yd.slice(-4)})});function Cl(a,b){(this.Nb=b)&&this.Nb.setPublishableKey(a)}
Cl.prototype.createToken=function(a){return new P(function(b,c){if(!this.Nb)throw Error("Stripe API is unavailable");a={cvc:a.jd,exp_month:a.Vk,exp_year:a.Wk,number:a.yd};this.Nb.createToken(a,function(a,f){if(f.error){var g;try{g=f.error.code||""}catch(h){g=""}c(ri(g))}else b(f.id)})}.bind(this))};function Dl(a){this.We=a.We;this.G=a.G;this.Ea=a.Ea;this.Pa=a.Pa;this.element=$('\x3cdiv class\x3d"creditCardEditor"\x3e');this.Nb=a.Nb;this.view=a.view;this.listenTo(this.view,"input",this.lj);this.listenTo(this.view,"requestSubmit",function(){this.trigger("requestSubmit")})}d=Dl.prototype;d.listenTo=Backbone.Events.listenTo;d.off=Backbone.Events.off;d.on=Backbone.Events.on;d.once=Backbone.Events.once;d.stopListening=Backbone.Events.stopListening;d.trigger=Backbone.Events.trigger;
d.render=function(){this.view.render().$el.appendTo(this.element);this.lh(this.Pa);this.Ea&&this.Jd(this.Ea);return this};d.getElement=function(){return this.element};d.remove=function(){this.stopListening();this.view.remove()};d.Jd=function(a){this.Ea=a;this.view.Jd(a);return this};d.lh=function(a){this.Pa=a;this.view.lh(a);return this};d.mn=P.method(function(a){function b(a){return a.Ag()}return!this.Ea||this.view.sg||a?(a=El(this.view),Fl(a),this.$p(a).then(b).tap(this.Jd.bind(this))):this.Ea});
d.lj=function(){this.Ea&&!El(this.view)&&this.Jd(this.Ea);this.trigger("input",this.view.sg)};d.$p=P.method(function(a){var b=this;return this.Nb.createToken({jd:a.jd,Vk:a.tg,Wk:a.ug,yd:a.yd}).then(function(a){return b.We.Jm(b.G,a)})});
function Fl(a){if(!a)throw new zl;if(!(a.jd&&3<=a.jd.length&&4>=a.jd.length))throw new rl;if(!function(){var b=a.tg&&parseInt(a.tg,10);return b&&1<=b&&12>=b}())throw new sl;if(!a.ug||!parseInt(a.ug,10))throw new tl;if(!function(){var b=a.yd&&a.yd.replace(/[\s-]+/g,"");return b&&13<=b.length&&19>=b.length}())throw new ul;};function Gl(a){a=a||{};soy.asserts.assertType(null==a.attributes||a.attributes instanceof soydata.SanitizedHtmlAttribute||a.attributes instanceof soydata.UnsanitizedText||goog.isString(a.attributes),"attributes",a.attributes,"?soydata.SanitizedHtmlAttribute|string|undefined");soy.asserts.assertType(null==a.block||goog.isBoolean(a.block)||1===a.block||0===a.block,"block",a.block,"boolean|null|undefined");soy.asserts.assertType(null==a.Oa||a.Oa instanceof goog.soy.data.SanitizedContent||goog.isString(a.Oa),
"classes",a.Oa,"null|string|undefined");soy.asserts.assertType(null==a.disabled||goog.isBoolean(a.disabled)||1===a.disabled||0===a.disabled,"disabled",a.disabled,"boolean|null|undefined");soy.asserts.assertType(null==a.id||a.id instanceof goog.soy.data.SanitizedContent||goog.isString(a.id),"id",a.id,"null|string|undefined");soy.asserts.assertType(null==a.name||a.name instanceof goog.soy.data.SanitizedContent||goog.isString(a.name),"name",a.name,"null|string|undefined");soy.asserts.assertType(null==
a.placeholder||a.placeholder instanceof goog.soy.data.SanitizedContent||goog.isString(a.placeholder),"placeholder",a.placeholder,"null|string|undefined");soy.asserts.assertType(null==a.tagName||a.tagName instanceof goog.soy.data.SanitizedContent||goog.isString(a.tagName),"tagName",a.tagName,"null|string|undefined");var b=a.tagName;soy.asserts.assertType(null==a.type||a.type instanceof goog.soy.data.SanitizedContent||goog.isString(a.type),"type",a.type,"null|string|undefined");soy.asserts.assertType(null==
a.small||goog.isBoolean(a.small)||1===a.small||0===a.small,"small",a.small,"boolean|null|undefined");soy.asserts.assertType(null==a.value||a.value instanceof goog.soy.data.SanitizedContent||goog.isString(a.value),"value",a.value,"null|string|undefined");var c=a.value,b=null==b?"input":b;a=""+("textarea"==b?"\x3ctextarea "+Hl(a)+"\x3e"+(c?soy.$$escapeHtmlRcdata(c):"")+"\x3c/textarea\x3e":"\x3c"+soy.$$filterHtmlElementName(b)+" "+Hl(a)+"\x3e");return soydata.VERY_UNSAFE.ordainSanitizedHtml(a)}
function Hl(a){a=a||{};soy.asserts.assertType(null==a.attributes||a.attributes instanceof soydata.SanitizedHtmlAttribute||a.attributes instanceof soydata.UnsanitizedText||goog.isString(a.attributes),"attributes",a.attributes,"?soydata.SanitizedHtmlAttribute|string|undefined");var b=a.attributes;soy.asserts.assertType(null==a.block||goog.isBoolean(a.block)||1===a.block||0===a.block,"block",a.block,"boolean|null|undefined");var c=a.block;soy.asserts.assertType(null==a.Oa||a.Oa instanceof goog.soy.data.SanitizedContent||
goog.isString(a.Oa),"classes",a.Oa,"null|string|undefined");var e=a.Oa;soy.asserts.assertType(null==a.disabled||goog.isBoolean(a.disabled)||1===a.disabled||0===a.disabled,"disabled",a.disabled,"boolean|null|undefined");var f=a.disabled;soy.asserts.assertType(null==a.id||a.id instanceof goog.soy.data.SanitizedContent||goog.isString(a.id),"id",a.id,"null|string|undefined");var g=a.id;soy.asserts.assertType(null==a.name||a.name instanceof goog.soy.data.SanitizedContent||goog.isString(a.name),"name",
a.name,"null|string|undefined");var h=a.name;soy.asserts.assertType(null==a.placeholder||a.placeholder instanceof goog.soy.data.SanitizedContent||goog.isString(a.placeholder),"placeholder",a.placeholder,"null|string|undefined");var l=a.placeholder;soy.asserts.assertType(null==a.tagName||a.tagName instanceof goog.soy.data.SanitizedContent||goog.isString(a.tagName),"tagName",a.tagName,"null|string|undefined");var m=a.tagName;soy.asserts.assertType(null==a.type||a.type instanceof goog.soy.data.SanitizedContent||
goog.isString(a.type),"type",a.type,"null|string|undefined");var q=a.type;soy.asserts.assertType(null==a.small||goog.isBoolean(a.small)||1===a.small||0===a.small,"small",a.small,"boolean|null|undefined");var p=a.small;soy.asserts.assertType(null==a.value||a.value instanceof goog.soy.data.SanitizedContent||goog.isString(a.value),"value",a.value,"null|string|undefined");a=a.value;return soydata.VERY_UNSAFE.ordainSanitizedHtmlAttribute((b?" "+soy.$$filterHtmlAttributes(b):"")+' class\x3d"textInput'+
(c?" textInputBlock":"")+(e?" "+soy.$$escapeHtmlAttribute(e):"")+(p?" textInputSmall":"")+'"'+(f?" disabled":"")+(g?' id\x3d"'+soy.$$escapeHtmlAttribute(g)+'"':"")+(h?' name\x3d"'+soy.$$escapeHtmlAttribute(h)+'"':"")+(l?' placeholder\x3d"'+soy.$$escapeHtmlAttribute(l)+'"':"")+("textarea"!=m?' type\x3d"'+soy.$$escapeHtmlAttribute(null==q?"text":q)+'"'+(a?' value\x3d"'+soy.$$escapeHtmlAttribute(a)+'"':""):""))};function Il(a){Backbone.View.call(this,{className:"creditCardEditView"});this.sg=!1;this.La=a.La;this.fg=a.fg}k(Il,Backbone.View);d=Il.prototype;d.events=function(){return{"input #ccNumber":this.Nn,"keydown #expMonth":this.uo,"input #expMonth":this.so,input:this.lj,"keydown input":this.po,"focus input:not([readonly])":this.mo,"blur input":this.ej}};
function El(a){a={jd:a.$("#cvc").val().trim(),tg:a.$("#expMonth").val().trim(),ug:a.$("#expYear").val().trim(),yd:a.$("#ccNumber").val().trim()};return a.jd.length||a.tg.length||a.ug.length||a.yd.length?a:null}d.Jd=function(a){this.$el.addClass("prefilled");this.$("#ccNumber").val("").attr("placeholder","••••••••••••"+a.last4);this.$("#expMonth").val("").attr("placeholder","••");this.$("#expYear").val("").attr("placeholder","••");this.$("#cvc").val("").attr("placeholder","•••");this.sg=!1};
d.lh=function(a){this.$("input").prop("readonly",!a);Jl(this)};
d.render=function(){var a;a=this.La.Ak();var b=this.La.wl(),c=this.La.lm(),e=this.La.Ik();soy.asserts.assertType(goog.isString(a)||a instanceof goog.soy.data.SanitizedContent,"cardNumberPlaceholder",a,"string|goog.soy.data.SanitizedContent");soy.asserts.assertType(goog.isString(b)||b instanceof goog.soy.data.SanitizedContent,"monthPlaceholder",b,"string|goog.soy.data.SanitizedContent");soy.asserts.assertType(goog.isString(c)||c instanceof goog.soy.data.SanitizedContent,"yearPlaceholder",c,"string|goog.soy.data.SanitizedContent");
soy.asserts.assertType(goog.isString(e)||e instanceof goog.soy.data.SanitizedContent,"cvcPlaceholder",e,"string|goog.soy.data.SanitizedContent");a=soydata.VERY_UNSAFE.ordainSanitizedHtml(Gl({id:"ccNumber",name:"ccNumber",type:"text",placeholder:a,attributes:soydata.VERY_UNSAFE.$$ordainSanitizedAttributesForInternalBlocks('pattern\x3d"[0-9]{4}([ -]+[0-9]{1,4}){3,5} ?" maxlength\x3d"23" autocomplete\x3d"cc-number" required')})+"\x3cspan class\x3d'creditCardExpiry'\x3e"+Gl({id:"expMonth",name:"expMonth",
type:"text",placeholder:b,attributes:soydata.VERY_UNSAFE.$$ordainSanitizedAttributesForInternalBlocks('pattern\x3d"[01]?[0-9]" maxlength\x3d"2" autocomplete\x3d"cc-exp-month" required')})+Gl({id:"expYear",name:"expYear",type:"text",placeholder:c,attributes:soydata.VERY_UNSAFE.$$ordainSanitizedAttributesForInternalBlocks('pattern\x3d"[0-3][0-9]" maxlength\x3d"2" autocomplete\x3d"cc-exp-year" required')})+"\x3c/span\x3e"+Gl({id:"cvc",name:"cvc",type:"text",placeholder:e,attributes:soydata.VERY_UNSAFE.$$ordainSanitizedAttributesForInternalBlocks('pattern\x3d"[0-9]{3,4}" maxlength\x3d"4" autocomplete\x3d"cc-csc" required')}));
this.$el.html(a.toString());Jl(this);return this};function Jl(a){var b=0===a.$("input").filter(function(){return this.readOnly}).length,c=a.$("#ccNumber");a.fg&&b?c.prop("autofocus",!0):c.removeAttr("autofocus")}
d.lj=function(a){a=$(a.target);var b=a.data("oldValue"),c=a.val();b!==c?(a.data("oldValue",c),a=!0):a=!1;a&&(this.$el.hasClass("prefilled")&&(this.$("#ccNumber").attr("placeholder",this.La.Ak()),this.$("#expMonth").attr("placeholder",this.La.wl()),this.$("#expYear").attr("placeholder",this.La.lm()),this.$("#cvc").attr("placeholder",this.La.Ik())),this.$el.removeClass("prefilled"),this.sg=!0,this.trigger("input"))};d.po=function(a){13===a.keyCode&&(this.trigger("requestSubmit"),a.preventDefault())};
d.mo=function(){this.$el.addClass("focused")};d.ej=function(){this.$el.removeClass("focused")};d.Nn=function(a){if("IE"!=UAParser().browser.name){a=a.target;var b=a.selectionEnd,c=a.value.length;a.value=a.value.replace(/[^\d]/g,"").replace(/(.{4})/g,"$1 ").trim();var e=c!==a.value.length,c=" "===a.value.charAt(c-1);a.selectionEnd=b+(" "===a.value.charAt(b-1)&&c&&e?1:0)}};
d.uo=function(a){var b=this.$("#expMonth"),c=b.val(),e=this.$("#expYear"),f=String.fromCharCode(a.which);""===c&&f.match(/[2-9]/)?(a.preventDefault(),b.val("0"+f),e.focus()):-1<[191,32,9].indexOf(a.which)&&(a.preventDefault(),1===c.length&&b.val("0"+c),e.focus())};d.so=function(){2===this.$("#expMonth").val().length&&this.$("#expYear").focus()};function Kl(){this.Hl=window.pricingPlans}function Ll(){var a=new Kl;return[Object.freeze(y(Ri,a.Hl.paidMonthly)),Object.freeze(y(Ri,a.Hl.paidYearly))]};function Ml(a){this.plan=a.Uo;this.title=a.title;this.pricePerMonthText=a.bp;this.pricePerIntervalText=a.ap;this.summaryText=a.Rp;this.billingCycleText=a.wm}
function Nl(a,b,c){function e(a,c,e){if("MONTHLY"===c)return e?b.format("canvaForWorkUpgradePlanSummaryMonthlyPerUser",a):b.format("canvaForWorkUpgradePlanSummaryMonthly",a);if("YEARLY"===c)return e?b.format("canvaForWorkUpgradePlanSummaryYearlyPerUser",a):b.format("canvaForWorkUpgradePlanSummaryYearly",a);throw Error("unrecognised BillingInterval");}var f=a.slice(0).sort(function(a,b){return Si(b)-Si(a)})[0];return a.map(function(a){var h;if("MONTHLY"===S(a))h=b.format("canvaForWorkUpgradePlanMonthly");
else if("YEARLY"===S(a))h=b.format("canvaForWorkUpgradePlanYearly");else throw Error("unrecognised plan billing interval");var l=e(Math.round(a.rd()/("YEARLY"===S(a)?12:1)*100)/100,"MONTHLY",!!c),m=e(a.rd(),S(a),!!c),q;q=!!c;q="YEARLY"===S(a)?b.format("canvaForWorkUpgradePlanPercentSaving",((Si(f)-Si(a))/Si(f)*100).toFixed(0)/100):e(Si(a),"YEARLY",q);return new Ml({Uo:a,title:h,bp:l,ap:m,Rp:q,wm:"YEARLY"===S(a)?b.format("canvaForWorkUpgradePlanBilledYearly",a.rd()):""})})};function Ol(a){this.body=a.body;this.Of=a.Of;this.Ne=a.Ne;this.delegate=a.delegate;this.Tb=this.af=this.currentTarget=null;this.C=a.C;this.dm=document.createElement("img");this.dm.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw\x3d\x3d";this.Pg=this.Pg.bind(this);this.Qg=this.Qg.bind(this);this.Rg=this.Rg.bind(this);this.Af=this.Af.bind(this);this.Bf=this.Bf.bind(this);this.Zg=this.Zg.bind(this);this.$g=this.$g.bind(this);this.preventDefault=this.preventDefault.bind(this)}
d=Ol.prototype;d.start=function(){this.body.on("mousedown",this.Zg).on("mouseup",this.$g)};d.stop=function(){this.body.off("mousedown",this.Zg).off("mouseup",this.$g);Pl(this)};function Ql(a,b){a.Of.getSources().forEach(function(a){a.element.draggable=b})}function Rl(a,b){var c=null;a.Of.getSources().some(function(a){return a.element===b||$.contains(a.element,b)?(c=a,!0):!1});return c}
function Sl(a,b){var c=null;a.Ne.qf().some(function(a){return a.element===b||$.contains(a.element,b)?(c=a,!0):!1});return c}function Tl(a){a=a.Ne.qf().map(function(a){return a.element});return $(a)}d.Af=function(a){a=a.originalEvent;$(this.Tb).css("left",a.clientX).css("top",a.clientY)};
d.Pg=function(){var a=this.Tb;Pl(this);Ql(this,!1);this.Tb.classList.remove("dragOver");this.currentTarget?(this.currentTarget.element.classList.remove("dragOver"),this.Tb.classList.add("dropped")):P.resolve().then(function(){$(a).remove()});Ul(this.delegate,this.af.value,this.currentTarget?this.currentTarget.value:null,this.currentTarget?this.Tb:null);this.Tb=this.af=this.currentTarget=null};
d.Qg=function(a){var b=a.currentTarget&&Sl(this,a.currentTarget);if(!b)throw Error("unknown drop target entered");a.preventDefault();this.currentTarget=b;this.currentTarget.element.classList.add("dragOver");this.Tb.classList.add("dragOver")};d.Rg=function(a){a=a.currentTarget&&Sl(this,a.currentTarget);if(!a)throw Error("unknown drop target left");a.value===this.currentTarget.value&&(this.currentTarget=null,this.Tb.classList.remove("dragOver"));a.element.classList.remove("dragOver")};
d.preventDefault=function(a){a.preventDefault()};
d.Bf=function(a){function b(){a.originalEvent.dataTransfer&&a.originalEvent.dataTransfer.setDragImage?a.originalEvent.dataTransfer.setDragImage(c.dm,0,0):a.target&&(a.target.classList.add("dragSourceHiddenIEHack"),c.C.setTimeout(function(){a.target.classList.remove("dragSourceHiddenIEHack")},0))}var c=this;if(this.af=a.target&&Rl(this,a.target))b(),this.Tb=this.Of.ke(this.af.value),this.body.append(this.Tb),this.Af(a),Vl(this.delegate),Wl(this);this.body.off("dragstart",this.Bf)};
function Wl(a){var b=Tl(a);a.body.on("dragover",a.Af).on("dragend",a.Pg).on("drop",a.preventDefault);b.on("dragenter",a.Qg).on("dragleave",a.Rg).on("dragover",a.preventDefault);b.find("*").css("pointer-events","none")}function Pl(a){var b=Tl(a);a.body.off("dragover",a.Af).off("dragend",a.Pg).off("drop",a.preventDefault);b.off("dragenter",a.Qg).off("dragleave",a.Rg).off("dragover",a.preventDefault);b.find("*").css("pointer-events","")}d.Zg=function(){Ql(this,!0);this.body.on("dragstart",this.Bf)};
d.$g=function(){Ql(this,!1);this.body.off("dragstart",this.Bf)};function Xl(a,b){this.element=a;this.value=b};function tf(a,b){this.element=a;this.value=b};function Yl(a){this.Sp=a.slice(0)}Yl.prototype.qf=function(){return this.Sp.map(function(a){return a.qf()}).reduce(function(a,b){return a.concat(b)},[])};function V(a){this.wa=a.wa;this.fd=a.fd;this.kd={};this.zb={};this.error=!1;this.ib=a.ib;this.ua=a.ua;this.va=a.va;this.view=a.view}d=V.prototype;d.listenTo=Backbone.Events.listenTo;d.off=Backbone.Events.off;d.on=Backbone.Events.on;d.once=Backbone.Events.once;d.stopListening=Backbone.Events.stopListening;d.trigger=Backbone.Events.trigger;function Zl(a,b){return Vd(a,b.i(),null,b.ownerUser)}
d.init=function(){this.listenTo(this.va,{error:this.Ef,fetch:this.Ua});this.listenTo(this.view,"thumbnailClick",this.Gf);return this};d.remove=function(){this.stopListening()};d.pc=function(){function a(){this.off("fetch",b)}function b(){this.off("error",a);this.pc()}if(!this.error&&this.va.Wb&&!this.va.sd()){var c=this.view.ne();c&&800<=ll(this.ua,c)||(this.once("error",a,this),this.once("fetch",b,this),this.fetch())}};
d.Ge=function(a){var b=W(this,a),c=this.view;c.stopListening(b);c.ea.remove(b.getElement());delete this.kd[a];delete this.zb[a];Object.keys(this.kd).length||this.view.ph();this.trigger("removeDesign")};d.fetch=function(){this.error||!this.va.Wb||this.va.sd()||($l(this.view,!0),this.va.fetch())};d.Ua=function(a){this.va.isEmpty()?this.view.ph():this.push(a);$l(this.view,!1);this.trigger("fetch")};
d.push=function(a){var b=[];a.forEach(function(a){a=this.wa(a);b.push(a);am(this,a)},this);this.view.push.apply(this.view,b)};function am(a,b){var c=b.F.i();a.kd[c]=b;a.we(b);if(a.ib){var e=new Cd;a.zb[c]=e;a.ib.zb.push(e);a=a.fd(b.F);b.Hc=a;e.items.push(a);e.Gg[a.Ba]=a}}d.we=function(){};d.Ef=function(){this.error=!0;this.view.Sf(!0);$l(this.view,!1);this.trigger("error")};
d.Gf=function(a,b){var c=W(this,a),e=this.zb[a],f=e.getItem(a),g=this;c.wh(!0);Od(f,!1).always(function(){c.wh(!1)}).then(function(){g.ib.show(e,a,b)})};function W(a,b){if(a=a.kd[b])return a;throw Error("no DesignCard for design: "+b);};function bm(a){V.call(this,a);this.Ga=a.Ga;this.j=a.j}bm.prototype=Object.create(V.prototype);d=bm.prototype;d.constructor=bm;d.we=function(a){var b=a.F;this.listenTo(a,{editTitle:this.ip.bind(this,b),copy:this.Hm.bind(this,b),trash:this.Pe.bind(this,b)})};
d.Hm=function(a){var b=Ga(this.j),c=a.getName()||b.Wc(),e=a.Oi(),b=b.format("documentCopyDesignTitle",c).substr(0,255),c=a.Ia(),e=je({myRole:Oc,name:b,tags:e,thumbnail:{height:c.Ha(),url:c.fa(),width:c.hb()}}),e=this.wa(e);e.vh(!0);e.nb(!0);this.view.unshift(e);e.nb(!1);this.trigger("copy");a=(new zc).Kh(a.i());a.title=b;this.Ga.duplicate(a).then(this.jj.bind(this,e)).catch(this.Bl.bind(this,e))};d.jj=function(a,b){a.F.id=b.getDocument().i();a.render().vh(!1);am(this,a)};
d.Bl=function(a){var b=this.view;b.stopListening(a);b.ea.remove(a.getElement());window.alert("An error occurred and we weren't able to copy your design.\n\nPlease refresh the page and try again.")};d.Pe=function(a){W(this,a.i()).nb(!0);this.Ga.Wp(a.i()).then(this.qn.bind(this,a)).catch(this.No.bind(this,a))};d.No=function(a){W(this,a.i()).nb(!1);window.alert(Ka(this.j).format("designCardTrashDesignError"))};d.qn=function(a){var b=a.i();W(this,b).nb(!0).then(function(){this.Ge(b)}.bind(this))};
d.ip=function(a,b){var c=a.i(),e=W(this,c);b=b.trim().replace(/\s+/g," ");var f=a.getName();a.name=b;e.Tf(!0);e.render();c=Cc(Bc(c));this.Ga.getDocument(c).then(function(a){var c=a.getDocument();a=this.Ga;var e=c.i(),c=c.getVersion();return A(a.u,a.path+"/"+encodeURIComponent(e)+"/content/title?version\x3d"+c.toString(),{title:b}).return()}.bind(this)).then(this.yo.bind(this,a)).catch(this.xo.bind(this,a,f))};d.yo=function(a){a=a.i();W(this,a).Tf(!1)};
d.xo=function(a,b){var c=W(this,a.i());a.name=b;c.Tf(!1);c.render();window.alert("Oh dear, we weren't able to rename your design.\n\nRefresh the page and try again. If it still doesn't work, email us at support@canva.com.")};function X(){}X=Backbone.View.extend();X.Qd=250;d=X.prototype;d.initialize=function(a){this.ka=a.ka;this.ea=a.ea;this.zd=a.zd};d.events=function(){return{"click .designCardThumbnail":this.Gf}};d.Gf=function(a){if(!(a.ctrlKey||a.metaKey||1<a.which)&&this.zd){a.preventDefault();var b=$(a.currentTarget).closest(".designCard").data("id");a=$(a.currentTarget);this.trigger("thumbnailClick",b,a)}};d.render=function(){this.$el.append(this.ea.$el,this.ka.$el);return this};d.wc=function(){this.ea.wc()};
d.ne=function(){return this.ea.ne()};function cm(a){return 0<a.$(".designCardListEmptyMessage").length}function $l(a,b){b?a.ka.show():a.ka.hide()}d.ph=function(){cm(this)||this.$el.append(this.Gd())};d.Gd=function(){return'\x3cp class\x3d"designCardListEmptyMessage"\x3eNo designs found\x3c/p\x3e'};d.Sf=function(a){var b=this.$(".designCardListEmptyMessage");a?1>b.length&&this.$el.append(this.Hd()):b.remove()};d.Hd=function(){return'\x3cp class\x3d"designCardListErrorMessage"\x3eAn error occurred and we weren\'t able to load any designs\x3c/p\x3e'};
d.push=function(a){var b=Array.prototype.slice.call(arguments,0);0!==b.length&&(b=b.map(function(a){return a.render().getElement()[0]}),this.ea.push($(b)))};d.unshift=function(a){var b=Array.prototype.slice.call(arguments,0);0!==b.length&&(b=b.map(function(a){return a.render().getElement()[0]}),this.ea.unshift($(b)))};function dm(a){this.Td=a.Td||null;this.N=a.N||null;this.ng=a.ng||["SOCIAL","INGESTION_STATUS"];this.Qa=this.empty=!1;this.ma={};this.filter=a.filter||null;this.jf=!0;this.nd=a.nd;this.Wb=!0;this.ub=a.ub;this.Nd=a.Nd;this.cc=a.cc||null;this.dc=a.dc}d=dm.prototype;d.off=Backbone.Events.off;d.on=Backbone.Events.on;d.trigger=Backbone.Events.trigger;d.fetch=function(){function a(){this.Qa=!1}!this.Qa&&this.Wb&&(this.Qa=!0,this.vd().bind(this).finally(a).then(this.Ua).catch(this.Ef))};
function em(a,b){return b.map(function(a){var b=this.ma[a];if(!b)throw Error("could not resolve folder with id "+a);return b},a)}
d.vd=function(){var a=(new mi).ec(this.Td).Yf(this.cc).Bc(this.Nd);a.format=he;a.decorations=this.ng;a.filter=this.filter;a=a.Cc(this.ub).Yc(this.N);switch(this.nd){case 0:var b=this.dc,c=a.O();return b.vd("brands/"+(c?encodeURIComponent(c):"~"),a);case 1:var b=this.dc,c=a.O(),e=a.X();return b.vd("brands/"+(c?encodeURIComponent(c):"~")+"/users/"+(e?encodeURIComponent(e):"~"),a);case 2:return b=this.dc,c=a.X(),b.vd("users/"+(c?encodeURIComponent(c):"~"),a);default:throw Error("unknown folder type "+
this.nd);}};d.Ua=function(a){var b=a.qd(),c=a.ya()||[];this.jf&&(this.empty=0===b.length,this.jf=!1);c.forEach(function(a){this.ma[a.i()]=a},this);this.N=a.ia();this.Wb=!!this.N;this.trigger("fetch",b)};d.Ef=function(){this.trigger("error")};d.isEmpty=function(){return this.empty};d.sd=function(){return this.Qa};function fm(a){Ol.call(this,{body:a.body,Of:a.Pf,Ne:a.Ne,delegate:this,C:a.C});this.analytics=a.analytics;this.Pf=a.Pf;this.Ei=a.Ei;this.Gc=a.Gc||null;this.yh=a.yh||null;this.ee=a.ee||null;this.l=a.l;this.ca=a.ca}fm.prototype=Object.create(Ol.prototype);fm.prototype.constructor=Ol;fm.prototype.listenTo=Backbone.Events.listenTo;fm.prototype.stopListening=Backbone.Events.stopListening;fm.prototype.stop=function(){this.stopListening();Ol.prototype.stop.call(this)};
function Vl(a){a.ee&&a.ee.addClass("dndDimmed");a.Gc&&uf(a.Gc,!0)}function Ul(a,b,c,e){var f=!1;a.Gc&&uf(a.Gc,!1);a.ee&&a.ee.removeClass("dndDimmed");c&&c instanceof Yf?f=gm(a,b,c):c&&-1<_.values(fi).indexOf(c)&&(f=hm(a,b,c));f?P.delay(300).then(function(){e.remove()}):(a.analytics.track("design_card_drag",{failed:!0}),e&&e.remove())}
function gm(a,b,c){function e(a,e,l){e.i()===b.i()&&l.i()===c.i()&&(a?this.Pf.Sd(e.i(),l):window.alert(this.ca.format("designFolderListAddToFolderError")),this.stopListening(this.l,f))}if(c.i()===a.Ei)return!1;var f={"addToFolder:success":e.bind(a,!0),"addToFolder:fail":e.bind(a,!1)};a.Gc&&a.Gc.kf(c);a.listenTo(a.l,f);im(a.l,b,c);a.analytics.track("design_card_drag",{destination:"design_folder"});return!0}
function hm(a,b,c){if("/designs/trash"===c)a.yh&&a.yh.kf(),a.Pf.Pe(je({id:b.i()})),a.analytics.track("design_card_drag",{destination:"trashed"});else return!1;return!0};function jm(a){bm.call(this,{wa:a.wa,Ga:a.Ga,ua:a.ua,va:a.Jh,view:a.view,j:a.j});this.l=a.l||null;this.Jh=a.Jh;this.Lf=a.Lf}jm.prototype=Object.create(bm.prototype);d=jm.prototype;d.constructor=jm;function km(a,b,c,e){return new ed({analytics:c,Vb:hd.bind(null,e),Fa:lm.bind(null,a,e),j:a,Ke:b.cf(),Nf:!0,Ld:!!b.Ra.get(fc),F:e})}function lm(a,b){return new wd({df:b.getName()||Ga(a).Wc(),ta:Ka(a),nh:!0,sh:!0})}
d.getSources=function(){return _.values(this.kd).map(function(a){var b=a.F,c=b.Ia(),b=ig({id:b.i(),thumbnail:{height:c.Ha(),url:c.fa(),width:c.hb()},type:"DESIGN"});return new Xl(a.view.Ia()[0],b)})};d.ke=function(a){a=W(this,a.i());return $(this.si({thumbnailUrl:a.F.Ia().fa()}))[0]};
d.Ua=function(a){function b(a){if(a.ya()){var b=a.ya().filter(c,this);b&&(a=W(this,a.i()),b=em(this.Jh,b),a.Dh(b))}}function c(a){try{return this.l.Z(a),!0}catch(b){return!1}}V.prototype.Ua.call(this,a);this.l&&a.forEach(b,this);this.Lf&&a.length?this.view.Lf():mm(this.view)};d.Ge=function(a){V.prototype.Ge.call(this,a);_.values(this.kd).length||mm(this.view)};d.Sd=function(a,b){W(this,a).gc(b)};d.si=_.template('\x3cdiv class\x3d"dragDesign" style\x3d"background-image:url(\'\x3c%- thumbnailUrl %\x3e\')"\x3e\x3c/div\x3e');function nm(){}nm=X.extend({className:"homeDesigns"});nm.create=function(a,b,c,e){var f=(new C).render(),g=new H({bb:function(a){return Math.floor(a/X.Qd)}});return new nm({Jb:a,ka:f,dl:nm.nn,Yi:b,ea:g,Oj:c,Ta:e})};nm.nn=function(){var a=parseInt($("#page").css("paddingBottom"),10)+parseInt($("#page").css("paddingTop"),10),b=$("#yourDesigns"),b=parseInt(b.css("paddingBottom"),10),c=K.Zf;return $(window).height()-c-a-b};d=nm.prototype;
d.events=function(){return _.extend(X.prototype.events.call(this),{"click .importifyButton":this.trigger.bind(this,"import")})};d.initialize=function(a){X.prototype.initialize.call(this,{ka:a.ka,ea:a.ea,zd:!1});this.Jb=a.Jb;this.Yi=a.Yi;this.dl=a.dl;this.Oj=a.Oj;this.Ta=a.Ta};
d.Gd=function(){var a="en"==this.Jb.user.nf();return this.Yi?this.To({yourFirstDesign:this.Ta.mm(),everything:this.Ta.format("homeDesignEverythingYouDesignWillAppearHerePersonal","\x3cstrong\x3e","\x3c/strong\x3e"),importPersonalDesigns:this.Ta.Ri(),showAlternativeText:a,irresistibleFacebookPost:this.Ta.ql('\x3ca target\x3d"_blank" href\x3d"https://www.youtube.com/watch?v\x3dA5piiEQ2ydI"\x3e',"\x3c/a\x3e")}):this.Tp({showImportButton:this.Oj,yourFirstDesign:this.Ta.mm(),everything:this.Ta.format("homeDesignEverythingYouDesignWillAppearHereTeam",
"\x3cstrong\x3e","\x3c/strong\x3e",'\x3ca href\x3d"/brand"\x3e',"\x3c/a\x3e"),importPersonalDesigns:this.Ta.Ri(),showAlternativeText:a,irresistibleFacebookPost:this.Ta.ql('\x3ca target\x3d"_blank" href\x3d"https://www.youtube.com/watch?v\x3dA5piiEQ2ydI"\x3e',"\x3c/a\x3e")})};d.Lf=function(){this.$(".importifyButton").length||this.ne().append($(this.tn({importPersonalDesigns:this.Ta.Ri()})))};function mm(a){a.$(".importify.importifyButton").remove()}d.To=_.template('\x3cdiv class\x3d"designCardListEmptyMessage homeDesignsEmptyContainer"\x3e\x3cdiv class\x3d"homeDesignsEmptyMessage"\x3e\x3ch2\x3e\x3c%- yourFirstDesign %\x3e\x3c/h2\x3e\x3cp\x3e\x3c%\x3d everything %\x3e\x3c/p\x3e\x3c% if (showAlternativeText) { %\x3e\x3cp class\x3d"homeDesignAlternativeText"\x3e\x3c%\x3d irresistibleFacebookPost %\x3e\x3c/p\x3e\x3c% } %\x3e\x3c/div\x3e\x3c/div\x3e');
d.Tp=_.template('\x3cdiv class\x3d"designCardListEmptyMessage homeDesignsEmptyContainer"\x3e\x3cdiv class\x3d"homeDesignsEmptyMessage homeDesignsTeamEmpty"\x3e\x3ch2\x3e\x3c%- yourFirstDesign %\x3e\x3c/h2\x3e\x3cp\x3e\x3c%\x3d everything %\x3e\x3c/p\x3e\x3c% if (showImportButton) { %\x3e\x3cbutton class\x3d"button buttonBlock importifyButton"\x3e\x3c%- importPersonalDesigns %\x3e\x3c/button\x3e\x3c% } %\x3e\x3c% if (showAlternativeText) { %\x3e\x3cp class\x3d"homeDesignAlternativeText"\x3e\x3c%\x3d irresistibleFacebookPost %\x3e\x3c/p\x3e\x3c% } %\x3e\x3c/div\x3e\x3c/div\x3e');
d.Hd=function(){return _.template('\x3cp class\x3d"designCardListErrorMessage"\x3e\x3c%- error %\x3e\x3c/p\x3e')({error:this.Ta.error()})};d.tn=_.template('\x3cbutton class\x3d"importify importifyButton"\x3e\x3cspan class\x3d"importifyButtonText"\x3e\x3c%- importPersonalDesigns %\x3e\x3c/span\x3e\x3c/button\x3e');var T="virtual-homedesigns",rj="virtual-shareddesigns",sj="virtual-teamstream",tj="virtual-trasheddesigns",uj="virtual-designstream",xj="special-createadesign";function Y(a){var b=this;this.R=a.R;this.la=a.la;this.nl=a.nl;this.view=a.view;this.listenTo(this.la,{fetch:function(){return om(b.view)},removeDesign:function(){return om(b.view)}})}Y.prototype.init=function(){this.la.init();return this};Y.prototype.remove=function(){this.stopListening()};Y.prototype.pc=function(){this.la.pc()};
Object.defineProperties(Y.prototype,{bk:{configurable:!0,enumerable:!0,get:function(){return!1}}});d=Y.prototype;d.listenTo=Backbone.Events.listenTo;d.stopListening=Backbone.Events.stopListening;d.trigger=Backbone.Events.trigger;d.off=Backbone.Events.off;d.on=Backbone.Events.on;function Z(a){var b=this;Backbone.View.call(this);this.R=a.R;this.Sa=a.Sa||null;this.pa=a.pa;this.Ja=a.Ja;this.listenTo(this.pa,{"import":function(){return b.trigger("import")}})}k(Z,Backbone.View);Z.prototype.remove=function(){this.Sa&&this.Sa.remove();this.pa.remove();Backbone.View.prototype.remove.call(this)};Z.prototype.wc=function(){this.pa.wc()};
Z.prototype.uc=function(){if(this.R===T)return this.Ja.format("homeTitleYourDesigns");if(this.R===rj)return this.Ja.format("homeTitleSharedWithYou");if(this.R===sj)return this.Ja.format("homeTitleTeamStream");if(this.R===tj)return this.Ja.format("homeTitleTrashedDesigns");if(this.R===uj)return this.Ja.nc();throw Error("Cannot match title for "+this.id);};Z.prototype.Ml=function(){return this.Sa?this.Sa.render().$el.add(this.pa.render().$el):this.pa.render().$el};
function om(a){a.Sa&&a.Sa.cm&&a.Sa.cm(!cm(a.pa))};function pm(a){var b=this;Y.call(this,a);this.ei=a.ei;this.la=a.la;this.listenTo(this.la,"fetch",function(){return b.trigger("fetch")});this.listenTo(this.view,"import",this.Cp)}k(pm,Y);d=pm.prototype;d.getSources=function(){return this.la.getSources()};d.ke=function(){return this.la.ke.apply(this.la,arguments)};d.Pe=function(a){this.la.Pe(a)};d.Sd=function(a,b){this.la.Sd(a,b)};d.Cp=function(){var a=this,b=this.ei();b.show();this.listenTo(b,{"import":function(b){return a.trigger("import",b)}})};
Object.defineProperties(pm.prototype,{bk:{configurable:!0,enumerable:!0,get:function(){return!0}}});function qm(a){var b=this;Y.call(this,a);this.la=a.la;this.nc=a.nc;this.ib=a.ib;this.listenTo(this.view,"designStreamClick",function(a,e){return b.ib.show(b.nc,a,e)})}k(qm,Y);qm.prototype.init=function(){return this};qm.prototype.pc=function(){this.la.fetch()};function rm(a){Z.call(this,a);this.pa=a.pa}k(rm,Z);rm.prototype.remove=function(){};rm.prototype.Ml=function(){var a=this,b=this.pa.render().getElement();b.on("click",".designCardThumbnail",function(b){if(!(b.metaKey||b.ctrlKey||1<b.which)){var e=$(b.target),f=e.closest("figure").data("id");a.trigger("designStreamClick",f,e);b.preventDefault()}});return b};function sm(){}sm=Backbone.View.extend({className:"sharedDesignsHeader tabHeader",tagName:"section"});sm.create=function(a){return new sm({Kb:a})};sm.prototype.initialize=function(a){this.Kb=a.Kb};sm.prototype.render=function(){this.$el.html(this.template({title:this.Kb.title()}));return this};sm.prototype.template=_.template('\x3cdiv class\x3d"tabHeaderRow lead"\x3e\x3cdiv class\x3d"tabHeaderTitle"\x3e\x3cspan\x3e\x3c%- title %\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e');function tm(a){V.call(this,{wa:a.wa,ua:a.ua,va:a.va,view:a.view})}tm.prototype=Object.create(V.prototype);tm.prototype.constructor=tm;function um(a,b){return new ed({Vb:function(){switch(b.myRole){case Oc:case "EDITOR":return hd(b);case "REMIXER":return{href:G(b.i(),"remix"),sj:!0};case "VIEWER":return id(b);default:throw Error("unknown role: "+b.myRole);}},lb:b.ownerUser,Uc:!0,F:b,j:a})}tm.prototype.Ua=function(a){a=a.filter(function(a){return a.myRole!==Oc});V.prototype.Ua.call(this,a)};function vm(a){dm.call(this,{Td:a.Td,nd:1,ub:a.ub,Nd:"/designs/sharedwith",cc:a.cc,dc:a.dc})}vm.prototype=Object.create(dm.prototype);vm.prototype.constructor=vm;vm.prototype.Ua=function(a){var b=a.qd();a=ei({continuation:a.ia(),items:b.filter(function(a){return a.myRole!=Oc}).map(function(a){var b=a.Cg();b&&(a.latestComment=ie(b));return a})});dm.prototype.Ua.call(this,a)};function wm(){}wm=X.extend();wm.create=function(a){var b=(new C).render(),c=new H({bb:function(a){return Math.floor(a/X.Qd)}});return new wm({ka:b,ea:c,Kb:a})};wm.prototype.initialize=function(a){this.Kb=a.Kb;X.prototype.initialize.call(this,{ka:a.ka,ea:a.ea,zd:!1})};wm.prototype.Gd=function(){return _.template('\x3cp class\x3d"designCardListEmptyMessage"\x3e\x3c%- empty %\x3e\x3c/p\x3e')({empty:this.Kb.an()})};wm.prototype.Hd=function(){return _.template('\x3cp class\x3d"designCardListErrorMessage"\x3e\x3c%- error %\x3e\x3c/p\x3e')({error:this.Kb.error()})};function xm(a){V.call(this,{wa:a.wa,fd:a.fd,ib:a.ib,ua:a.ua,va:a.va,view:a.view});this.analytics=a.analytics}xm.prototype=Object.create(V.prototype);xm.prototype.constructor=xm;function ym(a,b,c,e){return new ed({v:a,Vb:id.bind(null,e),lb:e.ownerUser,Je:!0,Le:!0,Uc:!0,F:e,Y:b,j:c})}xm.prototype.init=function(){V.prototype.init.call(this);this.listenTo(this.view,"thumbnailClick",function(){this.analytics.track("team_stream_click")});return this};
xm.prototype.we=function(a){this.listenTo(a,"comment",function(){this.analytics.track("team_stream_comment")})};function zm(){}zm=X.extend({className:"teamStreamList"});zm.create=function(a){var b=(new C).render(),c=new H({bb:function(a){return Math.floor(a/X.Qd)}});return new zm({ka:b,ea:c,Vc:a})};zm.prototype.initialize=function(a){X.prototype.initialize.call(this,{ka:a.ka,ea:a.ea,zd:!0});this.Vc=a.Vc};zm.prototype.Gd=function(){return['\x3cp class\x3d"designCardListEmptyMessage"\x3e',this.Vc.format("teamStreamNoDesignsPublished"),"\x3c/p\x3e"].join("")};
zm.prototype.Hd=function(){return['\x3cp class\x3d"designCardListErrorMessage"\x3e',this.Vc.gf(),"\x3c/p\x3e"].join("")};function Am(a){Backbone.View.call(this,{el:a.el})}k(Am,Backbone.View);Am.prototype.cm=function(a){this.$el.toggleClass("showDescription",a)};var Bm=_.template('\n  \x3csection class\x3d"trashedDesignsHeader tabHeader"\x3e\n    \x3cdiv class\x3d"tabHeaderRow lead"\x3e\n      \x3cdiv class\x3d"tabHeaderTitle"\x3e\x3cspan\x3e\x3c%- title %\x3e\x3c/span\x3e\x3c/div\x3e\n    \x3c/div\x3e\n    \x3cdiv class\x3d"tabHeaderRow secondary"\x3e\n      \x3cdiv class\x3d"tabHeaderDescription"\x3e\x3cspan\x3e\x3c%- description %\x3e\x3c/span\x3e\x3c/div\x3e\n    \x3c/div\x3e\n  \x3c/section\x3e\n');function Cm(a){V.call(this,a);this.Ga=a.Ga;this.Wa=a.Wa}k(Cm,V);function Dm(a,b,c){return new ed({analytics:b,Vb:hd.bind(null,c),Ud:!0,Fa:Em.bind(null,a,c),F:c,j:a})}function Em(a,b){return new wd({df:b.getName()||Ga(a).Wc(),ta:Ka(a),Wj:!0,Qj:!0})}d=Cm.prototype;d.we=function(a){this.listenTo(a,{restore:this.np.bind(this,a.F),deleteForever:this.Rm.bind(this,a.F)})};
d.np=function(a){var b=W(this,a.i()),c=this.Ga,e=a.i();A(c.u,c.path+"/"+encodeURIComponent(e)+"?untrash",null).return().then(this.zo.bind(this,a)).catch(this.Ao.bind(this,a));b.nb(!0)};d.zo=function(a){W(this,a.i()).nb(!0).then(function(){this.Ge(a.i())}.bind(this))};d.Ao=function(a){W(this,a.i()).nb(!1);window.alert(this.Wa.format("trashedDesignsRestoreDesignError"))};
d.Rm=function(a){var b=W(this,a.i());window.confirm(this.Wa.format("trashedDesignsDeleteDesignConfirmation",a.getName()))&&(this.Ga.delete(a.i()).then(this.bo.bind(this,a)).catch(this.co.bind(this,a)),b.Rf(!0))};d.bo=function(a){W(this,a.i()).Rf(!0).then(function(){this.Ge(a.i())}.bind(this))};d.co=function(a){W(this,a.i()).Rf(!1);window.alert(this.Wa.format("trashedDesignsDeleteDesignError"))};function Fm(a){X.call(this,_.extend({tagName:"section",className:"designStream"},a))}k(Fm,X);function Gm(a){var b=(new C).render(),c=new H({bb:function(a){return Math.floor(a/X.Qd)}});return new Fm({ka:b,ea:c,Wa:a})}Fm.prototype.initialize=function(a){X.prototype.initialize.call(this,a);this.Wa=a.Wa};
Fm.prototype.Gd=function(){return _.template('\n      \x3cdiv class\x3d"designCardListEmptyMessage trashedDesignsEmptyContainer"\x3e\n        \x3cdiv class\x3d"trashedDesignsEmptyMessage"\x3e\n          \x3ch2\x3e\x3c%- emptyTitle %\x3e\x3c/h2\x3e\n          \x3cp\x3e\x3c%- emptyBody %\x3e\x3c/p\x3e\n        \x3c/div\x3e\n      \x3c/div\x3e\n    ')({emptyTitle:this.Wa.bn(),emptyBody:this.Wa.$m()})};Fm.prototype.Hd=function(){return _.template('\x3cp class\x3d"designCardListErrorMessage"\x3e\x3c%- error %\x3e\x3c/p\x3e')({error:this.Wa.gf()})};function Hm(a){this.el=a.el;this.C=a.C;this.qk=a.qk}Hm.prototype.qf=function(){return[new tf(this.el,this.qk)]};Hm.prototype.kf=function(){var a=this;this.el.classList.add("flashFolder");this.C.setTimeout(function(){return a.el.classList.remove("flashFolder")},800)};function Im(){}Im=Backbone.View.extend({tagName:"ul",className:"textIconList"});Im.prototype.initialize=function(a){this.items=a.items};Im.prototype.render=function(){this.$el.html(this.items.map(this.Zi).join(""));return this};Im.prototype.Zi=_.template('\x3cli class\x3d"textIconItem"\x3c% if (icon) { %\x3e data-icon\x3d"\x3c%- icon %\x3e"\x3c% } %\x3e\x3e\x3ch3\x3e\x3c%- title %\x3e\x3c/h3\x3e\x3c% if (isHtml) { %\x3e\x3c%\x3d content %\x3e\x3c% } else { %\x3e\x3cp\x3e\x3c%- content %\x3e\x3c/p\x3e\x3c% } %\x3e\x3c/li\x3e');
Im.Lm=function(a){return new Im({items:[{title:Cb(a),content:a.format("canvaForWorkUpgradeTeamBrandKitsDescription"),icon:"teamBrandKits",isHtml:!1},{title:Db(a),content:a.format("canvaForWorkUpgradeLayoutCreatorsDescription"),icon:"layoutCreators",isHtml:!1},{title:Eb(a),content:a.format("canvaForWorkUpgradeMagicallyResizeDescription"),icon:"magicResize",isHtml:!1},{title:Fb(a),content:a.format("canvaForWorkUpgradePhotoFoldersDescription"),icon:"photoFolders",isHtml:!1}]})};
Im.Dq=function(a){return new Im({items:[{title:Cb(a),content:a.format("canvaForWorkUpgradeTeamBrandKitsShortDescription"),icon:"teamBrandKits",isHtml:!1},{title:Eb(a),content:a.format("canvaForWorkUpgradeMagicallyResizeShortDescription"),icon:"magicResize",isHtml:!1},{title:Db(a),content:a.format("canvaForWorkUpgradeLayoutCreatorsShortDescription"),icon:"layoutCreators",isHtml:!1},{title:Fb(a),content:a.format("canvaForWorkUpgradePhotoFoldersShortDescription"),icon:"photoFolders",isHtml:!1}]})};function Jm(){}Jm=Backbone.View.extend({className:"priceOptions",tagName:"ul"});d=Jm.prototype;d.initialize=function(a){this.Ed=a.Ed};d.events=function(){return{click:this.Cm}};d.render=function(){this.$el.html(this.Ed.map(this.cp).join(""));return this};d.Cm=function(a){a=$(a.target).closest("li");Km(this,a.index())};
function Km(a,b){a.$(".priceOption--selected").removeClass("priceOption--selected");0<=b&&b<a.Ed.length&&(a.$("li").eq(b).addClass("priceOption--selected"),a.$("li").eq(b).find("input").prop("checked",!0),a.trigger("selectPlan",a.Ed[b].plan))}d.Nj=function(){function a(a){switch(S(a)){case "MONTHLY":return a.rd();case "YEARLY":return Si(a);default:throw Error("unknown billing interval");}}var b=[].concat(this.Ed).sort(function(b,e){return a(b.plan)-a(e.plan)}),b=this.Ed.indexOf(b[0]);Km(this,b)};
d.cp=_.template('\x3cli class\x3d"priceOption"\x3e\x3cinput name\x3d"priceOptionPlan" type\x3d"radio"\x3e\x3cspan class\x3d"priceOptionTitle"\x3e\x3c%- title %\x3e\x3c/span\x3e\x3cspan class\x3d"priceOptionPricePerBillingInterval"\x3e\x3c%- pricePerIntervalText %\x3e\x3c/span\x3e\x3cspan class\x3d"priceOptionPricePerMonth"\x3e\x3c%- pricePerMonthText %\x3e\x3c/span\x3e\x3cspan class\x3d"priceOptionSummary"\x3e\x3c%- summaryText %\x3e\x3c/span\x3e\x3cspan class\x3d"priceOptionBillingCycle"\x3e\x3c%- billingCycleText %\x3e\x3c/span\x3e\x3c/li\x3e');function Lm(){}Lm=Backbone.View.extend({className:"teamBillingSignup"});d=Lm.prototype;d.events=function(){return{"click .teamBillingCreditCardRevert":this.trigger.bind(this,"revert"),"click .teamBillingCreditCardSubmit":this.trigger.bind(this,"submit"),"click .teamBillingRetryButton":this.trigger.bind(this,"retry")}};
d.initialize=function(a){this.compact=a.compact;this.If=a.If;this.listenTo(this.If,"selectPlan",this.trigger.bind(this,"selectPlan"));this.ep=Im.Lm(Wa(a.j));this.wb=a.wb;this.j=a.j;this.mb=lb(a.j);this.fb=a.fb};
d.render=function(){var a=moment().add(this.wb,"days").format("MMMM Do, YYYY"),b;b=this.j;b.ek||(b.ek=new Sb(b.qa));b=b.ek;this.fb&&this.$el.addClass("teamBillingSignup--variant");this.$el.html(this.template({compact:this.compact,claimHtml:this.fb?this.mb.Fh(this.wb):this.mb.Am(this.wb),createTrialPeriodPoint1Html:this.fb?b.format("teamUpgradeCreateTrialPeriodPoint1V"):b.Nm(a),createTrialPeriodPoint2Html:this.fb?b.format("teamUpgradeCreateTrialPeriodPoint2V",a):b.format("teamUpgradeCreateTrialPeriodPoint2"),
createTrialPeriodPoint3Html:this.fb?b.format("teamUpgradeCreateTrialPeriodPoint3V"):b.Om(),encryption:this.mb.cn(),itemsTitle:this.mb.yn(),revertCard:this.mb.sp(),startTrial:this.mb.Lp()}));this.compact||this.ep.render().$el.appendTo(this.$(".teamBillingPromoItems"));this.If.render().$el.appendTo(this.$(".teamBillingPriceOptions"));return this};d.Nj=function(){this.If.Nj()};d.Zb=function(a){this.$(".teamBillingCreditCardSubmit").removeClass("buttonSpinner");alert(a)};
d.Me=function(a){a=void 0===a?"":a;this.$(".teamBillingTotalText").html(a)};function Mm(a,b){a=a.$(".teamBillingCreditCardRevert");b?a.show():a.hide()}d.Ie=function(a){this.$el.toggleClass("enabled",a)};d.template=_.template('\x3cdiv class\x3d"teamBillingOptionsContainer"\x3e\x3cdiv class\x3d"teamBillingOptions"\x3e\x3cdiv class\x3d"teamBillingInformation"\x3e\x3ch2\x3e\x3c%\x3d claimHtml %\x3e\x3c/h2\x3e\x3cul\x3e\x3cli\x3e\x3c%\x3d createTrialPeriodPoint1Html %\x3e\x3c/li\x3e\x3cli\x3e\x3c%\x3d createTrialPeriodPoint2Html %\x3e\x3c/li\x3e\x3cli\x3e\x3c%\x3d createTrialPeriodPoint3Html %\x3e\x3c/li\x3e\x3c/ul\x3e\x3c/div\x3e\x3cdiv class\x3d"teamBillingPriceOptions"\x3e\x3c/div\x3e\x3cdiv class\x3d"teamBillingForm"\x3e\x3cdiv class\x3d"teamBillingCreditCardContainer"\x3e\x3cdiv class\x3d"teamBillingTotalText"\x3e\x3c/div\x3e\x3cbutton class\x3d"button buttonBlock teamBillingCreditCardSubmit"\x3e\x3cspan class\x3d"spinner"\x3e\x3c/span\x3e\x3c%- startTrial %\x3e\x3c/button\x3e\x3cbutton class\x3d"button buttonBlock buttonPlain teamBillingCreditCardRevert"\x3e\x3c%- revertCard %\x3e\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cp class\x3d"teamBillingSecurityMessage"\x3e\x3c%- encryption %\x3e\x3c/p\x3e\x3c/div\x3e\x3c% if (!compact) { %\x3e\x3cdiv class\x3d"teamBillingPromoItems"\x3e\x3ch4\x3e\x3c%- itemsTitle %\x3e\x3c/h4\x3e\x3c/div\x3e\x3c% } %\x3e');
d.pp=_.template('\x3cp class\x3d"teamBillingRetry"\x3e\x3c%- billingError %\x3e\x3cbr/\x3e\x3cbutton class\x3d"button teamBillingRetryButton"\x3e\x3c%- tryAgain %\x3e\x3c/button\x3e\x3c/p\x3e');function Nm(a){this.analytics=a.analytics;this.gg=a.gg;this.aa=a.aa;this.G=a.G;this.xf=null;this.vl=!1;this.Ea=null;this.jc=a.jc;this.listenTo(this.jc,{input:this.Yn,requestSubmit:this.bh});this.He=null;this.Yj=a.Yj;this.Oh=a.Oh||null;this.j=a.j;this.view=a.view;this.listenTo(this.view,{selectPlan:this.aq,retry:this.Bo,revert:this.Co,submit:this.bh})}d=Nm.prototype;d.listenTo=Backbone.Events.listenTo;d.on=Backbone.Events.on;d.once=Backbone.Events.once;d.off=Backbone.Events.off;d.stopListening=Backbone.Events.stopListening;
d.trigger=Backbone.Events.trigger;function Om(a){var b=a.wj.slice(0).sort(function(a,b){return Si(b)-Si(a)}),b=new Jm({Ed:Nl(b,Wa(a.j),a.fb)});return new Lm({compact:a.compact,If:b,j:a.j,wb:a.wb||0<a.wj.length&&a.wj[0].Pi()||30,fb:a.fb})}d.appendTo=function(a){this.view.render().$el.appendTo(a);this.view.Nj();Mm(this.view,!1);this.jc.render();this.jc.getElement().prependTo(this.view.$(".teamBillingCreditCardContainer"))};d.remove=function(){this.stopListening();this.jc.remove();this.view.remove()};
d.Ie=function(a){this.view.Ie(a)};function Pm(a){function b(a){return 404===a}var c=a.G.i();a.Ie(!1);(function(){return a.Oh?P.resolve(a.Oh):ui(a.gg,c).catch(b,function(){return si({})})})().bind(a).then(function(a){a.Ag()&&(this.Ea=a.Ag(),this.jc.lh(!0).Jd(this.Ea))}).catch(function(){var a=this.view;a.$el.html(a.pp({billingError:a.mb.xm(),tryAgain:a.mb.Zp()}))}).finally(function(){this.Ie(!0)})}
function Qm(a){var b=qh().ec(a.G.i());a.aa.hf(b).bind(a).then(function(a){this.xf=a.getCount();this.Me()}).catch(function(){this.vl=!0;this.Me()})}
d.Me=function(){ma(null!=this.He,"A plan must be selected");var a=lb(this.j);if(this.vl)a=this.view,a.$(".teamBillingTotalText").text(a.mb.format("teamBillingSignupTotalPriceError"));else if(null!==this.xf)if(1===this.xf)this.view.Me();else{var b=this.He.rd()*this.xf;if("YEARLY"===S(this.He))b=a.format("teamBillingSignupPerYear",b);else if("MONTHLY"===S(this.He))b=a.format("teamBillingSignupPerMonth",b);else throw Error("unrecognised billing interval");a=a.format("teamBillingSignupTotalPrice",this.xf,
b);this.view.Me(a)}};d.Yn=function(a){this.Ea&&Mm(this.view,a)};d.Bo=function(){Pm(this)};d.Co=function(){this.Ea&&(this.jc.Jd(this.Ea),Mm(this.view,!1))};
d.bh=function(){this.Ie(!1);this.view.$(".teamBillingCreditCardSubmit").toggleClass("buttonSpinner",!0);this.jc.mn().bind(this).then(function(){if(!this.Yj){var a=(new Ti).ec(this.G.i()),b=this.He.i();a.plan=b;return this.gg.bq(a)}}).then(function(a){var b=this.analytics;b.ga&&b.ga("send","event",{eventCategory:"Subscription",eventAction:"Upgraded"});this.trigger("signup",a)}).catch(U,function(a){this.analytics.track("upgrade_onboarding_card_error",{message:a.message});a=yl(Ya(this.j),a);this.view.Zb(a)}).catch(function(){this.view.Zb("An error occured while trying to subscribe")}).finally(function(){this.Ie(!0)});
this.analytics.track("upgrade_onboarding_card_submit")};d.aq=function(a){this.He=a;this.Me()};function Rm(){}Rm=Backbone.View.extend({className:"promotion"});Rm.prototype.initialize=function(a){this.eh=a.eh;this.Cj=a.Cj||"";this.Kl=a.Kl||"";this.pb=a.pb||""};Rm.prototype.events=function(){return{"click .promoActions button":this.trigger.bind(this,"next")}};Rm.prototype.render=function(){this.$el.html(this.template({promoHeaderHtml:this.Kl,promoIntroHtml:this.Cj,buttonText:this.pb}));this.eh&&this.eh.render().$el.appendTo(this.$(".promoContent"));return this};Rm.prototype.template=_.template('\x3c% if (promoHeaderHtml) { %\x3e\x3cdiv class\x3d"promoHeader"\x3e\x3c%\x3d promoHeaderHtml %\x3e\x3c/div\x3e\x3c% } %\x3e\x3cdiv class\x3d"promoBody"\x3e\x3c% if (promoIntroHtml) { %\x3e\x3cdiv class\x3d"promoIntro"\x3e\x3c%\x3d promoIntroHtml %\x3e\x3c/div\x3e\x3c% } %\x3e\x3cdiv class\x3d"promoContent"\x3e\x3c/div\x3e\x3c% if (buttonText) { %\x3e\x3cdiv class\x3d"promoActions"\x3e\x3cbutton class\x3d"button"\x3e\x3c%- buttonText %\x3e\x3c/button\x3e\x3c% } %\x3e\x3c/div\x3e');function Sm(){}Sm=Backbone.View.extend({className:"promotionVideo promotion"});Sm.prototype.initialize=function(a){this.km=a.km;this.Jl=a.Jl||"";this.pb=a.pb||""};Sm.prototype.events=function(){return{"click .promoActions button":this.trigger.bind(this,"next")}};Sm.prototype.render=function(){this.$el.html(this.template({promoHeaderHtml:this.Jl,buttonText:this.pb,videoId:this.km}));return this};Sm.prototype.template=_.template('\x3c% if (promoHeaderHtml) { %\x3e\x3cdiv class\x3d"promoHeader"\x3e\x3c%\x3d promoHeaderHtml %\x3e\x3c/div\x3e\x3c% } %\x3e\x3cdiv class\x3d"promoBody"\x3e\x3cdiv class\x3d"promoContent"\x3e\x3ciframe class\x3d"promoVideo" type\x3d"text/html" width\x3d"650" height\x3d"369" src\x3d"https://www.youtube.com/embed/\x3c%- videoId %\x3e?autoplay\x3d1\x26modestbranding\x3d1\x26controls\x3d2\x26rel\x3d0\x26loop\x3d1" frameborder\x3d"0" allowfullscreen\x3d"false"/\x3e\x3c/div\x3e\x3c% if (buttonText) { %\x3e\x3cdiv class\x3d"promoActions"\x3e\x3cbutton class\x3d"button"\x3e\x3c%- buttonText %\x3e\x3c/button\x3e\x3c% } %\x3e\x3c/div\x3e');function Yc(a){this.C=a.C;this.element=$(this.template());this.element.addClass(Tm(a.style));this.element.on("click",".modalContentMask",function(a){this.trigger("maskClick",a)}.bind(this));this.style=a.style;this.ag=""}d=Yc.prototype;d.off=Backbone.Events.off;d.on=Backbone.Events.on;d.trigger=Backbone.Events.trigger;
function Tm(a){switch(a){case Zc:return"modalContentBlurAndDarken";case ad:return"modalContentDarken";case Um:return"modalContentClear";case Vm:return"modalContentNone";default:throw Error();}}d.hide=function(){$("body").removeClass(this.ag).attr("data-modal-levels",$("body").attr("data-modal-levels")-1);"0"===$("body").attr("data-modal-levels")&&$("body").css("margin-right","");this.element.removeClass("modalContentOn");this.C.setTimeout(function(){this.element.detach()}.bind(this),300)};
d.show=function(a){this.element.children(":not(.modalContentMask)").remove();this.element.append(a).appendTo("body");Xb(function(){var a=this,c=parseInt($("body").attr("data-modal-levels"),10)||0,e=window.innerWidth-$(window).width();$("body").attr("data-modal-levels",c+1);0===c&&$("body").css("margin-right",e);this.element.addClass("modalContentOn");["modalContentVisible",Tm(this.style)+"Visible"].forEach(function(c){$("body").hasClass(c)||(a.ag+=c+" ")});$("body").addClass(this.ag)}.bind(this))};
d.template=_.template('\x3cdiv class\x3d"modalContent"\x3e\x3cdiv class\x3d"modalContentMask"\x3e\x3c/div\x3e\x3c/div\x3e');var Zc="BLUR_AND_DARKEN",ad="DARKEN",Um="CLEAR",Vm="NONE";function Wm(){}Wm=Backbone.View.extend({className:"multipageDialog"});d=Wm.prototype;d.initialize=function(a){this.C=x;this.mg=0;this.yi=a.yi||[];this.hc=void 0===a.hc||a.hc;this.Lb=!!a.Lb;this.ze=new Yc({C:this.C,style:Zc});this.Dd=a.Dd;this.Dd.forEach(function(a){this.listenTo(a,"next",this.Fp);this.listenTo(a,"back",this.Gp)},this)};d.events=function(){return{click:this.Ad,"click .dialogMaskCloseButton":this.hide}};
d.hide=function(){this.$el.addClass("multipageDialogDisappearing");this.ze.hide();this.C.setTimeout(function(){this.trigger("hide")}.bind(this),300)};d.Ad=function(a){$(a.target).is(".multipageDialogPage, .multipageDialogPageWrapper")&&this.hc&&this.hide()};
d.render=function(){var a=this;(function(){a.yi.forEach(function(b){a.$el.addClass(b)})})();(function(){a.Dd.forEach(function(a){a.$el.detach()});a.$el.empty()})();a.Lb&&a.$el.append('\x3cbutton class\x3d"buttonLink dialogMaskCloseButton"\x3eClose\x3c/button\x3e');(function(){a.Dd.forEach(function(b){var c,e;c=$("\x3cdiv\x3e").addClass("multipageDialogPageWrapper");e=$("\x3cdiv\x3e").addClass("multipageDialogPage");c.append(e);e.append(b.render().$el);a.$el.append(c)})})();this.Mb(this.mg);return this};
d.show=function(){this.$el.addClass("multipageDialogAppearing");this.ze.show(this.render().$el);this.C.setTimeout(function(){this.$el.removeClass("multipageDialogAppearing")}.bind(this),300)};d.Fp=function(){var a=this.mg+1;a>=this.Dd.length?this.hide():this.Mb(a)};d.Gp=function(){var a=this.mg-1;0>a?this.hide():this.Mb(a)};
d.Mb=function(a){this.trigger("pageChange",this.Dd[a]);var b=this.$(".multipageDialogPageWrapper"),c=this.$(".multipageDialogPage");this.mg=a;b.css("transform","translateY("+-100*a+"%)");c.removeClass("multipageDialogCurrentPage");c.eq(a).addClass("multipageDialogCurrentPage")};function Xm(a){this.Md=a.Md;this.oc=null;this.wb=a.wb||0;this.hc=void 0===a.hc||a.hc;this.ig=void 0===a.ig||a.ig;this.Lb=void 0===a.Lb||a.Lb;this.analytics=a.analytics;this.dn=_.once(function(){Pm(a.Md);Qm(a.Md)});this.Md.once("signup",this.Ko.bind(this));this.Ac=a.ym;this.fb=a.fb}d=Xm.prototype;d.listenTo=Backbone.Events.listenTo;d.listenToOnce=Backbone.Events.listenToOnce;d.on=Backbone.Events.on;d.once=Backbone.Events.once;d.off=Backbone.Events.off;d.stopListening=Backbone.Events.stopListening;
d.trigger=Backbone.Events.trigger;d.remove=function(){this.oc&&this.oc.remove()};d.show=function(){Ym(this,[])};
function mf(a){var b=[],c={},c={splashImageClass:"unlimitedFolders",primaryText:a.Ac.format("canvaForWorkUpgradeFeatureUnlimitedFoldersPrimary"),secondaryHtml:a.Ac.format("canvaForWorkUpgradeFeatureUnlimitedFoldersSecondary")},c=new Rm({pb:Zm(a),Cj:a.Jp(c),eh:null});a.listenToOnce(c,"next",function(){this.analytics.track("upgrade_cta_clicked",{location:"learn_more",variant:void 0})});b.push(c);Ym(a,b)}
function Ym(a,b){var c=new Backbone.View({className:"upgradeDialogSignup"});b.push(c);a.oc=new Wm({yi:["upgradeDialog"],hc:a.hc,Lb:a.Lb,Dd:b});a.oc.on("hide",function(){a.oc.remove();a.oc=null;a.Md.remove();a.trigger("hide")});a.dn();a.oc.show();a.analytics&&a.analytics.track("upgrade_dialog_loaded");a.Md.appendTo(c.$el);c.$el.append(a.fp({meganKelleyQuote:a.Ac.format("canvaForWorkUpgradeQuoteMeganKelleyContent"),meganKelleyCite:a.Ac.format("canvaForWorkUpgradeQuoteMeganKelleyCite"),donnaMoritzQuote:a.Ac.format("canvaForWorkUpgradeQuoteDonnaMoritzContent"),
donnaMoritzCite:a.Ac.format("canvaForWorkUpgradeQuoteDonnaMoritzCite"),travisBernardQuote:a.Ac.format("canvaForWorkUpgradeQuoteTravisBernardContent"),travisBernardCite:a.Ac.format("canvaForWorkUpgradeQuoteTravisBernardCite")}))}function Zm(a){var b=a.Ac;return 0===a.wb?b.format("canvaForWorkUpgradeGetCanvaForWork"):b.format("canvaForWorkUpgradeStartYourTrial",a.wb)}d.Ko=function(){this.ig&&this.oc&&this.oc.remove();this.trigger("signup")};d.fp=_.template('\x3cdiv class\x3d"upgradeDialogQuotes"\x3e\x3cblockquote\x3e\x3c%- meganKelleyQuote %\x3e\x3ccite\x3e\x3c%- meganKelleyCite %\x3e\x3c/cite\x3e\x3c/blockquote\x3e\x3cblockquote\x3e\x3c%- donnaMoritzQuote %\x3e\x3ccite\x3e\x3c%- donnaMoritzCite %\x3e\x3c/cite\x3e\x3c/blockquote\x3e\x3cblockquote\x3e\x3c%- travisBernardQuote %\x3e\x3ccite\x3e\x3c%- travisBernardCite %\x3e\x3c/cite\x3e\x3c/blockquote\x3e\x3c/div\x3e');
d.Jp=_.template('\x3cdiv class\x3d"upgradeDialogSpecific"\x3e\x3cdiv class\x3d"upgradeDialogSpecific__image upgradeDialogSpecific__image--\x3c%- splashImageClass %\x3e"\x3e\x3c/div\x3e\x3ch2 class\x3d"upgradeDialogSpecific__primaryText"\x3e\x3c%- primaryText %\x3e\x3c/h1\x3e\x3cp class\x3d"upgradeDialogSpecific__secondaryHtml"\x3e\x3c%\x3d secondaryHtml %\x3e\x3c/p\x3e\x3c/div\x3e');function $m(){}$m=F.extend({className:"lightboxActionsPopOver"});$m.$e=function(a,b,c){return new $m({da:a,oi:b,Kn:c})};d=$m.prototype;d.initialize=function(a){a=_.defaults({},a,{xc:!0,title:a.da.format("lightboxShareThisDesign"),position:"top",Jf:!0,Kd:!1});this.oi=a.oi;this.da=a.da;this.cq=a.Kn;a.content=this.Ze({designUrl:this.oi,copyText:this.da.copy(),reportInappropriate:this.da.mp()});F.prototype.initialize.call(this,a)};
d.di=function(){try{document.execCommand("copy",!1,this.Im[0].select()),this.Ek()}catch(a){}};d.Ek=function(){this.ci.text(this.da.format("lightboxCopiedButton")).addClass("copied")};d.render=function(){F.prototype.render.call(this);this.ci=this.$(".copyLinkButton");this.Im=this.$("#copyLinkField");this.cq?(this.di=this.di.bind(this),this.ci.on("click",this.di)):(this.Em=new ZeroClipboard(this.ci[0]),this.Em.on("aftercopy",this.Ek.bind(this)));return this};
d.show=function(){F.prototype.show.call(this);this.$("#copyLinkField")[0].select();return this};d.Ze=_.template('\x3cinput id\x3d"copyLinkField" class\x3d"buttonBlock textInput" value\x3d"\x3c%- designUrl %\x3e" /\x3e\x3cbutton data-clipboard-target\x3d"copyLinkField" class\x3d"button copyLinkButton"\x3e\x3c%- copyText %\x3e\x3c/button\x3e\x3ca href\x3d"mailto:report-content@canva.com?subject\x3dReport Inappropriate Design\x26amp;body\x3dThe design found at \x3c%- designUrl %\x3e contains inappropriate content." class\x3d"reportLink"\x3e\x3c%- reportInappropriate %\x3e\x3c/a\x3e');function R(){}R=D.extend({className:"spanishIntroDialog"});R.rm=14548824E5;R.$f="hasSeenSpanishIntroDialog";R.Dn=function(a){if(a.xn&&a.Jb.user.Ki()<R.rm){var b=!!a.Jb.user.kl()[R.$f],c=!!an(a.na,R.$f);b||(bn(a.na,R.$f),yg(a.aa),c||(new R({analytics:a.analytics,aa:a.aa,Jb:a.Jb,C:a.C})).show())}};R.prototype.initialize=function(a){D.prototype.initialize.call(this,{C:a.C,content:$(this.rn()),Jf:!1,xc:!1});this.analytics=a.analytics;this.aa=a.aa;this.Jb=a.Jb};
R.prototype.events=function(){var a=D.prototype.events.call(this);return _.extend(a,{"click .buttonSpanish":this.xp,"click .buttonEnglish":this.ok})};
R.prototype.xp=function(){var a=this.$(".buttonSubmittable"),b=this.$(".buttonEnglish");a.toggleClass("submitting",!0);b.attr("disabled",!0);var c=this.Jb.user,e=c.i(),f=c.nf(),c=ch((new Xg).Kh(e));zg(this.aa,c).bind(this).then(function(){"es-ES"!==f&&this.analytics.track("locale_changed",{fromLocale:f,toLocale:"es-ES",section:"homepage",subsection:null,location:"language_dialog"});location.reload()}).catch(function(){alert("There was an error updating your language setting. Try again.");a.toggleClass("submitting",
!1);b.attr("disabled",!1)})};R.prototype.rn=_.template('\x3cdiv class\x3d"spanishIntroDialogHeaderContainer"\x3e\x3ch2\x3e¡Hola!\x3c/h2\x3e\x3c/div\x3e\x3cdiv class\x3d"spanishIntroDialogBodyContainer"\x3e\x3cp\x3eHemos notado que hablas \x3cstrong\x3eespañol\x3c/strong\x3e. ¿Sabes qué? ¡Nosotros también!\x3c/p\x3e\x3cp\x3e¿Quieres que cambiemos tu idioma por defecto a \x3cstrong\x3eespañol\x3c/strong\x3e?\x3c/p\x3e\x3cdiv class\x3d"buttonContainer"\x3e\x3cbutton class\x3d"button buttonSubmittable buttonSpanish"\x3eUsar en español\x3c/button\x3e\x3cbutton class\x3d"button buttonOutline buttonEnglish"\x3eKeep using English\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e');function cn(a){this.view=a.view;this.listenTo(this.view,"acknowledge",this.Ph)}d=cn.prototype;d.getElement=function(){return this.view.$el};d.Ph=function(){this.stopListening(this.view);var a=this.view;dn(a).bind(a).then(a.remove);this.trigger("acknowledge");return this};d.on=Backbone.Events.on;d.off=Backbone.Events.off;d.listenTo=Backbone.Events.listenTo;d.trigger=Backbone.Events.trigger;d.stopListening=Backbone.Events.stopListening;function en(a){Backbone.View.call(this,{className:"noticeBox"});this.message=a.message;this.pb=a.pb}k(en,Backbone.View);en.prototype.events=function(){var a=this;return{"click .noticeBox__acknowledge":function(){return a.trigger("acknowledge")}}};function dn(a){return new P(function(b){a.$el.css({overflow:"hidden",height:a.$el.outerHeight()}).addClass("noticeBox--fading").one("animationend",b)})}en.prototype.hide=function(){this.$el.addClass("noticeBox--hidden")};en.prototype.show=function(){this.$el.removeClass("noticeBox--hidden")};
en.prototype.render=function(){var a=this.el,b;b=this.message;var c=this.pb;soy.asserts.assertType(b instanceof soydata.SanitizedHtml||b instanceof soydata.UnsanitizedText||goog.isString(b),"message",b,"soydata.SanitizedHtml");soy.asserts.assertType(c instanceof soydata.SanitizedHtml||c instanceof soydata.UnsanitizedText||goog.isString(c),"buttonText",c,"soydata.SanitizedHtml");b=soydata.VERY_UNSAFE.ordainSanitizedHtml('\x3cdiv class\x3d"noticeBox__message"\x3e'+soy.$$escapeHtml(b)+'\x3c/div\x3e\x3cdiv class\x3d"noticeBox__acknowledge"\x3e\x3cbutton class\x3d"button"\x3e'+
soy.$$escapeHtml(c)+"\x3c/button\x3e\x3c/div\x3e");a.innerHTML=b;return this};function fn(a){this.Be=a.Be;this.Qp="noticeBox__"+this.Be;this.na=a.na;this.Xb=a.Xb;this.listenTo(this.Xb,"acknowledge",this.Ph)}fn.prototype.Ph=function(){bn(this.na,this.Qp);this.stopListening(this.Xb)};fn.prototype.getElement=function(){return this.Xb.getElement()};function gn(a){if(an(a.na,"noticeBox__"+a.Be))a=null;else{var b=new en({message:a.message,pb:a.pb});b.render();b=new cn({view:b});a=new fn({Be:a.Be,na:a.na,Xb:b})}return a}fn.prototype.listenTo=Backbone.Events.listenTo;
fn.prototype.stopListening=Backbone.Events.stopListening;function hn(a){this.ma=[];this.Qa=!1;this.Ma=a.Ma;this.cc=a.cc}d=hn.prototype;d.listenTo=Backbone.Events.listenTo;d.off=Backbone.Events.off;d.on=Backbone.Events.on;d.stopListening=Backbone.Events.stopListening;d.trigger=Backbone.Events.trigger;var pf="name",qf="acl";d=hn.prototype;
d.fetch=function(){function a(a){var b;if(b=a instanceof Array)a=a[1],b=500<=a&&600>a;return b}if(!this.Qa){this.Qa=!0;var b=sg().Cc(100).Yf(this.cc);this.Ma.Yk(b).bind(this).then(this.Ua).catch(a,this.jo).catch(this.kj);this.trigger("fetch:start")}};d.ya=function(){return Object.freeze(this.ma.slice())};d.Z=function(a){var b;this.ma.some(function(c){if(c.i()===a)return b=c,!0});if(!b)throw Error("Folder is not known to DesignFolderManager");return b};
d.Ua=function(a){a=a.ya()||[];this.ma=a.sort(jn);this.Qa=!1;this.trigger("fetch:success",a)};function kn(a){var b=L(window.homeConfig.initialFolder);ma(0===a.ma.length,"cannot load initial folder when DFM has already fetched folders");a.ma=[b];a.trigger("fetch:success",a.ma)}d.kj=function(){this.Qa=!1;this.trigger("fetch:fail",!1)};d.jo=function(){this.Qa=!1;this.trigger("fetch:fail",!0)};
d.create=function(a){a=wg((new vg).sk(a));var b=_.uniqueId("CREATE_");this.Ma.lg(a).then(this.Un.bind(this,b)).catch(function(a){return a instanceof Array&&a[0]&&"quota exceeded"==a[0].error},this.zl.bind(this,b,"quota exceeded")).catch(this.zl.bind(this,b));P.resolve().then(this.trigger.bind(this,"create:start",b));return b};d.Un=function(a,b){b=b.Z();this.ma.push(b);this.ma.sort(jn);this.trigger("create:success",a,b)};d.zl=function(a,b){this.trigger("create:fail",a,b)};
d.delete=function(a){this.Z(a.i());var b=(new fg).Bc(Wf(a));b.trash=!0;this.Ma.Ch(b).bind(this).then(this.ao).catch(this.ij.bind(this,a));this.trigger("delete:start",a)};d.ao=function(a){var b=a.Z();this.ma=this.ma.filter(function(a){return a.i()!==b.i()});this.trigger("delete:success",b)};d.ij=function(a){this.trigger("delete:fail",a)};d.Pl=function(a){var b=a.Z();this.ma.some(function(a,e){if(a.i()===b.i())return this.ma[e]=b,!0},this);return b};
function im(a,b,c){a.Z(c.i());var e=(new fg).Bc(Wf(c)),f=[Object.freeze(y(gg,{id:b.i(),type:"DESIGN"}))];e.add=f;a.Ma.Ch(e).bind(a).then(a.Pl).then(a.Ln.bind(a,b,c)).catch(a.Mn.bind(a,b,c));a.trigger("addToFolder:start",b,c)}d.Ln=function(a,b){this.trigger("addToFolder:success",a,b)};d.Mn=function(a,b){this.trigger("addToFolder:fail",a,b)};
d.Gj=function(a,b){this.Z(b.i());var c=(new Sf).rk([a.i()]).Bc(Wf(b));this.Ma.gp(c).bind(this).then(this.nj.bind(this,a,b)).catch(this.oj.bind(this,a,b));this.trigger("removeFromFolder:start",a,b)};d.nj=function(a,b){this.trigger("removeFromFolder:success",a,b)};d.oj=function(a,b){this.trigger("removeFromFolder:fail",a,b)};
d.change=function(a,b,c){this.Z(b.i());var e=(new fg).Bc(Wf(b));if(a===pf)e.sk(c);else if("description"===a)e.description=c;else if(a===qf)e.acl=c;else throw Error("unrecognised change type");this.Ma.Ch(e).bind(this).then(this.Pl).then(this.Ng.bind(this,a,b,c)).catch(this.fj.bind(this,a,b,c));this.trigger("change:start",a,b,c)};
d.Ng=function(a,b,c,e){if(a===pf)this.ma.sort(jn);else if(a===qf){if(!e.ie())throw Error("returned folder does not have an ACL field");c=e.ie()}this.trigger("change:success",a,e,c)};d.fj=function(a,b,c){this.trigger("change:fail",a,b,c)};function jn(a,b){return(a.getName()||"").toLowerCase().localeCompare((b.getName()||"").toLowerCase())};function ln(a){bm.call(this,{wa:a.wa,Ga:a.Ga,ua:a.ua,va:a.va,view:a.view,j:a.j});this.l=a.l;this.listenTo(this.l,{"removeFromFolder:success":this.nj,"removeFromFolder:fail":this.oj});this.J=db(a.j);this.o=a.o;this.G=a.G;this.Bb=a.Bb;this.Ma=a.Ma;this.Za=a.Za}ln.prototype=Object.create(bm.prototype);d=ln.prototype;d.constructor=ln;function mn(a,b){var c=N(a.D,sf),e=c?hd.bind(null,b):id.bind(null,b);return new ed({analytics:a.analytics,Vb:e,j:a.j,F:b,Ld:c,Ke:!0,Fa:nn.bind(null,a,b)})}
function nn(a,b){var c=a.D,e=a.j;e.vc||(e.vc=new nb(e.qa));c=new Tc(c,e.vc);e=N(a.D,sf);return new wd({df:b.getName()||Ga(a.j).Wc(),Qh:c.sa(),ta:Ka(a.j),nh:e,sh:e,Vj:e})}d.jj=function(a,b){function c(a,b,c){b.i()===e.i()&&c.i()===f.i()&&(!a&&this.Bl.call(this),this.stopListening(this.l,g))}bm.prototype.jj.call(this,a,b);var e=on(a.F),f=this.l.Z(this.Bb.i()),g={"addToFolder:success":c.bind(this,!0),"addToFolder:fail":c.bind(this,!1)};this.listenTo(this.l,g);im(this.l,e,f)};
d.Gj=function(a){var b=on(a),c=this.l.Z(this.Bb.i());this.l.Gj(b,c);W(this,a.i()).nb(!0)};d.nj=function(a,b){b.i()===this.Bb.i()&&W(this,a.i()).nb(!0).then(function(){this.Ge(a.i())}.bind(this))};d.oj=function(a){W(this,a.i()).nb(!1);alert(this.J.format("designFoldersRemoveFromFolderError"))};d.hp=function(){throw Error("not implemented");};function on(a){return ig({id:a.i(),name:a.getName(),thumbnail:a.Ia(),type:"DESIGN"})}
d.we=function(a){bm.prototype.we.call(this,a);this.listenTo(a,{removeFromFolder:this.Gj.bind(this,a.F),removeFromAllFolders:this.hp.bind(this,a.F)})};d.Oe=function(a,b){return W(this,a.i()).Oe(b)};d.getSources=function(){return N(this.l.Z(this.Bb.i()),bg)?_.values(this.kd).map(function(a){var b=a.F,c=b.Ia(),b=ig({id:b.i(),thumbnail:{height:c.Ha(),url:c.fa(),width:c.hb()},type:"DESIGN"});return new Xl(a.view.Ia()[0],b)}):[]};d.ke=function(a){a=W(this,a.i());return $(this.si({thumbnailUrl:a.F.Ia().fa()}))[0]};
d.Ua=function(a){V.prototype.Ua.call(this,a);var b=tg(new rg,this.Za.Ra.get(oc)?"VISIBLE_TO":"OWNED_BY").Yf(this.o.id).ec(this.G.id).rk(a.map(function(a){return a.i()}));this.Ma.Yk(b).bind(this).then(function(b){function e(a){return a!==h}function f(a){try{return l.Z(a),!0}catch(b){return!1}}function g(a){var e;b.ya().some(function(b){if(b.i()===a)return e=b,!0});if(!e)throw Error("could not find associated folder in response");return e}var h=this.Bb.i(),l=this.l,m=b.itemMappings||{},q=Object.keys(m).reduce(function(a,
b){var c=(m[b]||[]).filter(e).filter(f).map(g);a[b]=c;return a},{});a.forEach(function(a){a=a.i();W(this,a).Dh(q[a])},this)}).catch(function(){})};d.Sd=function(a,b){W(this,a).gc(b)};d.si=_.template('\x3cdiv class\x3d"dragDesign" style\x3d"background-image:url(\'\x3c%- thumbnailUrl %\x3e\')"\x3e\x3c/div\x3e');function pn(){}pn=X.extend();pn.create=function(a){var b=(new C).render(),c=new H({bb:function(a){return Math.floor(a/X.Qd)}});return new pn({ka:b,J:a,ea:c})};pn.prototype.initialize=function(a){X.prototype.initialize.call(this,{ka:a.ka,ea:a.ea,zd:!1});this.J=a.J};pn.prototype.Gd=function(){return['\x3cp class\x3d"designCardListEmptyMessage"\x3e',this.J.format("designFoldersEmptyFolder"),"\x3c/p\x3e"].join("")};
pn.prototype.Hd=function(){return['\x3cp class\x3d"designCardListErrorMessage"\x3e',this.J.format("designFoldersLoadDesignsError"),"\x3c/p\x3e"].join("")};function qn(a){this.D=a.D;this.l=a.l;this.Xd=a.Xd;this.view=a.view;this.listenTo(this.l,{"change:success":this.Ng.bind(this,!0),"change:fail":this.Ng.bind(this,!1),"delete:fail":this.ij});this.listenTo(this.view,{edit:this.io,deleteFolder:this.eo,shareDialogClick:this.Jo})}d=qn.prototype;d.listenTo=Backbone.Events.listenTo;d.stopListening=Backbone.Events.stopListening;function rn(a){return new qn({Xd:a.Xd,l:a.l,J:a.J,D:a.D,C:a.C,view:a.view})}d.getElement=function(){return this.view.render().$el};
d.remove=function(){this.view.remove();this.stopListening()};d.Jo=function(){if(!this.Xd)throw Error("createShareFolderDialog not injected to DesignFolderHeader");this.Xd().init()};d.Ng=function(a,b,c){c.i()===this.D.i()&&(a&&(this.D=c),b===pf?(c=this.view,sn(tn===tn?c.yc:c.mc,a),a||alert(Rb(c.J))):"description"===b?(c=this.view,sn(un===tn?c.yc:c.mc,a),a||alert(Rb(c.J))):b===qf&&(a=this.view,a.D=c,a.render()))};d.io=function(a,b){this.l.change(a===tn?pf:"description",this.D,b)};
d.eo=function(){vn(this.view,!0);this.l.delete(this.D)};d.ij=function(a){a.i()===this.D.i()&&vn(this.view,!1).og()};function xn(){}xn=Backbone.View.extend({className:"designFolderHeader tabHeader",tagName:"section"});xn.prototype.initialize=function(a){this.analytics=a.analytics;this.J=a.J;this.ff=a.ff;this.D=a.D;this.Zb=!1;this.Tj=a.Tj||!1;this.oh=a.oh||!1;this.Rj=a.Rj||!1;this.ha=this.mc=this.yc=null;this.Fa=a.Fa;this.Xb=a.Xb};
xn.create=function(a){var b=a.D,c=N(b,sf),e=N(b,cg),f=N(b,bg),g=null;c&&!f&&(g=c?a.J.format("designFoldersNoticeBoxFirstEditHtml"):a.J.format("designFoldersNoticeBoxFirstViewHtml"),g=gn({na:a.na,Be:"sharedFolderHeader",message:soydata.VERY_UNSAFE.ordainSanitizedHtml(g),pb:a.J.format("designFoldersNoticeBoxButton")}));return new xn({analytics:a.analytics,J:a.J,ff:a.ff,Tj:f,oh:c,Rj:e,Xb:g,D:b,Fa:function(){return new yn({J:a.J,Pj:f})}})};
xn.prototype.events=function(){return{"click .tabHeaderMenuButton":this.kk,"click .tabHeaderShareButton":this.Yp}};var tn="title",un="description";d=xn.prototype;d.Sf=function(a){this.Zb=a;this.render()};function zn(a,b){var c=b===tn?Qb(a.J):a.J.format("designFoldersHeaderDescriptionPlaceholder");return new An({wn:(b===tn?a.D.getName():a.D.Bg())||c,defaultValue:c,Ti:!0,maxLength:255})}function vn(a,b){a.$el.toggleClass("beingDeleted",b);return a}d.og=function(){alert(this.J.og())};
d.kk=function(){this.ha&&this.stopListening(this.ha);this.ha=this.Fa();this.listenTo(this.ha,{deleteFolder:this.Sm});bd(this.ha,this.$(".tabHeaderMenuButton"));this.analytics.ab("design_folder_menu","homepage","design_folder","design_folder")};d.Yp=function(){this.analytics.ab("share_folder","homepage","design_folder","design_folder");this.trigger("shareDialogClick")};
d.Sm=function(){this.analytics.ab("delete_folder","homepage","design_folder","design_folder");confirm(this.J.format("designFoldersMenuDeleteFolderConfirm",this.D.getName()||""))&&this.trigger("deleteFolder")};
d.render=function(){this.stopListening();this.yc&&this.yc.remove();this.mc&&this.mc.remove();this.Zb?this.$el.html(this.xi({errorTitle:this.J.format("designFoldersHeaderLoadErrorTitle"),errorDescription:this.J.format("designFoldersHeaderLoadErrorDescription")})):(this.$el.html(this.template({title:this.D.getName()||Qb(this.J),description:this.D.Bg()||"",itemCount:this.J.format("designFoldersHeaderItemCount",this.D.itemCount),enableSharing:this.ff,showMenuButton:this.Tj,showEditSharing:this.Rj,viewOnly:!this.oh,
shareFolderButton:this.J.yp(),viewOnlyButton:this.J.fq()})),this.Xb&&this.Xb.getElement().appendTo(this.$el),this.oh&&(this.yc=zn(this,tn),this.mc=zn(this,un),this.listenTo(this.yc,"edit",this.trigger.bind(this,"edit",tn)),this.listenTo(this.mc,"edit",this.trigger.bind(this,"edit",un)),this.$(".tabHeaderTitle").html(this.yc.render().$el),this.$(".tabHeaderDescription").html(this.mc.render().$el)));return this};
d.remove=function(){Backbone.View.prototype.remove.call(this);this.yc&&this.yc.remove();this.mc&&this.mc.remove()};d.uc=function(){return this.D.getName()||Qb(this.J)};d.xi=_.template('\x3cdiv class\x3d"tabHeaderRow lead"\x3e\x3cdiv class\x3d"tabHeaderTitle"\x3e\x3cspan\x3e\x3c%- errorTitle %\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"tabHeaderRow secondary"\x3e\x3cdiv class\x3d"tabHeaderDescription"\x3e\x3cspan\x3e\x3c%- errorDescription %\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e');
d.template=_.template('\x3cdiv class\x3d"tabHeaderRow lead"\x3e\x3cdiv class\x3d"tabHeaderTitle"\x3e\x3c%- title %\x3e\x3c/div\x3e\x3cdiv class\x3d"tabHeaderLeadRight"\x3e\x3c% if (enableSharing) { %\x3e\x3c% if (viewOnly) { %\x3e\x3cspan class\x3d"tabHeaderShareButton viewOnly button buttonSmall"\x3e\x3c%- viewOnlyButton %\x3e\x3c/span\x3e\x3c% } else { %\x3e\x3cspan class\x3d"tabHeaderShareButton button buttonSmall"\x3e\x3c%- shareFolderButton %\x3e\x3c/span\x3e\x3c% } %\x3e\x3c% } %\x3e\x3c% if (showMenuButton) { %\x3e\x3cspan class\x3d"tabHeaderMenuButton button buttonSmall whiteButton"\x3e\x3c/span\x3e\x3c% } %\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"tabHeaderRow secondary"\x3e\x3cspan class\x3d"tabHeaderItemCount"\x3e\x3c%- itemCount %\x3e\x3c/span\x3e\x3cdiv class\x3d"tabHeaderDescription"\x3e\x3c%- description %\x3e\x3c/div\x3e\x3c/div\x3e');function yn(){}yn=F.extend({className:"designFolderMenu"});d=yn.prototype;d.initialize=function(a){this.J=a.J;this.Pj=a.Pj||!1;F.prototype.initialize.call(this,{content:this.Fd(),Kd:!1,position:"top",Cd:!0,xc:!1})};d.events=function(){return{"click .folderMenu__deleteFolder":this.bc.bind(this,"deleteFolder")}};d.bc=function(a){this.trigger(a);this.remove()};d.Fd=function(){return this.Ze({showDeleteFolder:this.Pj,deleteFolder:this.J.format("designFoldersMenuDeleteFolder")})};d.Ze=_.template('\x3cdiv class\x3d"selectMenu"\x3e\x3c% if (showDeleteFolder ) { %\x3e\x3cdiv class\x3d"selectMenu__item folderMenu__deleteFolder"\x3e\x3c%- deleteFolder %\x3e\x3c/li\x3e\x3c% } %\x3e\x3c/div\x3e');function Bn(a){this.N=null;this.Qa=this.empty=!1;this.jf=!0;this.D=a.D;this.Ma=a.Ma;this.Wb=!0;this.ub=a.ub}d=Bn.prototype;d.off=Backbone.Events.off;d.on=Backbone.Events.on;d.trigger=Backbone.Events.trigger;d.fetch=function(){function a(){this.Qa=!1}if(!this.Qa&&this.Wb){var b=(new kg).Yc(this.N).Bc(this.D).Cc(this.ub);this.Qa=!0;this.Ma.vd(b).bind(this).finally(a).then(this.Ua).catch(this.Ef)}};
d.Ua=function(a){var b=a.qd();this.jf&&(this.empty=0===b.length,this.jf=!1);this.N=a.ia();this.Wb=!!this.N;this.trigger("fetch",b.map(this.aj))};d.Ef=function(){this.trigger("error")};d.aj=function(a){var b=a.Ia();return je({id:a.i(),name:a.getName(),thumbnail:{width:b.hb(),height:b.Ha(),url:b.fa()}})};d.isEmpty=function(){return this.empty};d.sd=function(){return this.Qa};function Cn(a){Y.call(this,a);this.la=a.la}k(Cn,Y);Cn.prototype.getSources=function(){return this.la.getSources()};Cn.prototype.ke=function(){return this.la.ke.apply(this.la,arguments)};Cn.prototype.Pe=function(a){this.la.Pe(a)};Cn.prototype.Sd=function(a,b){this.la.Sd(a,b)};Object.defineProperties(Cn.prototype,{bk:{configurable:!0,enumerable:!0,get:function(){return!0}}});function Dn(a){Z.call(this,a);this.pa=a.pa;this.Sa=a.Sa}k(Dn,Z);Dn.prototype.uc=function(){return this.Ja.custom(this.Sa.uc())};function An(){}An=Backbone.View.extend({className:"editableInput"});d=An.prototype;d.events=function(){return{click:this.Ad,"keydown input":this.kb,"input input":this.wk,"blur input":this.oo}};d.initialize=function(a){this.tl=this.hd=a.wn;this.defaultValue=a.defaultValue;this.Ti=a.Ti;this.enabled="undefined"!==typeof a.enabled?a.enabled:!0;this.jk(this.enabled);this.maxLength=a.maxLength||null;this.Zk=!!a.Zk;this.xk=!!a.xk;this.se=!1};
d.Ad=function(){this.trigger("clicked");!this.enabled||this.se||document.getSelection().toString().length||(this.se=!0,this.$el.addClass("editing"),this.render().wk(),this.$("input").select())};function En(a,b){if(a.enabled&&a.se){var c=a.$("input").val()||a.defaultValue;a.se=!1;a.$el.removeClass("editing");b&&c!==a.hd&&(a.hd=c,a.Ti&&a.$el.addClass("savePending"),a.trigger("edit",c));a.render()}}d.kb=function(a){switch(a.keyCode){case 13:En(this,!0);break;case 27:En(this,!1)}};
d.wk=function(){this.Zk||this.$(".inputSandbox").text(this.$("input").val()||this.defaultValue);return this};d.oo=function(){En(this,!0)};d.jk=function(a){!a&&this.se&&En(this,!1);this.enabled=a;this.$el.toggleClass("enabled",a)};function sn(a,b){a.$el.removeClass("savePending");b?a.tl=a.hd:(a.hd=a.tl,a.render())}
d.render=function(){this.se?this.$el.html(this.Zm({editValue:this.hd,defaultValue:this.defaultValue,maxLength:this.maxLength})):this.$el.html(this.Vm({displayValue:this.hd}));this.xk&&this.$el.addClass("pseudoEnabled");return this};d.Vm=_.template("\x3cspan\x3e\x3c%- displayValue %\x3e\x3c/span\x3e");d.Zm=_.template('\x3cdiv class\x3d"inputContainer"\x3e\x3cinput type\x3d"text" value\x3d"\x3c%- editValue %\x3e" \x3c% if (maxLength) { %\x3emaxlength\x3d"\x3c%- maxLength %\x3e" \x3c% } %\x3eplaceholder\x3d"\x3c%- defaultValue %\x3e" /\x3e\x3cspan class\x3d"inputSandbox"\x3e\x3c/span\x3e\x3c/div\x3e');function Fn(a){var b=this;this.v=a.v;this.xa=a.xa;this.l=a.l;this.pi=!1;this.D=a.D;this.Ka=a.Ka;this.Ai=a.Ai;this.aa=a.aa;this.view=a.view;this.listenTo(this.view,{save:function(){b.pi&&b.l.change(qf,b.D,b.Ka)},hide:function(){b.stopListening()},triggerMenu:function(a,e){return b.rj(a,e)},changeAccess:function(a,e,f){return Gn(b,a,e,f)}});this.listenTo(this.l,{"change:success":function(a,e){return b.gj(a,e)},"change:fail":function(a,e){return b.fj(a,e)}});this.listenTo(this.Ai,{select:function(a){return Hn(b,
a)}})}
function In(a){var b=hb(a.j);ma("undefined"!==typeof a.D.ie(),"expecting Folder to have ACL list");var c=a.D.ie().getEntries().reduce(function(a,b){return a+(b.X()?0:1)},0);ma(1>=c,"expecting ACL to have maximum of 1 brand entry");var c=a.Mm({Ee:b.format("shareFolderDialogAddUserPlaceholder"),aa:a.aa,G:a.xa,Ub:Ma(a.j)}),e=new Jn({Xe:N(a.D,cg),v:a.v,Fa:function(a,c){return new Kn({ba:b,gd:a,Uj:c})},C:a.C,D:a.D,Bi:c.view,ba:b});return new Fn({xa:a.xa,v:a.v,l:a.l,D:a.D,Ka:a.D.ie(),Ai:c,aa:a.aa,view:e})}
d=Fn.prototype;d.init=function(){this.view.show();Ln(this)};function Ln(a){var b=[],c=ph(oh((new nh).ec(a.xa.i()).Cc(100)));a.aa.hf(c).then(function(e){b.push.apply(b,[].concat(ha(e.pf())));if(e.ia())return a.aa.hf(c.Yc(e.ia()))}).then(function(c){c&&b.push.apply(b,[].concat(ha(c.pf())));Mn(a,b,!(!c||!c.ia()))}).catch(function(){var b=a.view;b.$(".content").html(b.ba.format("shareFolderDialogEditorLoadError","https://support.canva.com/hc/requests/new"))})}
function Mn(a,b,c){if("undefined"===typeof a.Ka.getEntries())throw Error("acl getEntres() is returning undefined");c&&Nn(a.view);c=a.Ka.getEntries().filter(function(a){return a.O()&&!a.X()});On(a.view,{o:null,G:a.xa,email:null,gd:c.length?c[0].Cb():null,bg:!1,Pa:!0});a.Ka.getEntries().filter(function(a){return!(a.O()&&!a.X())}).forEach(function(c){var f;b.forEach(function(a){a.X().i()===c.X()&&(f=a)});"undefined"!==typeof f&&On(a.view,{o:f.X(),G:a.xa,email:f.Mc(),gd:c.Cb(),bg:!1,Pa:c.Cb()!==bg})})}
function Hn(a,b){var c;c=void 0===c?cg:c;var e=b.X();if(a.Ka.getEntries().some(function(b){return Pn(b,e,a.xa)}))Qn(a.view,e,a.xa);else{var f=a.Ka.getEntries().slice();f.push(new eg({o:e.i(),G:a.xa.i(),Nh:c}));a.Ka=a.Ka.bd({entries:f});On(a.view,{o:e,G:a.xa,email:b.Mc(),gd:c,bg:!0,Pa:!0});a.pi=!0;Rn(a.view)}}
function Gn(a,b,c,e){var f;if(null===e)f=a.Ka.getEntries().filter(function(a){return!Pn(a,b,c)});else{var g=!1;f=a.Ka.getEntries().map(function(a){return Pn(a,b,c)?(g=!0,a.bd({access:e})):a});g||null!==b||f.unshift(new eg({o:null,G:c.i(),Nh:e}))}a.Ka=a.Ka.bd({entries:f});a.pi=!0;Rn(a.view);null===e&&null!==b?Sn(a.view,b,c):Tn(a.view,b,c,e)}d.rj=function(a,b){var c=this.Ka.getEntries().filter(function(c){return Pn(c,a,b)});this.view.kk(a,b,c.length?c[0].Cb():null)};
d.gj=function(a,b){a===qf&&b.i()===this.D.i()&&this.view.remove()};d.fj=function(a,b){a===qf&&b.i()===this.D.i()&&(a=this.view,alert(a.ba.format("shareFolderDialogSaveFailed","https://support.canva.com/hc/requests/new")),Un(a,!1))};function Pn(a,b,c){return("undefined"!==typeof a.X()?a.X():null)===(b?b.i():null)&&a.O()===c.i()}d.listenTo=Backbone.Events.listenTo;d.stopListening=Backbone.Events.stopListening;d.off=Backbone.Events.off;d.on=Backbone.Events.on;d.trigger=Backbone.Events.trigger;function Jn(a){D.call(this,_.extend({},a,{className:"shareFolderDialog"}))}k(Jn,D);d=Jn.prototype;d.events=function(){return _.extend(D.prototype.events.call(this),{"click .save":this.Eo})};d.initialize=function(a){D.prototype.initialize.call(this,{C:a.C,title:a.ba.title()});this.Fa=a.Fa;this.v=a.v;this.wi={};this.Bi=a.Bi;this.D=a.D;this.ba=a.ba;this.Xe=a.Xe};d.render=function(){D.prototype.render.call(this);this.Fd();return this};
d.Fd=function(){this.$(".content").html(Vn({accessText:this.ba.format("shareFolderDialogPeopleWithAccess",this.D.getName()||""),saveButton:this.ba.tp(),canModify:this.Xe,readOnlyText:this.ba.readOnly()}));this.Xe&&this.$(".findUserInputHolder").append(this.Bi.$el)};d.kk=function(a,b,c){var e=this;c=this.Fa(c,null===a);this.listenTo(c,{select:function(c){return e.trigger("changeAccess",a,b,c)}});bd(c,Wn(this,a,b).$(".accessControl"))};
function On(a,b){var c=Xn(_.extend(b,{v:a.v,C:a.C,ba:a.ba}));a.wi[(b.o?b.o.i():"")+b.G.i()]=c;a.Xe&&a.listenTo(c,"triggerMenu",function(){return a.trigger("triggerMenu",b.o,b.G)});a.$(".accessEditor").append(c.$el);b.bg&&!Yn(a,c)&&Zn(a,c)}function Sn(a,b,c){var e=Wn(a,b,c);$n(e);a.stopListening(e);delete a.wi[(b?b.i():"")+c.i()]}function Tn(a,b,c,e){a=Wn(a,b,c);a.$(".accessControl").text(ao(e,a.ba))}function Qn(a,b,c){var e=Wn(a,b,c);Yn(a,e)?bo(e):Zn(a,e).then(function(){return bo(e)})}
d.Eo=function(){this.trigger("save");Un(this,!0)};function Nn(a){a.$(".findUserInputHolder").text(a.ba.format("shareFolderDialogDegradedAddUserText"))}function Un(a,b){a.$(".save").toggleClass("submitting",b);a.$(".close").toggleClass("hide",b);a.hg=!b}function Rn(a){a.$(".save").prop("disabled",!1)}function Wn(a,b,c){a=a.wi[(b?b.i():"")+c.i()];if(!a)throw Error("access editor entry not found");return a}
function Yn(a,b){var c=b.$el.position().top;b=b.$el.height();a=a.$(".accessEditor").height();return 0<c&&c<a-b}function Zn(a,b){a=a.$(".accessEditor");return P.resolve(a.animate({scrollTop:a.scrollTop()+b.$el.position().top-a.height()/2+b.$el.height()/2}).promise())}var Vn=_.template('\n  \x3c% if (!canModify) { %\x3e\n    \x3cp class\x3d"feedback feedback--warning feedback--small"\x3e\x3c%- readOnlyText %\x3e\x3c/p\x3e\n  \x3c% } %\x3e\n  \x3cp class\x3d"peopleWithAccess"\x3e\x3c%- accessText %\x3e\x3c/p\x3e\n  \x3cdiv class\x3d"accessEditor\x3c% if (!canModify) { %\x3e readOnly\x3c% } %\x3e"\x3e\x3c/div\x3e\n  \x3cdiv class\x3d"findUserInputHolder"\x3e\x3c/div\x3e\n  \x3cbutton class\x3d"save button buttonSubmittable" disabled\x3e\x3c%- saveButton %\x3e\x3c/button\x3e\n');function co(a){Backbone.View.call(this,{el:a.el});this.Pa=a.Pa;this.C=a.C;this.ba=a.ba}k(co,Backbone.View);co.prototype.events=function(){var a=this;return{"click .accessControl":function(){return a.rj()}}};
function Xn(a){var b;b=null===a.o?a.ba.format("shareFolderDialogAllMembers"):a.o.i()===a.v.i()?a.ba.format("shareFolderDialogThatsYou"):a.email;var c=a.G.sa()?a.G.sa():a.ba.format("shareFolderDialogDefaultBrandName");b=$(eo({lead:null===a.o?c:a.o.sa()||a.o.Da(),desc:b,currentAccess:ao(a.gd,a.ba),editable:a.Pa,animated:a.bg,user:a.o?a.o.i():null,brand:a.G.i()}));if(a.o){var c={o:a.o,size:40},e=fo(c.o,c.size),c=new go({Ve:e,size:c.size,qe:c.qe,Fe:c.Fe,Re:c.Re,Zd:c.Zd});c.render()}else if(a.G){var c=
{G:a.G,size:40},e=(c.G.sa()||"Brand").toUpperCase().trim().replace(/^THE\s+/,"").charAt(0),f=c.G.al(),f=ho(f?"#"+f:"#b0b0b0"),c=new go({ue:e,$c:f,size:c.size,qe:c.qe,Fe:c.Fe,Re:c.Re,Zd:c.Zd});c.render()}else throw Error("unable to create AccessEditorEntryView avatar");b.find(".accessEditorEntryAvatar").append(c.render().$el);return new co({el:b[0],C:a.C,ba:a.ba,Pa:a.Pa})}co.prototype.rj=function(){this.Pa&&this.trigger("triggerMenu")};
function bo(a){a.$el.addClass("flashing");a.C.setTimeout(function(){a.$el.removeClass("flashing")},200)}function $n(a){a.$el.removeClass("animated");a.C.requestAnimationFrame(function(){a.$el.addClass("removing");a.C.setTimeout(function(){a.$el.remove()},500)})}function ao(a,b){return a===bg?b.Xi():a===cg?b.format("shareFolderDialogCanEdit"):a===dg?b.format("shareFolderDialogCanView"):null===a?b.format("shareFolderDialogNotShared"):b.format("shareFolderDialogUnknown")}var eo=_.template('\n  \x3cdiv class\x3d"accessEditorEntry\x3c% if (animated) { %\x3e animated\x3c% } %\x3e" data-user\x3d"\x3c%- user %\x3e" data-brand\x3d"\x3c%- brand %\x3e"\x3e\n    \x3cdiv class\x3d"accessEditorEntryAvatar"\x3e\n    \x3c/div\x3e\n    \x3cdiv class\x3d"accessEditorEntryInfo"\x3e\n      \x3cspan class\x3d"lead"\x3e\x3c%- lead %\x3e\x3c/span\x3e\n      \x3cspan class\x3d"desc"\x3e\x3c%- desc %\x3e\x3c/span\x3e\n    \x3c/div\x3e\n    \x3cdiv class\x3d"accessEditorEntryControls"\x3e\n      \x3cspan class\x3d"accessControl\x3c% if (editable) {%\x3e editable\x3c% } %\x3e"\x3e\x3c%- currentAccess %\x3e\x3c/span\x3e\n    \x3c/div\x3e\n  \x3c/div\x3e\n');function Kn(){}Kn=F.extend({className:"accessEditorMenu"});Kn.prototype.initialize=function(a){this.ba=a.ba;this.gd=a.gd;this.Uj=a.Uj;F.prototype.initialize.call(this,{content:this.Fd(),Kd:!1,Cd:!0,xc:!1})};Kn.prototype.events=function(){function a(a){b.trigger("select",a);b.remove()}var b=this;return{"click .accessEditorMenu__edit":function(){return a(cg)},"click .accessEditorMenu__view":function(){return a(dg)},"click .accessEditorMenu__none":function(){return a(null)}}};Kn.prototype.Mi=function(){return Um};
Kn.prototype.Fd=function(){return $(io({editLabel:this.ba.format("shareFolderDialogCanEdit"),viewLabel:this.ba.format("shareFolderDialogCanView"),notSharedLabel:this.ba.format("shareFolderDialogNotShared"),removeLabel:this.ba.remove(),showNotShared:this.Uj,currentAccess:this.gd,editorEnum:cg,viewerEnum:dg}))};var io=_.template('\n  \x3cdiv class\x3d"selectMenu"\x3e\n    \x3cdiv class\x3d"selectMenu__item accessEditorMenu__edit\x3c% if (currentAccess \x3d\x3d\x3d editorEnum) { %\x3e currentAccess\x3c% } %\x3e"\x3e\x3c%- editLabel %\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"selectMenu__item accessEditorMenu__view\x3c% if (currentAccess \x3d\x3d\x3d viewerEnum) { %\x3e currentAccess\x3c% } %\x3e"\x3e\x3c%- viewLabel %\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"selectMenu__item accessEditorMenu__none\x3c% if (currentAccess \x3d\x3d\x3d null) { %\x3e currentAccess\x3c% } %\x3e"\x3e\x3c%- showNotShared ? notSharedLabel : removeLabel %\x3e\x3c/div\x3e\n  \x3c/div\x3e\n');function jo(a){var b=this;this.index=a.index;this.Id=a.Id;this.view=a.view;this.listenTo(this.view,{keyUp:function(){return ko(b,!1)},keyDown:function(){return lo(b,!1)},keyTab:function(){return lo(b,!0)},keyShiftTab:function(){return ko(b,!0)},keyEnter:function(){null!==b.index&&b.trigger("select",b.index,b.Id[b.index||0])},keyEsc:function(){return b.trigger("cancel")},hover:function(a){b.index=a;b.view.select(a)},trigger:function(a){b.trigger("select",a,b.Id[a])}})}
function mo(a){var b=no({elements:a.elements});"undefined"!==typeof a.bf&&b.select(a.bf);return new jo({index:"undefined"===typeof a.bf?null:a.bf,Id:a.elements.filter(function(a){return a.Sl}),view:b})}function ko(a,b){a.index||(a.index=0);a.index--;0>a.index&&(a.index=b?a.Id.length-1:0);a.view.select(a.index)}function lo(a,b){a.index||(a.index=0);a.index++;a.index>=a.Id.length&&(a.index=b?0:a.Id.length-1);a.view.select(a.index)}d=jo.prototype;d.listenTo=Backbone.Events.listenTo;d.stopListening=Backbone.Events.stopListening;
d.trigger=Backbone.Events.trigger;d.off=Backbone.Events.off;d.on=Backbone.Events.on;function oo(a){var b=this;Backbone.View.call(this,{el:a.el,events:{"hover li.selectable":function(a){return b.trigger("hover",$(a.currentTarget).index())},"mouseover li.selectable":function(a){return $(a.currentTarget).addClass("hovering")},"mouseout li.selectable":function(a){return $(a.currentTarget).removeClass("hovering")},"click li.selectable":function(a){return b.trigger("trigger",$(a.currentTarget).index())}}});this.kb=this.kb.bind(this);$(document).on("keydown",this.kb)}k(oo,Backbone.View);
function no(a){var b=$(po());a=a.elements.map(function(a){return $("\x3cli\x3e").toggleClass("selectable",a.Sl).append(a.element)});var c;(c=b.find("ul")).append.apply(c,[].concat(ha(a)));return new oo({el:b[0]})}oo.prototype.select=function(a){this.$("li.active").removeClass("active");this.$("li.selectable").eq(a).addClass("active")};oo.prototype.remove=function(){$(document).off("keydown",this.kb);Backbone.View.prototype.remove.call(this)};
oo.prototype.kb=function(a){if(38===a.which)this.trigger("keyUp");else if(40===a.which)this.trigger("keyDown");else if(9===a.which&&a.shiftKey)this.trigger("keyShiftTab");else if(9===a.which)this.trigger("keyTab");else if(13===a.which)this.trigger("keyEnter");else if(27===a.which)this.trigger("keyEsc");else return;a.preventDefault();return!1};function qo(a,b){this.element=a instanceof jQuery?a:$(a);this.Sl=b}var po=_.template('\n  \x3cdiv class\x3d"menuList"\x3e\n    \x3cul\x3e\x3c/ul\x3e\n  \x3c/div\x3e\n');function ro(a){var b=this;this.aa=a.aa;this.view=a.view;this.wd=null;this.G=a.G;this.Lg=a.Lg||4;this.Hf=this.wf=null;this.listenTo(this.view,{requestAutocomplete:function(a){return so(b,a)},select:function(a){b.trigger("select",b.wf[a]);b.view.$("input").val("")}})}function to(a){var b=a.Ub,b=new uo({el:$(vo({inputPlaceholder:a.Ee}))[0],Ub:b});return new ro({aa:a.aa,G:a.G,Lg:a.Lg,view:b})}d=ro.prototype;d.remove=function(){this.stopListening();this.view.remove()};
function wo(a){var b=ph(oh((new nh).ec(a.G.i()))).Cc(100);a.aa.hf(b).then(function(c){a.wd=c.pf();if(c.ia())return a.aa.hf(b.Yc(c.ia()))}).then(function(b){b&&a.wd.push.apply(a.wd,[].concat(ha(b.pf())));b=a.Hf;a.Hf=null;so(a,b)}).catch(function(){return a.view.Zb()})}function so(a,b){a.Hf?a.Hf=b:null===a.wd?(a.Hf=b,wo(a)):(a.wf=a.wd.filter(function(a){return xo(b,a.X().Da())||xo(b,a.X().sa())||xo(b,a.Mc())}).slice(0,a.Lg),yo(a.view,a.wf))}
function xo(a,b){return null!==b&&-1!==b.toLowerCase().replace(/ |@/g,"").indexOf(a.toLowerCase().replace(/ |@/g,""))}d.listenTo=Backbone.Events.listenTo;d.stopListening=Backbone.Events.stopListening;d.trigger=Backbone.Events.trigger;d.off=Backbone.Events.off;d.on=Backbone.Events.on;function uo(a){var b=this;Backbone.View.call(this,{el:a.el,events:{"input input":function(a){return zo(b,a)},"focus input":function(a){return zo(b,a)},"blur input":function(){return b.ej()}}});this.Ub=a.Ub;this.tb=this.wf=null}k(uo,Backbone.View);function zo(a,b){b=$(b.target).val();""===b?Ao(a):a.trigger("requestAutocomplete",b)}uo.prototype.ej=function(){this.tb&&!this.tb.view.$("li.active").hasClass("hovering")&&Ao(this)};
function yo(a,b){function c(a){a=$(Bo({lead:a.X().sa(),desc:a.Mc(),avatarURL:a.X().je()&&Rg(a.X().je(),50).fa()}));return new qo(a,!0)}var e=Co.bind(a,{message:a.Ub.xl("/brand/members")});a.wf=b;a.tb&&Ao(a);a.tb=mo({elements:b.length?b.map(c):[new qo($(e()),!1)],bf:b.length?0:void 0});a.$el.append(a.tb.view.$el);a.listenTo(a.tb,{select:function(b){a.trigger("select",b);Ao(a)},cancel:function(){Ao(a)}})}
uo.prototype.Zb=function(){this.tb=mo({elements:[new qo($(Co({message:this.Ub.error()})),!1)]});this.$el.append(this.tb.view.$el)};function Ao(a){a.tb&&(a.stopListening(a.tb),a.tb.view.remove(),a.tb=null)}
var vo=_.template('\n  \x3cdiv class\x3d"findUserInput"\x3e\n    \x3cinput type\x3d"text" class\x3d"textInput" placeholder\x3d"\x3c%- inputPlaceholder %\x3e" /\x3e\n  \x3c/div\x3e\n'),Bo=_.template('\n  \x3cimg class\x3d"avatar" src\x3d"\x3c%- avatarURL %\x3e" /\x3e\n  \x3cspan class\x3d"lead"\x3e\x3c%- lead %\x3e\x3c/span\x3e\x3cbr\x3e\n  \x3cspan class\x3d"desc"\x3e\x3c%- desc %\x3e\x3c/span\x3e\n'),Co=_.template('\n  \x3cspan class\x3d"desc"\x3e\x3c%\x3d message %\x3e\x3c/span\x3e\n');function go(a){ka(0<a.size,"invalid avatar size {}",a.size);Backbone.View.call(this,{className:"avatar"});this.Ve=a.Ve||null;this.ue=a.ue||null;this.$c=a.$c||null;this.size=a.size;this.qe=!!a.qe;this.Fe=!!a.Fe;this.Re=!!a.Re;this.Zd=!!a.Zd}k(go,Backbone.View);
go.prototype.render=function(){var a=this.Ve&&this.ue,b=!!this.ue;this.$el.css({width:this.size+"px",height:this.size+"px",lineHeight:this.size/2+"px"});this.Ve&&this.$el.css("backgroundImage","url("+this.Ve+")");a?(this.$el.addClass("avatar--composite"),this.$el.css("fontSize",this.size/4+"px")):b&&(this.$el.addClass("avatar--brand"),this.$el.css("fontSize",this.size/2+"px"));this.ue&&this.$el.attr("data-letter",this.ue);this.$c&&(this.$el.css("backgroundColor",this.$c.ik()),a=this.$c,208<Math.round(Math.sqrt(.241*
a.r*a.r+.691*a.g*a.g+.068*a.b*a.b))&&this.$el.addClass("avatar--light"));this.$el.toggleClass("avatar--whiteBorder",this.Re);this.$el.toggleClass("avatar--darkBorder",this.Zd);this.$el.toggleClass("avatar--glow",this.qe);this.$el.toggleClass("avatar--pointer",this.Fe);return this};
function fo(a,b){a=a.je().zg();ma(0<Object.keys(a).length,"avatar bundle is empty");var c=b*(window.devicePixelRatio||1);return _.chain(a).values().sortBy(function(a){return Math.abs(a.size-c)}).sortBy(function(a){return a.size<c}).first().value().fa()};function Do(){}Do=Backbone.View.extend({className:"button buttonFollow buttonSmall",tagName:"button"});d=Do.prototype;d.events=function(){return{click:this.Ad,mouseout:this.wo}};d.initialize=function(a){this.od=a.od;this.pd=a.pd;this.za=a.za;this.Y=a.Y};
function Eo(a){a.$el.addClass("buttonActive buttonFollowJustClicked");a.$el.attr("disabled","disabled");a.od=!0;wh(a.Y,new Sh({Kc:a.pd,type:"USER"})).finally(function(){a.$el.removeAttr("disabled")}).catch(function(){window.alert("Oh no, following failed. Refresh the page and try again.");a.$el.removeClass("buttonActive buttonFollowJustClicked");a.od=!1;a.trigger("unfollow",a.pd)});a.trigger("follow",a.pd)}d.Li=function(){return window.location.pathname+window.location.search};
d.navigate=function(a){window.location=a};d.Ad=function(){this.za?this.navigate(xk({loginRedirect:this.Li()})):this.od?Fo(this):Eo(this)};d.wo=function(a){0===$(a.relatedTarget).closest(this.el).length&&this.$el.removeClass("buttonFollowJustClicked")};d.render=function(){this.$el.html(this.template());this.$el.toggleClass("buttonActive",this.od);return this};d.template=_.template('\x3cspan class\x3d"buttonFollowOff"\x3eFollow\x3c/span\x3e\x3cspan class\x3d"buttonFollowOn"\x3eFollowing\x3c/span\x3e\x3cspan class\x3d"buttonFollowOnHover"\x3eUnfollow\x3c/span\x3e');
function Fo(a){a.$el.attr("disabled","disabled");a.$el.removeClass("buttonActive");a.od=!1;zh(a.Y,new Uh({Kc:a.pd})).finally(function(){a.$el.removeAttr("disabled")}).catch(function(){window.alert("Oh no, unfollowing failed. Refresh the page and try again.");a.$el.addClass("buttonActive");a.od=!0;a.trigger("follow",a.pd)});a.trigger("unfollow",a.pd)};function Go(){}k(Go,Error);function Ho(){}k(Ho,Go);function Io(a){this.accessToken=a.accessToken||null;this.Dj=a.Dj||null;this.Ck=a.Ck;this.Rl=a.Rl;this.zf=a.zf;if(this.accessToken){var b=this;this.$i().then(function(){gapi.auth.setToken({accessToken:b.accessToken})})}if(this.zf&&!a.Dj)throw Error("Client cannot be configured with offline and not have a redirectUri");this.$i().then(this.um.bind(this,{hq:!1}))}Io.prototype.load=function(){return this.$i()};
(function(){function a(a){var c;try{c=JSON.parse(a.data)}catch(e){return}c.f&&null===document.getElementById(c.f)&&a.stopImmediatePropagation()}window.googleApiLoaderDeferred=window.googleApiLoaderDeferred||$.Deferred();window.googleApiLoaderScript=window.googleApiLoaderScript||null;Io.prototype.Km=function(){var a,c=window.googleApiLoaderDeferred;a=$("\x3cscript\x3e");a[0].onerror=c.reject.bind(c);a.attr({src:"https://apis.google.com/js/client.js?onload\x3dGoogleApiOnGapiLoad",type:"text/javascript"});
a.appendTo("head");return a};Io.prototype.$i=function(){window.googleApiLoaderScript||(window.addEventListener("message",a),window.googleApiLoaderScript=this.Km());return window.googleApiLoaderDeferred.promise()};window.GoogleApiOnGapiLoad=function(){window.googleApiLoaderDeferred.resolve()}})();
Io.prototype.um=function(a){function b(a){var b=a&&a.access_token;a=a&&a.code;b?(e.accessToken=b,c.resolve(e.accessToken)):a?c.resolve(a):c.reject(new Ho)}var c=jQuery.Deferred(),e=this;this.accessToken?c.resolve(this.accessToken):(a={client_id:this.Ck,immediate:!a.hq,approval_prompt:a.Kq?"force":"auto",access_type:this.zf?"offline":"online",response_type:this.zf?"code":"token",scope:this.Rl},this.zf&&(a=$.extend({redirect_uri:this.Dj},a)),gapi.auth.authorize(a,b));return c.promise()};function Jo(a,b){this.id=a;this.media=b;this.Il=[]}Jo.prototype.i=function(){return this.id};Jo.prototype.send=function(){return P.reject("Not implemented")};Jo.prototype.Po=function(a){if(a.lengthComputable){a=a.loaded/a.total;for(var b=0;b<this.Il.length;b++)this.Il[b](this.media,a)}};function Ko(a){Jo.call(this,a.id,a.media);this.file=a.file;this.Bb=a.Bb;this.Si=a.Si;this.So=void 0;this.bi=a.bi;this.ol=a.Xq.ol("canva.editor.uploadrate")}Ko.prototype=Object.create(Jo.prototype);Ko.prototype.constructor=Ko;
Ko.prototype.send=P.method(function(){var a=this,b=a.file.type||Lo(a.file.name),c=this.bi.now();return this.Si.Rq(this.media.i(),this.media.bundle.getVersion(),b).then(function(c){return Mo({sm:c.Lq(),file:a.file,Fn:b,key:c.getKey(),Vo:c.Oq(),progress:a.Po.bind(a),Ip:c.Qq(),url:c.Pq()})}).tap(function(){a.ol.update(a.file.size/(a.bi.now()-c))}).then(function(c){var f=new No;f.importVersion=c;f.mimeType=b;f.isPaid=!0===a.So;a.Bb&&(f.folderKey=a.Bb);return a.Si.Uq(a.media.i(),a.media.bundle.getVersion(),
f)}).catch(this.lp.bind(this))});Ko.prototype.lp=function(){throw Error("Unfortunately your upload failed :(\n\nPlease ensure that:\n   - the size of the image is under 25MB;\n   - the image is a .png, .jpg or .svg file;\n   - the image uses an RGB color model (i.e. not CMYK); and,\n   - you have a stable internet connection.\n\nIf you feel that you have met the above criteria and the image is still failing to upload, please let the team know by emailing support@canva.com");};function Oo(){this.r=255;this.g=0;this.b=255;this.h=300;this.s=100;this.Hh=50}function Po(a,b,c,e){a.r=b;a.g=c;a.b=e;var f;b=a.r;c=a.g;e=a.b;b/=255;c/=255;e/=255;var g=Math.max(b,c,e),h=Math.min(b,c,e);if(g==h)f=h=0;else{var l=g-h,h=l/g;switch(g){case b:f=(c-e)/l+(c<e?6:0);break;case c:f=(e-b)/l+2;break;case e:f=(b-c)/l+4}f/=6}f=[360*f,100*h,100*g];a.h=f[0];a.s=f[1];a.Hh=f[2];return a}
function Qo(a){var b=new Oo;if(!/^#?[0-9a-f]{1,6}$/i.test(a))throw new SyntaxError('Invalid hexadecimal color: "'+a+'"');"#"==a.charAt(0)&&(a=a.slice(1));var c=Math.ceil(a.length/3);return Po(b,Ro(a,0*c,c),Ro(a,1*c,c),Ro(a,2*c,c))}d=Oo.prototype;d.ik=function(){return"#"+(256+this.r).toString(16).slice(-2)+(256+this.g).toString(16).slice(-2)+(256+this.b).toString(16).slice(-2)};d.clone=function(){var a=new Oo;a.r=this.r;a.g=this.g;a.b=this.b;a.h=this.h;a.s=this.s;a.Hh=this.Hh;return a};
d.distanceTo=function(a){var b=(this.r+a.r)/2,c=this.r-a.r,e=this.g-a.g;a=this.b-a.b;return(512+b)*c*c/256+4*e*e+(767-b)*a*a/256};d.equals=function(a){return null!=a&&a.serialize()===this.serialize()};d.serialize=Oo.prototype.ik;d.toString=Oo.prototype.ik;
function ho(a){var b=String(a);if("#"===b.slice(0,1))return Qo(b);if("hsl("===b.slice(0,4)){a=new Oo;var c=/^hsl\((\d*(?:\.\d+)?),\s*(\d*(?:\.\d+)?)%,\s*(\d*(?:\.\d+)?)%\)$/.exec(b);if(!c)throw new SyntaxError('Invalid HSL color: "'+b+'"');var e,b=+c[2];e=+c[3];b/=100;e/=100;var f=b*(.5>e?e:1-e),g=e+f;e=[+c[1],100*(0<e?2*f/g:b),100*g];b=e[0];c=e[1];e=e[2];a.h=b;a.s=c;a.Hh=e;f=b/60;b=c/100;c=e/100;e=Math.floor(f);var h=f-e,f=c*(1-b),g=c*(1-h*b),b=c*(1-(1-h)*b);e%=6;c=[Math.round(255*[c,g,f,f,b,c][e]),
Math.round(255*[b,c,c,g,f,f][e]),Math.round(255*[f,f,b,c,c,g][e])];a.r=c[0];a.g=c[1];a.b=c[2];return a}if("rgb("===b.slice(0,4)){a=new Oo;c=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/.exec(b);if(!c)throw new SyntaxError('Invalid RGB color: "'+b+'"');return Po(a,+c[1],+c[2],+c[3])}if(6>=b.length)return Qo(b);throw Error("could not parse color: "+a);}function Ro(a,b,c){var e=parseInt(a.charAt(b),16)|0;return 16*e+(1==c?e:parseInt(a.charAt(b+1),16)|0)};P.method(function(a,b){function c(a){return 404===a}function e(){return h.Nq(a,b).catch(c,function(){return null})}function f(){return e().then(function(a){g++;var b;if(b=a)b=a.bundle.Ni(),b="PENDING_SUBMISSION"!=b&&"PENDING_REVIEW"!=b;return b?a.bundle.Ni()===So?a:Promise.reject(a):P.delay(Math.round(3E3*Math.pow(1.6,g))).then(f).cancellable()})}var g=0,h=this;return f().timeout(36E5)});var So="APPROVED";function To(){this.prices={}}function Uo(a,b,c){a.prices[b]=c;return a}Uo(new To,"ONE_USE",0);Uo(Uo(new To,"ONE_USE",1),"ROYALTY_FREE",10);function No(){};function Lo(a){a=function(a){var c=/^([^?]+)\?/.exec(a);return c?c[1]:a}(a);return _.find(Vo,function(b,c){return a.slice(-c.length)===c})}var Vo={".gif":"image/gif",".jpg":"image/jpeg",".jpeg":"image/jpeg",".png":"image/png",".ttf":"application/x-font-truetype",".otf":"application/x-font-otf",".woff":"application/font-woff"};function Wo(a,b){this.Xh=a;this.namespace=void 0===b?null:b}Wo.prototype.setItem=function(a,b){try{return this.Xh.setItem(null==this.namespace?a:this.namespace+"."+a,b),!0}catch(c){return!1}};Wo.prototype.getItem=function(a){return this.Xh.getItem(null==this.namespace?a:this.namespace+"."+a)};function an(a,b){try{var c=a.getItem(b);return null!==c?JSON.parse(c):null}catch(e){return null}}function bn(a,b){try{var c=JSON.stringify(!0);a.setItem(b,c)}catch(e){}}
Wo.prototype.removeItem=function(a){this.Xh.removeItem(null==this.namespace?a:this.namespace+"."+a)};function Mo(a){return new P(function(b,c){var e,f;e=new FormData;e.append("key",a.key);e.append("AWSAccessKeyId",a.sm);e.append("policy",a.Vo);e.append("signature",a.Ip);e.append("Content-Type",a.Fn||a.file.type);e.append("file",a.file);f=new XMLHttpRequest;f.onerror=c;f.onreadystatechange=function(){var a,e;4===f.readyState&&(e=(a=vi(f.status))&&f.getResponseHeader("x-amz-version-id"),a&&e?b(e):c())};f.upload.addEventListener("progress",a.progress||function(){});f.open("POST",a.url,!0);f.send(e)})}
;function Xo(){}Xo=Backbone.View.extend({className:"shareProfileView"});Xo.uk="shareProfileViewDismissed";d=Xo.prototype;d.events=function(){return{"click .buttonFacebook":this.Tl,"click .buttonLinkedIn":this.Ul,"click .buttonTwitter":this.Vl,"click .shareProfileViewDismiss":this.Tm}};d.initialize=function(a){this.Aa=a.Aa;this.$l=a.na;this.o=a.o;this.im=a.im};d.Tm=function(){this.hide();this.$l.setItem(Xo.uk,"true")};
function Yo(a,b){return[window.location.protocol+"//"+window.location.host,"/"+encodeURIComponent(a.o.Da()),"?utm_campaign\x3dprofileshare","\x26utm_source\x3d"+encodeURIComponent(a.im),"\x26utm_medium\x3d"+encodeURIComponent(b)].join("")}d.hide=function(){this.$el.addClass("shareProfileViewHidden")};
d.render=function(){this.$el.html(this.template({shareText:this.Aa.zp(),facebookButtonText:this.Aa.format("userProfileShareFacebookButton"),twitterButtonText:this.Aa.format("userProfileShareTwitterButton"),linkedInButtonText:this.Aa.format("userProfileShareLinkedInButton"),dismissTitle:this.Aa.Um()}));null!==this.$l.getItem(Xo.uk)&&this.hide();return this};d.Tl=function(){Zo("https://www.facebook.com/sharer/sharer.php?u\x3d"+encodeURIComponent(Yo(this,"facebook")),550,420)};
d.Ul=function(){Zo("https://www.linkedin.com/shareArticle?mini\x3dtrue\x26url\x3d"+encodeURIComponent(Yo(this,"linkedIn")),606,445)};d.Vl=function(){var a;a=["Check out my @Canva profile!","How great does my @Canva profile look?","Take a look at my @Canva profile!"];var b=Yo(this,"twitter");Zo("https://twitter.com/intent/tweet?url\x3d"+encodeURIComponent(b)+"\x26text\x3d"+encodeURIComponent(a[Math.floor(Math.random()*a.length)]),550,420)};d.show=function(){this.$el.removeClass("shareProfileViewHidden")};
d.template=_.template('\x3c%- shareText %\x3e\x3cbutton class\x3d"button buttonFacebook buttonSmall"\x3e\x3c%- facebookButtonText %\x3e\x3c/button\x3e\x3cbutton class\x3d"button buttonSmall buttonTwitter"\x3e\x3c%- twitterButtonText %\x3e\x3c/button\x3e\x3cbutton class\x3d"button buttonLinkedIn buttonSmall"\x3e\x3c%- linkedInButtonText %\x3e\x3c/button\x3e\x3cbutton class\x3d"shareProfileViewDismiss" title\x3d"\x3c%- dismissTitle %\x3e"\x3e\x3c/button\x3e');function Zo(a,b,c){window.open(a,"","scrollbars\x3dyes,resizable\x3dyes,toolbar\x3dno,location\x3dyes,width\x3d"+b+",height\x3d"+c+",left\x3d"+((window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-b/2+(void 0!==window.screenLeft?window.screenLeft:screen.left))+",top\x3d"+((window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-c/2+(void 0!==window.screenTop?
window.screenTop:screen.top)))};function $o(a){V.call(this,{wa:a.wa,fd:a.fd,ib:a.ib,ua:a.ua,va:a.va,view:a.view})}$o.prototype=Object.create(V.prototype);$o.prototype.constructor=$o;function ap(){}ap=X.extend();ap.create=function(a){var b=(new C).render(),c=new H({bb:function(a){return Math.floor(a/X.Qd)}});return new ap({Aa:a.Aa,ka:b,vf:a.vf,ea:c,Wf:a.Wf})};d=ap.prototype;d.initialize=function(a){X.prototype.initialize.call(this,{ka:a.ka,ea:a.ea,zd:!0});this.Aa=a.Aa;this.vf=a.vf;this.Wf=a.Wf};d.Gd=function(){return this.ti({emptyMessage:this.vf?this.Aa.format("userProfileEmptyDesignListMessageOwnProfile"):this.Aa.format("userProfileEmptyDesignListMessageOtherProfile",this.Wf)})};
d.ti=_.template('\x3cp class\x3d"designCardListEmptyMessage userDesignsEmpty"\x3e\x3c%- emptyMessage %\x3e\x3c/p\x3e');d.Hd=function(){return this.ce({errorMessage:this.vf?this.Aa.format("userProfileDesignListErrorMessageOwnProfile"):this.Aa.format("userProfileDesignListErrorMessageOtherProfile",this.Wf)})};d.ce=_.template('\x3cp class\x3d"designCardListErrorMessage"\x3e\x3c%- errorMessage %\x3e\x3c/p\x3e');$(function(){function a(a,b){var c=null;v.Ra.get(hc)&&(c=function(){return In({Mm:to,v:r,xa:p,l:E,j:e,D:E.Z(a),aa:m,C:x})});return rn({Xd:c,l:E,J:db(e),D:E.Z(a),analytics:l,C:x,view:b})}function b(){return new zd({pg:window.designImporterUrl,Za:v,Gi:r.me(),hk:p.i()})}function c(){return!p.contributor&&!p.personal&&!p.thirdParty&&!!r.me()&&!!v.Ra.get(bc)}var e;if(!window.cmsg)throw Error("window['cmsg'] isn't defined");e=new Fa;var f=fb(e),g=new Rj(window.httpServiceConfig),h=nj(),l=Ba(),m=new xg(g),
q=new qi(g),p=h.brandInfo.O(),r=h.user.bm(),v=new $b(new Zb(window.cflags)),ja=new uh(g),wn=Al(),Df=new Cd,Ad=new rc(g),Ef=new Lf(g),cc=$(".pageHeader"),Jd=new di(g),Kd=$("#primaryNavigation"),lg=new lk({analytics:l,xa:p,v:r,history:new oi(window),Y:ja,j:e,$e:$m.$e});lg.zb.push(Df);var $d;try{if(window.localStorage)$d=new Wo(window.localStorage,void 0);else throw Error("ClientStore: localStorage is not defined on window, likely an unsupported browser");}catch(dp){}var vb=window.compactDocTypes.map(yc),
ra=function(a){a=new K({ed:a,W:Ua(e)});$(window).on("resize",a.td.bind(a));return a}(vb);new Ke({ed:vb,ri:new we(g),W:Ua(e),view:ra});ra.render();ra.$el.appendTo(cc);ra.td();var wb=kl(),E=new hn({Ma:Ef,cc:r.i()}),mg=new Hm({el:$(".sidebar li.trashedDesigns")[0],C:x,qk:"/designs/trash"}),vb=null,ok=mg;if(v.cf()){var ng=Ll(),vb=new vf({gi:function(a){return new Hf({D:a,ca:f})},ca:f,ye:v.Ra.get(ic)}),og=new gf({analytics:l,ji:function(){var a=m,b=p,c=l,f=ng.length?ng[0].Pi():void 0,g=e,h=!!v.Ra.get(nc),
r;r={We:q,G:b.i(),Nb:wn,Pa:!0,La:Ya(g)};var E=new Il({fg:!1!==r.fg,La:r.La});r=new Dl({We:r.We,G:r.G,Ea:r.Ea,Pa:r.Pa,Nb:r.Nb,view:E});a=new Nm({analytics:c,gg:q,aa:a,G:b,jc:r,Yj:!1,j:g,view:Om({compact:!0,j:g,wj:ng,wb:f,fb:h})});return new Xm({analytics:c,ig:!0,hc:!0,ym:Wa(g),Lb:!0,wb:f,Md:a,fb:h})},ca:f,l:E,view:vb});og.view.render().$el.replaceAll($(".designFolderListPlaceholder")).addClass("sidebarSection");E.fetch();ok=new Yl([og,mg]);window.homeConfig&&window.homeConfig.initialFolder&&kn(E)}var ae=
new Kk({dk:Kd.add($(".designFolderListMenu,.sidebarMenuSecondary,.sidebarMenuFolders")),Xf:!0});Gj(ae,!0);ae.$el.appendTo(".sidebarInner");var bp=Nk({el:Kd[0],Gk:window.location.href}),cp=Nk({el:$(".sidebarMenuFolders")[0],Gk:window.location.href}),g=new Pk({Ya:$(".panelContainer"),C:x}),Q=new Bj({vb:g,l:E,Ic:ra,Ib:bp,yb:vb,Tc:cp,ni:$(".sidebarMenuLink.designStream"),$b:ae,window:window,history:window.history});new Mj({el:$("#wholePage").children(".sidebar").find(".sidebarViewportContainer"),Gb:Q,
$b:ae});cc=new zj({ii:function(a){var b=p.personal||p.contributor||p.thirdParty,f=e;f.Ja||(f.Ja=new rb(f.qa));f=f.Ja;if(a===T)return new Z({R:a,pa:nm.create(h,b,c(),Ia(e)),Ja:f});if(a===rj)return b=e,b.Kb||(b.Kb=new qb(b.qa)),b=b.Kb,new Z({R:a,pa:wm.create(b),Sa:sm.create(b),Ja:f});if(a===sj)return new Z({R:a,pa:zm.create($a(e)),Ja:f});if(a===tj)return b=bb(e),new Z({R:a,pa:Gm(b),Sa:new Am({el:$(Bm({title:b.format("trashedDesignsHeaderTitle"),description:b.format("trashedDesignsHeaderDescription")}))[0]}),
Ja:f});if(a===uj)return new rm({R:a,pa:new Zd({v:r,xa:p,nc:Df,Y:ja,Ah:Kd.find(".designStream"),j:e}),Ja:f});if(vj(a)){var b=db(e),b=pn.create(b),g;g=a.substr(7);if(!v.cf())throw Error("design folders are not enabled");g=xn.create({analytics:l,na:$d,J:db(e),ff:!!v.Ra.get(hc),D:E.Z(g)});return new Dn({R:a,pa:b,Sa:g,Ja:f})}throw Error("Unrecognised tabId "+a);},Ic:ra,tj:cc,vb:g,C:x,ua:wb,window:window});ra=new qj({analytics:l,fi:function(a,b){return new fm({analytics:l,body:$("body"),Pf:b,Ei:a,Ne:ok,
Gc:og,yh:mg,ee:Kd,l:E,C:x,ca:f})},hi:function(f,g){var h;if(f===T){h=v.cf();var m=window.filter||void 0,q=["SOCIAL","INGESTION_STATUS"];h&&q.push("FOLDER");h=new dm({ng:q,filter:m,nd:1,ub:20,Nd:"/designs/all",dc:Jd});h=new jm({wa:km.bind(null,e,v,l),l:E,Ga:Ad,ua:wb,Lf:c(),Jh:h,view:g.pa,j:e});return new pm({ei:b,la:h,R:f,view:g})}if(f===rj)h=r.i(),m=p.i(),h={Ga:Ad,ua:wb,va:new vm({Td:m,ub:18,cc:h,dc:Jd}),view:g.pa,j:e},h=new tm(_.extend(h,{wa:um.bind(null,h.j)}));else if(f===sj)h=new dm({nd:0,ub:18,
Nd:"/designs/sharedwith",dc:Jd}),h=new xm({analytics:l,wa:ym.bind(null,r,ja,e),fd:Zl.bind(null,ja),ib:lg,ua:wb,va:h,view:g.pa});else if(f===tj)h=r.i(),m=p.i(),h={analytics:l,Ga:Ad,ua:wb,va:new dm({Td:m,ng:["SOCIAL","INGESTION_STATUS"],nd:1,ub:20,Nd:"/designs/trash",cc:h,dc:Jd}),view:g.pa,j:e},h=new Cm(_.extend(h,{wa:Dm.bind(null,h.j,h.analytics),Wa:bb(h.j)}));else{if(f===uj)return new qm({la:g.pa,nc:Df,ib:lg,R:f,view:g});if(vj(f)){h=f.substr(7);m=g.pa;if(!v.cf())throw Error("design folders are not enabled");
var q=Uf({id:h}),q=new Bn({D:q,Ma:Ef,ub:20}),Q=mn.bind(null,{j:e,D:E.Z(h),analytics:l});h=new ln({wa:Q,l:E,Ga:Ad,Bb:Uf({id:h}),Ma:Ef,ua:wb,va:q,o:r,G:p,view:m,j:e,Za:v});return new Cn({la:h,nl:a(f.substr(7),g.Sa),R:f,view:g})}throw Error("Unrecognised tabId "+f);}return new Y({la:h,R:f,view:g})},na:$d,v:r,document:document,Za:v,Gb:Q,view:cc});g.init();Q.init();cc.init();ra.init();(function(){var a;$("#homeHelpMenuButton").click(function(){Q.Yd===T?a="your_designs":Q.Yd===xj?a="create_a_design":Q.Yd===
uj?a="design_stream":Q.Yd===rj?a="shared_with_you":Q.Yd&&vj(Q.Yd)&&(a="c4w_folder");l.ab("need_help","homepage",a,"bottom_right")})})();(function(){var a=window.homeConfig.showUpgradeDialog;v.Ra.get(gc)&&a&&R.Dn({analytics:l,na:$d,aa:m,xn:"es-ES"==h.user.nf(),Jb:h,C:x})})()});$(function(){function a(){zE(function(){var a=nj(),f=a.brandInfo.O(),a=a.user;zE.identify({name:c(a),email:a.Mc(),externalId:a.i(),organization:e(f)||void 0});zE.setLocale(a.nf());$(".activateZendesk").click(b)})}function b(){zE&&zE.activate({hideOnClose:!0});return!zE}function c(a){var b=a.sa();a=a.Da();return b?b:a}function e(a){var b=a.sa();a=a.bl();return b?b:a}var f=Ba();!(new $b(new Zb(window.cflags))).Ra.get(dc)||window.brandPageConfig&&window.brandPageConfig.brandOnboardingSettings||a();(function(){$("#editorHelpMenuButton").click(function(){f.ab("need_help",
"editor","canvas","bottom_right")})})()});})();
